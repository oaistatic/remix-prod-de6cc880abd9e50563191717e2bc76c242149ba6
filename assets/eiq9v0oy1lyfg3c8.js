import{r as u,j as t,a8 as S}from"./khl8ktun31iepecq.js";import{J as D,L as P,M as H,N as V,O as Q,Q as X,R as Y}from"./n4exq6o15ap1g74l.js";import{b as Z,dG as I,a as b,bL as ee,cr as te,c as ne,eU as se}from"./haannt40upmuwmtk.js";function xe(e){const s=V();return null}function he(e){return V()?null:t.jsx(G,{...e})}function G({webpageRef:e,trackContentReferenceEvent:s,messageId:n,index:i}){const[a,o]=u.useState(null);switch(e.status){case"loading":return null;case"error":return t.jsx(ae,{contentRef:e});default:return t.jsx(t.Fragment,{children:e.items.map((d,l)=>{const p=a===l;return t.jsx(ie,{webpageItem:d,trackContentReferenceEvent:s,onMouseEnter:()=>{o(l)},isLastHovered:p,messageId:n,analyticsMetadata:{section:"inline",section_location:"response",section_index:d.section_index},index:i},`${l}-${d.url}-${p}`)})})}}function ae({contentRef:e}){return null}const W={prev:{x:"0%",opacity:0,pointerEvents:"none",transition:{duration:.1,ease:"easeOut"}},cur:{x:"0",opacity:1,pointerEvents:"auto",transition:{duration:.15,ease:"easeOut"}},next:{x:"5%",opacity:0,pointerEvents:"none",transition:{duration:.1,ease:"easeOut"}}};function ie({webpageItem:e,className:s,trackContentReferenceEvent:n,onMouseEnter:i,isLastHovered:a,messageId:o,analyticsMetadata:d,index:l,noMarginStart:p}){const x=c=>({url:c.url,title:c.title,pub_date:Q(c.pub_date),sub_pill_index:c.sub_pill_index,link_type:"pill",...d}),h=e.supporting_websites?.length??0,[v,j]=u.useState(!1),[F,B]=u.useState(!1),r=(v||F)&&a,_=u.useRef(r);r||(_.current=!1);const E=!r||!_.current,k=u.useRef(null),[w,A]=u.useState(null);u.useEffect(()=>{k.current=null,A(null)},[e]),I(()=>{if(k.current){const{offsetWidth:c}=k.current;A(c+1)}},[]),u.useEffect(()=>{a&&(r?D.setHighlightBySource(o,e):D.clearHighlights())},[r,a,o,e]);const m=[e,...e.supporting_websites??[]],[f,U]=u.useState(0);let M=c=>{c!==f&&r&&(_.current=r),U(c)};const y=m[f]??e,L=g(f-1,m.length),O=g(f+1,m.length),R={url:y.url,title:y.title,pub_date:y.pub_date,sub_pill_index:f};u.useEffect(()=>{r||M(0)},[r]);const T=ce(o,l??0,f);u.useEffect(()=>{T||(n("link_action","link_action","webpage",{...x(R),action:"show"}),ue(o,l??0,f))},[T]);const $=()=>{n("link_action","link_action","webpage",{...x(R),action:"click"})},J=c=>{c&&n("link_action","link_action","webpage",{...x(R),action:"hover"}),B(c)},K=t.jsx("span",{ref:k,className:b(!p&&"ms-1","inline-flex max-w-full items-center","relative top-[-0.094rem]","animate-[show_150ms_ease-in]"),style:w?{width:w}:void 0,children:t.jsx(P,{href:y.url,className:b("flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium",r?"bg-token-text-primary! text-token-main-surface-primary!":"text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]!","transition-colors duration-150 ease-in-out",s),style:w?{maxWidth:w}:void 0,onClick:$,onMouseEnter:()=>{i?.(),j(!0)},onMouseLeave:()=>{j(!1)},children:t.jsxs("span",{className:"relative start-0 bottom-0 flex h-full w-full items-center",children:[m.length>2&&t.jsx(C,{variant:"prev",item:m[L],numAdditionalSupportingWebsites:h,isActive:r??!1,shouldShowSupportingCount:E,className:"absolute"},L),t.jsx(C,{variant:"cur",item:m[f],numAdditionalSupportingWebsites:h,isActive:r??!1,shouldShowSupportingCount:E},f),m.length>1&&t.jsx(C,{variant:"next",item:m[O],numAdditionalSupportingWebsites:h,isActive:r??!1,shouldShowSupportingCount:E,className:"absolute"},O)]})})});return t.jsx(oe,{webpageItem:e,isLastHovered:a,open:F,onOpenChange:J,onClick:$,currentItemIndex:f,setCurrentItemIndex:M,children:K})}function C({className:e,variant:s,item:n,numAdditionalSupportingWebsites:i,isActive:a,shouldShowSupportingCount:o,...d}){const l=o&&i>0;return t.jsxs(S.span,{variants:{prev:{x:"0%",opacity:0,transition:{duration:.1,ease:"easeOut"}},cur:{x:"0",opacity:1,transition:{duration:.1,ease:"easeOut"}},next:{x:"10%",opacity:0}},animate:s,initial:s,className:b("flex h-4 w-full items-center justify-between",!l&&"overflow-hidden",e),...d,children:[t.jsx("span",{className:"max-w-full grow truncate overflow-hidden text-center",children:n.attribution??H(n.url)}),l&&t.jsxs("span",{className:b("-me-1 flex h-full items-center rounded-full px-1 text-[#8F8F8F]",a&&"text-token-main-surface-tertiary"),children:["+",i]})]})}function oe({webpageItem:e,onClick:s,open:n,onOpenChange:i,children:a,isLastHovered:o,currentItemIndex:d,setCurrentItemIndex:l,className:p}){const x=ee();if(!o)return n&&i?.(!1),a;const h=t.jsx(le,{webpageItem:e,onClick:s,currentItemIndex:d,setCurrentItemIndex:l});return t.jsx(te,{label:h,onOpenChange:i,side:"bottom",sideOffset:10,withArrow:!1,delayDuration:150,theme:x?"default":"white",align:"start",customPaddingClassName:"p-0",cornerRadius:"xl",customBorderClassName:"border-token-border-default border",contentClassName:"animate-show animate-[show_150ms_ease-in]",className:p,wide:!0,interactive:!0,children:a})}function N({item:e,onClick:s}){if(!e)return null;const n=e.pub_date!=null?new Date(e.pub_date*1e3):null;return t.jsxs(P,{className:"flex flex-col gap-2 p-3",href:e.url,onClick:s,children:[t.jsxs("div",{className:"flex gap-1.5",children:[t.jsx("div",{className:"h-4 w-4 shrink-0 overflow-hidden rounded-full",children:t.jsx(Y,{url:e.url,size:32,minSize:16})}),t.jsx("div",{className:"text-token-text-primary truncate",children:e.attribution??H(e.url)})]}),t.jsx("div",{className:"line-clamp-2 text-sm font-medium",children:e.title}),t.jsxs("div",{className:"text-token-text-secondary line-clamp-2 text-sm",children:[re(n),n&&e.snippet&&" â€” ",e.snippet]})]})}function le({webpageItem:e,onClick:s,currentItemIndex:n,setCurrentItemIndex:i}){const a=[e,...e.supporting_websites??[]],o=a[n??0],d=n!=null&&`${n+1}/${a.length}`,l=n?a[g(n+1,a.length)]:void 0,p=n?a[g(n-1,a.length)]:void 0,x=()=>{n!=null&&i?.(g(n+1,a.length))},h=()=>{n!=null&&i?.(g(n-1,a.length))};u.useEffect(()=>ne(document,{keydown:j=>{j.key==="ArrowRight"?x():j.key==="ArrowLeft"&&h()}}));const v=b("flex flex-col dark:bg-token-main-surface-secondary");return t.jsxs("span",{className:"text-token-text-primary flex flex-col text-start text-xs font-normal no-underline!",children:[n!=null&&a.length>1&&t.jsxs("div",{className:"bg-token-main-surface-secondary dark:bg-token-main-surface-tertiary flex h-9 items-center justify-between gap-1.5",children:[t.jsxs("div",{className:"text-token-text-secondary mx-1.5 flex gap-1",children:[t.jsx("button",{onClick:h,className:"hover:bg-token-border-xlight disabled:text-token-text-quaternary h-6 w-6 rounded-md disabled:hover:bg-transparent",children:t.jsx(se,{className:"icon-sm m-auto"})}),t.jsx("button",{onClick:x,className:"hover:bg-token-border-xlight disabled:text-token-text-quaternary h-6 w-6 rounded-md disabled:hover:bg-transparent",children:t.jsx(X,{className:"icon-sm m-auto"})})]}),t.jsx("span",{className:"text-token-text-tertiary mx-3.5",children:d})]}),n!=null&&a.length>1?t.jsxs("div",{className:"flex overflow-hidden",children:[a.length>2&&t.jsx(S.span,{className:b(v,"absolute"),variants:W,animate:"prev",initial:"prev",children:t.jsx(N,{item:p,onClick:s})},g(n-1,a.length)),t.jsx(S.span,{className:v,variants:W,animate:"cur",initial:"cur",children:t.jsx(N,{item:o,onClick:s})},n),a.length>1&&t.jsx(S.span,{className:b(v,"absolute"),variants:W,animate:"next",initial:"next",children:t.jsx(N,{item:l,onClick:s})},g(n+1,a.length))]}):t.jsx("div",{className:v,children:t.jsx(N,{item:o,onClick:s})})]})}function re(e){return e&&e.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}function g(e,s){return(e%s+s)%s}const q=Z(()=>({}));function z(e,s,n){return`${e}-${s}-${n}`}function ce(e,s,n){return q(i=>i[z(e,s,n)])}function ue(e,s,n){q.setState(i=>({...i,[z(e,s,n)]:1}))}export{ie as W,he as a,oe as b,xe as c};
//# sourceMappingURL=eiq9v0oy1lyfg3c8.js.map
