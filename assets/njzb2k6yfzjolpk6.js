import{j as e,r as d,M as k}from"./khl8ktun31iepecq.js";import{a as n,aj as w,B as S,A as C,cq as T,P as E,o as M,cH as _,ac as P}from"./haannt40upmuwmtk.js";import{ez as A,eA as D}from"./n4exq6o15ap1g74l.js";import{S as R}from"./gwmp2bbho6vd4qt8.js";function B({title:l,content:r,buttons:t,time:a,icon:m,size:s="default",progressBar:f,disabled:i=!1,onClick:x}){const g="border-[rgba(0,0,0,0.1)] dark:border-[rgba(255,255,255,0.1)]",h=s==="small"?`w-full sm:w-[380px] pe-[15px] ps-[20px] pt-[13px] pb-[10px] ${i?"":"gap-4"}`:"w-full gap-4 px-[22px] pb-[22px] pt-[18px]",c=x?"cursor-pointer":"",j=s==="small"?"text-[15px]":"";return e.jsxs("div",{className:n("inline-flex flex-col items-start justify-start rounded-2xl border",g,"bg-token-main-surface-primary dark:bg-token-main-surface-secondary",h,c,j),onClick:x,style:s==="small"&&!i?{boxShadow:"rgba(0, 0, 0, 0.06) 0px 2px 6px 0px"}:void 0,children:[e.jsxs("div",{className:n("flex flex-col items-start justify-start self-stretch",s!=="small"&&"gap-1.5"),children:[e.jsxs("div",{className:n("inline-flex items-start justify-start self-stretch",s!=="small"&&"gap-2"),children:[e.jsx("div",{className:n("shrink grow basis-0 leading-normal font-medium",i?"text-token-text-secondary":"text-token-text-primary"),children:l}),e.jsx("div",{className:"relative h-6 w-6"}),!i&&(m||e.jsx(R,{className:"relative h-6 w-6"}))]}),e.jsx("div",{className:n("flex w-full flex-col items-start justify-start",s==="small"&&"mt-[-2px]"),children:e.jsx("div",{className:n("inline-flex w-full items-start justify-start self-stretch rounded-sm",s==="small"?"gap-1":"gap-2.5 py-1"),children:e.jsx("div",{className:n("w-full leading-relaxed font-normal",i?"text-token-text-tertiary":"text-token-text-secondary"),children:r})})})]}),f?e.jsxs("div",{className:n("mb-2 inline-flex items-center justify-between self-stretch",t?.length&&"mt-[-10px]"),children:[f,t]}):e.jsxs("div",{className:"inline-flex items-center justify-end self-stretch",children:[a&&e.jsx("div",{className:"text-token-text-tertiary shrink grow basis-0 text-[15px] leading-normal font-normal",children:a}),e.jsx("div",{className:"flex gap-2",children:t})]})]})}const F=/\*\*(.*?)(?:\*\*|\n|$)/g,$=l=>{let r=null,t;for(;(t=F.exec(l))!=null;)r=t[1].trim();return r};function z({message:l,isExpandable:r,simulatedDuration:t=8*60*1e3,maxFill:a=100}){const m=l?.create_time?new Date(l.create_time*1e3):Date.now(),s=A(+m,t);return e.jsx(D,{percentage:Math.min(s,a),className:n(r?"me-4 w-3/4!":"w-full!"),backgroundClassName:"bg-token-sidebar-surface-secondary rounded-full",barClassName:"bg-token-text-primary rounded-full",transitionDuration:`${(100-s)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)",height:8})}function O({messages:l,isStreaming:r,isLastMessage:t,clientThreadId:a,currentGroupedMessageIndex:m,turnIndex:s}){const[f,i]=d.useState(""),[x,g]=d.useState(!1),h=w(a,o=>o?.async_status===P.STREAMING),c=S(l),j=c?.id,v=c?.metadata?.initial_text,N=c?.metadata?.summarization_headline,p=l.map(o=>C(o)).join(`

`),{toggleThreadSidebar:b}=T(),y=d.useCallback(()=>{b({type:"summarizer",clientThreadId:a,currentGroupedMessageIndex:m,turnIndex:s})},[b,a,m,s]);d.useEffect(()=>{const o=$(p);o?i(o):v!=null&&i(v)},[p,v]),d.useEffect(()=>{p.length>0&&g(!0)},[p]),d.useEffect(()=>{x&&E.logEvent("Tool: Received a8km123 message",{client_thread_id:a,message_id:j,conversationId:M(a)})},[x]);const u=h&&t||r;return e.jsx("div",{className:"pb-2",children:e.jsx(B,{buttons:u?[e.jsx(_,{onClick:o=>{o.stopPropagation(),y()},color:"secondary",className:"text-token-text-secondary h-[38px]! text-[15px] font-normal",children:e.jsx("div",{className:"px-1",children:e.jsx(k,{id:"wQcuK8",defaultMessage:"Details"})})},"Details")]:[],time:null,title:N,icon:u?e.jsx("div",{className:""}):null,content:u?`${f}...`:c?.metadata?.finished_text??"",size:"small",disabled:!u,onClick:y,progressBar:u?e.jsx(z,{message:c,isExpandable:x}):null})})}export{z as ProduceProgressBar,O as default};
//# sourceMappingURL=njzb2k6yfzjolpk6.js.map
