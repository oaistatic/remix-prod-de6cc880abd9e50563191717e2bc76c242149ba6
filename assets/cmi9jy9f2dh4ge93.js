import{r as c,j as e,g as te,e as I,a8 as g,a9 as y}from"./khl8ktun31iepecq.js";import{dD as ne,ew as R,cX as O,I as A,F as U,E as V,e9 as se,cW as ae,cF as oe,a as re,cH as ie}from"./haannt40upmuwmtk.js";import{B as ce}from"./l6prrb6nf9agh4ql.js";import{mG as ue,mH as de,aX as le,en as xe,f1 as w,f2 as b,mI as fe,cK as me,jH as pe,jI as ve}from"./n4exq6o15ap1g74l.js";import{a as p,c as he,b as ge,g as je,d as be}from"./bqem6ejvvuwllmce.js";import{R as C}from"./e66najub871r0jzn.js";import{u as Ce}from"./k4x4faqovf1h5oeq.js";import{M as we}from"./ougcm9i7phfim0kn.js";import"./lw7vucdyqf9uqozi.js";import"./l0u04bzc302go3qr.js";import"./gzmx7bftqjwaztkr.js";import"./o1bzkr20ape07jec.js";import"./c6cvb002ahbvyqou.js";import"./h54tsg40aj2pr0ev.js";import"./b9iv65ef6it0bnl8.js";import"./h1em0bjkpkjv8ykw.js";import"./mr4t2sawqo9d3nrg.js";const Se=60,ye=({children:t,scrollViewClassName:n,scrollAnchorTopOffset:s=0})=>{const a=c.useRef(null);return e.jsx("div",{className:"h-full",ref:a,children:e.jsx(ne,{children:e.jsx(ce,{className:"h-full",followButtonClassName:"hidden",initialScrollBehavior:"auto",scrollViewClassName:n,scroller:()=>Me(a,s)?0:1/0,children:t})})})},Me=(t,n)=>{const s=Ne(t.current);if(s==null)return!1;const a=s>n,o=s<n-Se;return!a&&!o};function Ne(t){if(!t)return null;const n=t.querySelector('[data-scroll-anchor="true"]');if(!n)return null;const s=n.getBoundingClientRect().top,a=t.getBoundingClientRect().top;return s-a}const ke=t=>c.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},c.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 15.8333V17.1667C4 18.4553 5.04467 19.5 6.33333 19.5C6.70152 19.5 7 19.2015 7 18.8333V14.1667C7 13.7985 6.70152 13.5 6.33333 13.5C5.04467 13.5 4 14.5447 4 15.8333ZM2 12.5C2 6.97715 6.47715 2.5 12 2.5C17.5228 2.5 22 6.97715 22 12.5V17.1667C22 19.5599 20.0599 21.5 17.6667 21.5C16.1939 21.5 15 20.3061 15 18.8333V14.1667C15 12.6939 16.1939 11.5 17.6667 11.5C18.523 11.5 19.3214 11.7484 19.9936 12.1771C19.8242 7.90854 16.3101 4.5 12 4.5C7.68986 4.5 4.17583 7.90854 4.0064 12.1771C4.6786 11.7484 5.47696 11.5 6.33333 11.5C7.80609 11.5 9 12.6939 9 14.1667V18.8333C9 20.3061 7.80609 21.5 6.33333 21.5C3.9401 21.5 2 19.5599 2 17.1667V12.5ZM20 15.8333C20 14.5447 18.9553 13.5 17.6667 13.5C17.2985 13.5 17 13.7985 17 14.1667V18.8333C17 19.2015 17.2985 19.5 17.6667 19.5C18.9553 19.5 20 18.4553 20 17.1667V15.8333Z",fill:"currentColor"}));function De(t,n,s,a){var o=-1,i=t==null?0:t.length;for(a&&i&&(s=t[++o]);++o<i;)s=n(s,t[o],o,t);return s}var Ie=De;function Re(t){return function(n){return t?.[n]}}var Oe=Re,Ae=Oe,Ue={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Ve=Ae(Ue),Ee=Ve,Te=Ee,_e=R,Be=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,$e="\\u0300-\\u036f",Le="\\ufe20-\\ufe2f",Pe="\\u20d0-\\u20ff",We=$e+Le+Pe,ze="["+We+"]",Fe=RegExp(ze,"g");function Ze(t){return t=_e(t),t&&t.replace(Be,Te).replace(Fe,"")}var He=Ze,Ge=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function Qe(t){return t.match(Ge)||[]}var Je=Qe,Ye=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function qe(t){return Ye.test(t)}var Ke=qe,E="\\ud800-\\udfff",Xe="\\u0300-\\u036f",et="\\ufe20-\\ufe2f",tt="\\u20d0-\\u20ff",nt=Xe+et+tt,T="\\u2700-\\u27bf",_="a-z\\xdf-\\xf6\\xf8-\\xff",st="\\xac\\xb1\\xd7\\xf7",at="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ot="\\u2000-\\u206f",rt=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",B="A-Z\\xc0-\\xd6\\xd8-\\xde",it="\\ufe0e\\ufe0f",$=st+at+ot+rt,L="['’]",M="["+$+"]",ct="["+nt+"]",P="\\d+",ut="["+T+"]",W="["+_+"]",z="[^"+E+$+P+T+_+B+"]",dt="\\ud83c[\\udffb-\\udfff]",lt="(?:"+ct+"|"+dt+")",xt="[^"+E+"]",F="(?:\\ud83c[\\udde6-\\uddff]){2}",Z="[\\ud800-\\udbff][\\udc00-\\udfff]",v="["+B+"]",ft="\\u200d",N="(?:"+W+"|"+z+")",mt="(?:"+v+"|"+z+")",k="(?:"+L+"(?:d|ll|m|re|s|t|ve))?",D="(?:"+L+"(?:D|LL|M|RE|S|T|VE))?",H=lt+"?",G="["+it+"]?",pt="(?:"+ft+"(?:"+[xt,F,Z].join("|")+")"+G+H+")*",vt="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ht="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",gt=G+H+pt,jt="(?:"+[ut,F,Z].join("|")+")"+gt,bt=RegExp([v+"?"+W+"+"+k+"(?="+[M,v,"$"].join("|")+")",mt+"+"+D+"(?="+[M,v+N,"$"].join("|")+")",v+"?"+N+"+"+k,v+"+"+D,ht,vt,P,jt].join("|"),"g");function Ct(t){return t.match(bt)||[]}var wt=Ct,St=Je,yt=Ke,Mt=R,Nt=wt;function kt(t,n,s){return t=Mt(t),n=s?void 0:n,n===void 0?yt(t)?Nt(t):St(t):t.match(n)||[]}var Dt=kt,It=Ie,Rt=He,Ot=Dt,At="['’]",Ut=RegExp(At,"g");function Vt(t){return function(n){return It(Ot(Rt(n).replace(Ut,"")),t,"")}}var Et=Vt,Tt=Et,_t=ue,Bt=Tt(function(t,n,s){return t+(s?" ":"")+_t(n)}),$t=Bt;const Lt=te($t);function Pt({conversationId:t}){const n=A(t),s=U.getCurrentNode(V(t))?.id,a=he();return xe()?e.jsx(m,{conversationId:n??t,parentMessageId:s,status:a}):null}function m(t){const n=t?.status?.modes,[s,a]=c.useState(!1),[o,i]=c.useState(),d=c.useCallback(r=>{i(r),a(!0)},[]),u=I(),l=c.useCallback(()=>a(!1),[]);return e.jsxs(e.Fragment,{children:[e.jsx(se,{contentAlign:"center",triggerButton:e.jsx(m.Trigger,{}),children:n?n.map(r=>c.createElement(m.Item,{...t,key:r.mode,voiceStatusMode:r,onShowModal:d})):e.jsx("div",{role:"progressbar","aria-valuetext":u.formatMessage({defaultMessage:"Loading voice modes",id:"voiceModeButton.loadingModes"}),"aria-busy":"true","aria-live":"assertive","aria-valuemin":0,"aria-valuemax":100,children:e.jsx(O,{"aria-hidden":"true",className:"my-4 min-w-full"})})}),e.jsx(m.Modal,{conversationId:t.conversationId,disabledModeMetadata:o,isOpen:s,onClose:l})]})}m.Modal=function(n){const s=n.disabledModeMetadata?.buttons??[],a=Ce({buttons:s,conversationId:n.conversationId,onClick:n.onClose}),o=e.jsx(we,{children:n.disabledModeMetadata?.description_markdown});return e.jsx(ae,{testId:"modal-voice-mode",title:n.disabledModeMetadata?.title,description:o,isOpen:n.isOpen,onClose:n.onClose,type:"success",primaryButton:a.primary,secondaryButton:a.secondary})};m.Trigger=c.forwardRef(function(n,s){const a=p(o=>o.voiceMode);return e.jsxs(de,{ref:s,...n,children:[Lt(a)??e.jsx(O,{}),e.jsx(le,{className:"icon-md text-token-text-tertiary"})]})});m.Item=function({conversationId:n,parentMessageId:s,voiceStatusMode:a,onShowModal:o}){const{disabled_mode_metadata:i,mode:d}=a,{startVoiceMode:u}=ge(),l=A(n),r=c.useCallback(async()=>{i?o(i.disabled_message):u(je({serverThreadId:l,parentMessageId:s,isAdvancedMode:d==="advanced"&&!i,eventSource:"voice_mode_picker",clientThreadId:n,gizmoId:U.getGizmoId(V(n))}))},[n,i,d,o,s,l,u]);return e.jsx(oe.Item,{onClick:r,children:e.jsxs("div",{children:[a.display_name,e.jsx("div",{className:"text-token-text-tertiary text-xs",children:a.description})]})})};function ln({conversationId:t}){const n=p(s=>s.voiceSessionId);return e.jsx("div",{className:"relative h-full",children:e.jsx(g.div,{className:"border-s-token-sidebar-surface-secondary bg-token-main-surface-secondary absolute hidden h-full max-w-[500px] overflow-y-hidden rounded-xl border-s pt-4 shadow-inner md:block",initial:{opacity:0,x:520,width:"0px"},animate:{opacity:1,x:0,width:"500px",left:"-520px"},exit:{opacity:0,x:520,width:"0px",left:"0px"},transition:{type:"tween"},children:e.jsx(y,{children:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsx(Pt,{conversationId:t})}),e.jsx("div",{className:"p-4 py-2 text-sm",children:e.jsx(f,{name:"Voice Session ID",text:n??"n/a"})}),e.jsxs("div",{className:"flex h-full w-full flex-col flex-nowrap gap-4",children:[e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"flex flex-col flex-nowrap gap-4",children:[e.jsx(Wt,{}),e.jsx(Ft,{})]})}),e.jsx(zt,{})]})]})})})})}function Wt(){const[t,n]=c.useState("timestamp"),[s,a]=c.useState("asc"),o=p(r=>r.server.messages.filter(x=>x.type===be.Performance)),i=o[o.length-1],d=c.useCallback(r=>r>=1e3?`${(r/1e3).toFixed(2)}s`:`${r.toFixed(1)}ms`,[]),u=c.useMemo(()=>i?[...i.payload.metrics].sort((r,x)=>{const j=t==="name"?r.name.localeCompare(x.name):r.ms-x.ms;return s==="asc"?j:-j}):[],[i,t,s]);if(!i)return null;const l=r=>{r===t?a(s==="asc"?"desc":"asc"):(n(r),a("asc"))};return e.jsx(Q,{title:"Performance",children:e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx(S,{text:"Metric"}),t==="name"?s==="asc"?e.jsx(w,{}):e.jsx(b,{}):null]}),e.jsxs("div",{className:"flex cursor-pointer flex-row items-center",onClick:()=>l("timestamp"),children:[e.jsx(S,{text:"Timestamp"}),t==="timestamp"?s==="asc"?e.jsx(w,{}):e.jsx(b,{}):null]}),u.map(r=>e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm",children:r.name},r.name),e.jsx("span",{className:"bg-token-main-surface-tertiary line-clamp-1 rounded-lg p-0.5 px-1 font-mono text-xs",children:d(r.ms)},r.name+r.ms)]}))]})})}function zt(){const t=p(n=>n.server.messages);return e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-token-text-secondary px-4 py-2 text-lg font-semibold",children:"Messages"}),e.jsx("div",{className:"grow overflow-hidden",children:e.jsx(ye,{children:e.jsx(g.ul,{className:"pointer-events-none flex w-full flex-col gap-4 pt-4 pb-24",initial:"initial",animate:"animate",exit:"exit",variants:J,transition:{delayChildren:.25,staggerChildren:.05},children:t.map((n,s)=>e.jsx(Ht,{index:s,message:n},s))})})})]})}function Ft(){const t=p(u=>u.server.connectionState),n=p(u=>u.dev.room),[s,a]=c.useState("Unknown"),o=n?.localParticipant,i=n?.numParticipants??"Unknown",d=n?.activeSpeakers??[];return c.useEffect(()=>{if(o){const u=l=>{a(l)};return o.on("connectionQualityChanged",u),()=>{o.off("connectionQualityChanged",u)}}},[o]),e.jsxs(Q,{title:"Room",open:!1,children:[e.jsx(f,{name:"Connection Quality",text:String(s)}),e.jsx(f,{name:"Connection State",text:String(t)}),e.jsx(f,{name:"Participants",text:i}),e.jsx(f,{name:"Speakers",text:d.length}),e.jsx(Zt,{})]})}function Zt(){const t=p(x=>x.dev.room),[n,s]=c.useState(null),[a,o]=c.useState(null),[i,d]=c.useState(null),u=t?.getActiveDevice("audioinput"),l=t?.getActiveDevice("audiooutput"),r=t?.getActiveDevice("videoinput");return c.useEffect(()=>{async function x(){const j=await C.getLocalDevices("audioinput"),Y=await C.getLocalDevices("audiooutput"),q=await C.getLocalDevices("videoinput"),K=j.find(h=>h.deviceId===u),X=Y.find(h=>h.deviceId===l),ee=q.find(h=>h.deviceId===r);s(K?.label??"Unknown"),o(X?.label??"Unknown"),d(ee?.label??null)}x()},[u,l,r]),e.jsxs(e.Fragment,{children:[e.jsx(S,{text:"Devices"}),i?e.jsx(f,{icon:fe,name:"Video Input",text:i}):null,e.jsx(f,{icon:me,name:"Audio Input",text:n??"Unknown"}),e.jsx(f,{icon:ke,name:"Audio Output",text:a??"Unknown"})]})}function Q({title:t,titleClassName:n,children:s,open:a}){const[o,i]=c.useState(a??!0);return e.jsxs("div",{children:[e.jsxs("h3",{className:re("text-token-text-secondary flex cursor-pointer items-center py-2 text-lg font-semibold",n),onClick:()=>i(!o),children:[e.jsx("span",{children:t}),e.jsx("span",{className:"ms-2",children:o?e.jsx(b,{className:"h-4 w-4"}):e.jsx(w,{className:"h-4 w-4"})})]}),e.jsx(y,{initial:!1,children:o&&e.jsx(g.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{height:"auto",opacity:1},collapsed:{height:0,opacity:0}},transition:{duration:.3,ease:"easeInOut"},layout:!0,children:s},"content")})]})}function S({text:t}){return e.jsx("h4",{className:"py-2 text-sm font-semibold",children:t})}function f(t){return e.jsxs("div",{className:"flex flex-row flex-nowrap items-center gap-2",children:[e.jsx("span",{className:"opacity-85",children:t.icon?e.jsx(t.icon,{className:"h-[0.75rem] w-[0.75rem]"}):e.jsxs("span",{className:"text-sm",children:[t.name,":"]})}),t.content??e.jsx("span",{className:"bg-token-main-surface-tertiary line-clamp-1 rounded-lg p-0.5 px-1 font-mono text-xs",children:t.text})]})}function Ht({index:t,message:n}){const[s,a]=c.useState(!1),o=I();let i=null;switch(n.source){case"remote":i=ve;break;case"local":i=pe;break}return e.jsx(g.div,{className:"border-token-main-surface-tertiary w-full border-t p-4",variants:J,children:e.jsxs("div",{className:"bg-token-main-surface-secondary flex w-full flex-col gap-2 rounded-lg",children:[e.jsxs("div",{className:"text-token-text-secondary font-mono text-[0.65rem] font-semibold",children:[e.jsxs("div",{className:"flex w-full flex-row flex-nowrap items-center justify-between",children:[e.jsxs("div",{className:"flex flex-row flex-nowrap items-center gap-1",children:[e.jsx(i,{className:"text-token-text-secondary h-3 w-3"}),e.jsx("span",{children:` | ${t+1} | ${o.formatDate(n.timestamp,{hour:"numeric",minute:"numeric",second:"numeric",fractionalSecondDigits:2})}`})]}),e.jsx("div",{className:"flex flex-row flex-nowrap items-center gap-2",children:e.jsx(ie,{className:"rounded-full p-0.5",color:"ghost",size:"small",onClick:()=>a(d=>!d),children:e.jsx(b,{className:`transform transition-transform ${s?"rotate-180":""}`})})})]}),e.jsx("div",{className:"mt-1 text-xs font-bold",children:n.type})]}),e.jsx(y,{children:s?e.jsx(g.pre,{initial:{opacity:0,transform:"blur(4px)"},animate:{opacity:1,transform:"blur(0px)"},exit:{opacity:0,transform:"blur(4px)"},className:"bg-token-main-surface-tertiary text-token-text-secondary overflow-x-auto rounded-md p-2 text-xs",children:JSON.stringify(n.payload,null,2)}):null})]})})}const J={hidden:{opacity:0,x:100},animate:{opacity:1,x:0},exit:{opacity:0,x:100}};export{ln as VoiceModeDevPanel};
//# sourceMappingURL=cmi9jy9f2dh4ge93.js.map
