import{V as L,cW as R,eG as b,aW as D,bX as B,cX as X,aG as q,cH as G,a as P,cr as Z,ae as K,e9 as se,cF as E,cm as te,fB as ne}from"./haannt40upmuwmtk.js";import{r as f,e as y,j as e,M as i,ae as k,d as z,u as ie}from"./khl8ktun31iepecq.js";import{jA as J,br as Q,bh as ee,bu as F,bp as C,jB as le,ha as A,jC as oe,bm as re,cR as ce,aH as de,jD as ue,bs as ge,bt as me,bv as fe,jE as xe,cV as pe,aU as he,aX as je,jF as Me,du as ye,hJ as ve,bJ as be}from"./n4exq6o15ap1g74l.js";import{c as Ce}from"./iej0cupg2dqkmejt.js";import{b as Se,c as we,S as Ne,d as Be}from"./gfrr7h86bcoshbke.js";import{B as Te}from"./ccczqb3acmeh2bf3.js";import{a as Ie,d as V,e as H,g as Y,f as Le,c as Ee,A as _e}from"./iqgtlgql06vo3uc8.js";import"./hyae97tnl7ms3bn9.js";import"./e473oe6zkw5lqbph.js";import"./m4g7yy9fehqi204r.js";import"./jjqeoesb3rhorlyg.js";import"./dfz2bdgqh4yduujb.js";import"./b3mht1lg7zv7qd3d.js";import"./eiq9v0oy1lyfg3c8.js";import"./dlwdwnl197lh1mf5.js";import"./dblaaxd78ezocyc0.js";import"./lk6form9dwf6vk73.js";import"./cvxq2e4ugtgn6d3k.js";import"./id3olky7887s2bz2.js";import"./mhqi8r5v3dwotfod.js";import"./dpa3s8fe1cgkjbnk.js";var N=(a=>(a.FLEXIBLE="month",a.ANNUAL="year",a))(N||{});const Pe=Ce(N);function De({isOpen:a,onClose:n,initialTeamBillingType:s,renewalDate:t,accountId:l,billingDetails:o}){const[r,d]=f.useState(s),[u,g]=f.useState(!1),[h,m]=f.useState(!1),x=y(),v=L(),j=J(l),T=async()=>{m(!0);try{await j.mutateAsync({accountId:l,updatedPriceInterval:r==="month"?"month":"year",updatedSeats:void 0}),m(!1),v.success(x.formatMessage({id:"teamBilling.successfullyUpdatedSubscription",defaultMessage:"Your subscription was updated successfully"}),{hasCloseButton:!0}),g(!1),n()}catch{v.warning(x.formatMessage({id:"teamBilling.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0})}finally{m(!1)}},{flexibleBillingPlan:w,annualBillingPlan:S}=Q(o.currency),O=r==="month"?w:S,I=()=>{g(!1),d(s),n()};return e.jsx(R,{testId:"modal-teams-change-billing-schedule",type:"success",isOpen:a,onClose:I,size:"custom",className:"max-w-xl",noPadding:!0,title:u?x.formatMessage({id:"teamBilling.changeBillingScheduleConfirmTitle",defaultMessage:"Confirm changes"}):x.formatMessage({id:"teamBilling.changeBillingScheduleTitle",defaultMessage:"Change billing schedule"}),showCloseButton:!0,children:u?e.jsx(ze,{selectedPlan:r,initialTeamBillingType:s,renewalDate:t,handleUpdate:T,isUpdating:h,selectedBillingPlan:O,onClose:I}):e.jsx(ke,{setSelectedPlan:d,selectedPlan:r,initialTeamBillingType:s,setConfirmPage:g,renewalDate:t,flexibleBillingPlan:w,annualBillingPlan:S,onClose:I})})}function ke({selectedPlan:a,setSelectedPlan:n,initialTeamBillingType:s,setConfirmPage:t,renewalDate:l,flexibleBillingPlan:o,annualBillingPlan:r,onClose:d}){const u=y();return e.jsxs("div",{className:"flex flex-col p-6",children:[e.jsx("div",{className:"grid grid-flow-row grid-cols-2",children:e.jsxs(ee,{className:"col-span-2 grid gap-4 md:col-span-2 md:grid-cols-2",defaultValue:a,onValueChange:g=>{Pe(g)&&n(g)},children:[e.jsx(F,{billingType:"month",...o,selectedValue:a}),e.jsx(F,{billingType:"year",...r,selectedValue:a})]})}),e.jsx("span",{className:"text-token-text-secondary mt-5 text-sm",children:e.jsx(i,{...C.changeEffectDate,values:{date:e.jsx(k,{value:l,year:"numeric",month:"long",day:"numeric"})}})}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-2",children:[e.jsx(b,{title:u.formatMessage(C.cancel),color:"secondary",onClick:()=>d()}),e.jsx(b,{title:u.formatMessage(C.continueToPricePreview),disabled:a===s,color:"primary",onClick:()=>t(!0)})]})]})}function ze({initialTeamBillingType:a,selectedPlan:n,renewalDate:s,handleUpdate:t,isUpdating:l,selectedBillingPlan:o,onClose:r}){const d=y();return e.jsxs("div",{className:"p-4",children:[e.jsx("span",{className:"text-sm",children:e.jsx(i,{...C.confirmPageChangeEffectDate,values:{current_plan:a==="month"?"Flexible (monthly)":"Annual",new_plan:n==="month"?"Flexible (monthly)":"Annual",date:e.jsx(k,{value:s,year:"numeric",month:"long",day:"numeric"})}})}),e.jsxs("div",{className:"bg-token-main-surface-secondary mt-4 flex flex-col rounded-xl p-4",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...o.name})}),e.jsx("span",{className:"text-sm",children:e.jsx(i,{...o.cost,values:{monthlyCost:o.monthlyCost,discountedMonthlyCost:o.discountedMonthlyCost,currencyCode:d.formatMessage(o.currencyCode),currencySign:d.formatMessage(o.currencySign),s:(...u)=>e.jsx(le,{children:u})}})}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:e.jsx(i,{...o.costStructure})})]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx(b,{title:d.formatMessage(C.cancel),color:"secondary",onClick:r}),e.jsx(b,{title:d.formatMessage(C.confirmChange),color:"primary",onClick:t,loading:l})]})]})}const Ae=a=>f.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a},f.createElement("path",{d:"M8 2C8.55229 2 9 2.44772 9 3H15C15 2.44772 15.4477 2 16 2C16.5523 2 17 2.44772 17 3V3.0085C17.3129 3.01563 17.5975 3.02883 17.8556 3.05335C18.3774 3.10292 18.8601 3.20369 19.316 3.43597C20.0686 3.81947 20.6805 4.43139 21.064 5.18404C21.3113 5.66937 21.4099 6.18608 21.4558 6.74817C21.5 7.28936 21.5 7.95372 21.5 8.75868V14.0118C21.5 14.0462 21.5 14.0801 21.5 14.1136C21.5003 14.7486 21.5006 15.2284 21.3895 15.6911C21.2915 16.0993 21.1299 16.4895 20.9106 16.8474C20.6619 17.2531 20.3225 17.5922 19.8733 18.041C19.8496 18.0647 19.8255 18.0887 19.8012 18.113L18.613 19.3012C18.5887 19.3255 18.5647 19.3495 18.541 19.3733C18.0922 19.8225 17.7531 20.1619 17.3474 20.4106C16.9895 20.6299 16.5993 20.7915 16.1911 20.8895C15.7284 21.0006 15.2486 21.0003 14.6136 21C14.5801 21 14.5462 21 14.5118 21H8.25868C7.45372 21 6.78936 21 6.24818 20.9558C5.68608 20.9099 5.16937 20.8113 4.68404 20.564C3.93139 20.1805 3.31947 19.5686 2.93597 18.816C2.68868 18.3306 2.59012 17.8139 2.54419 17.2518C2.49998 16.7106 2.49999 16.0463 2.5 15.2413V8.7587C2.49999 7.95373 2.49998 7.28937 2.54419 6.74817C2.59012 6.18608 2.68868 5.66937 2.93597 5.18404C3.31947 4.43139 3.93139 3.81947 4.68404 3.43597C5.13993 3.20369 5.62264 3.10292 6.14437 3.05335C6.40251 3.02883 6.68711 3.01563 7 3.0085V3C7 2.44772 7.44772 2 8 2ZM7 5.00905C6.74249 5.01544 6.52466 5.02623 6.33353 5.04439C5.9455 5.08125 5.73848 5.14336 5.59202 5.21799C5.2157 5.40973 4.90973 5.7157 4.71799 6.09202C4.6383 6.24842 4.57337 6.47262 4.53755 6.91104C4.50078 7.36113 4.5 7.94342 4.5 8.8V15.2C4.5 16.0566 4.50078 16.6389 4.53755 17.089C4.57337 17.5274 4.6383 17.7516 4.71799 17.908C4.90973 18.2843 5.2157 18.5903 5.59202 18.782C5.74842 18.8617 5.97262 18.9266 6.41104 18.9624C6.86113 18.9992 7.44342 19 8.3 19H14V18C14 15.7909 15.7909 14 18 14H19C19.1821 14 19.3529 14.0487 19.4999 14.1337C19.5 14.0947 19.5 14.054 19.5 14.0118V8.8C19.5 7.94342 19.4992 7.36113 19.4624 6.91104C19.4266 6.47262 19.3617 6.24842 19.282 6.09202C19.0903 5.71569 18.7843 5.40973 18.408 5.21799C18.2615 5.14336 18.0545 5.08125 17.6665 5.04439C17.4753 5.02623 17.2575 5.01544 17 5.00905V6C17 6.55228 16.5523 7 16 7C15.4477 7 15 6.55228 15 6V5H9V6C9 6.55228 8.55229 7 8 7C7.44772 7 7 6.55228 7 6V5.00905ZM19.0616 15.9981C19.0412 15.9994 19.0207 16 19 16H18C16.8954 16 16 16.8954 16 18V18.857C16.1047 18.8151 16.2059 18.7644 16.3024 18.7053C16.4807 18.596 16.6463 18.4395 17.1988 17.887L18.387 16.6988C18.7495 16.3363 18.9415 16.1404 19.0616 15.9981Z",fill:"currentColor"})),Oe="https://q.surveysapp.org/jfe/form/SV_9vIX2bUyeLKgCZo";function Ue({isOpen:a,onClose:n}){const s=y(),t=L(),{data:l,isLoading:o}=A(),r=D(),d=oe(r?.id),u=re(),[g,h]=f.useState(""),[m,x]=f.useState(!1),v=u?.email&&g.toLowerCase()==u.email.toLowerCase(),[j,T]=f.useState(l&&!l.will_renew);if(o||!r||!l)return null;const w=async()=>{x(!0);try{await d.mutateAsync(r.id),T(!0),window.open(`${Oe}?user_id=${u?.id}&account_id=${r.id}&plan_type=${l.plan_type}`,"_blank")}catch{t.warning(s.formatMessage(p.errorCancellingSubscription),{hasCloseButton:!0})}finally{x(!1)}};return e.jsx(R,{testId:"modal-cancel-team-plan",type:"success",onClose:n,showCloseButton:!0,isOpen:a,className:"",title:e.jsx("span",{className:"text-lg",children:e.jsx(i,{...p.cancelPlan})}),children:j?e.jsxs("div",{children:[e.jsx("h3",{className:"text-token-text-primary mb-2 text-base font-semibold",children:e.jsx(i,{...p.successfullyCanceled})}),l.active_until!=null&&e.jsx("p",{className:"text-token-text-primary text-sm",children:e.jsx(i,{...p.retainUntil,values:{expiryDate:new Date(l.active_until)}})}),e.jsx("div",{className:"mt-6 flex w-full flex-row justify-end",children:e.jsx(b,{title:s.formatMessage(p.doneButton),color:"primary",onClick:n,disabled:m})})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[e.jsxs("div",{className:"flex w-full items-center gap-4",children:[e.jsx(ce,{src:r.data.profilePictureUrl,size:"large"}),e.jsxs("div",{className:"flex-col",children:[e.jsx("p",{className:"font-semibold",children:r.data.name}),e.jsx("p",{className:"text-token-text-secondary text-sm",children:e.jsx(i,{...p.membersCount,values:{count:l.seats_entitled}})})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("h3",{className:"text-token-text-primary mb-2 text-base font-semibold",children:e.jsx(i,{...p.areYouSure})}),e.jsxs("ul",{className:"text-token-text-secondary list-disc ps-5 text-sm",children:[e.jsx("li",{className:"my-2",children:e.jsx(i,{...p.dataUnavailable})}),l.active_until!=null&&e.jsx("li",{className:"my-2",children:e.jsx(i,{...p.retainUntil,values:{expiryDate:new Date(l.active_until)}})}),e.jsx("li",{className:"my-2",children:e.jsx(i,{...p.retainEmailAccess})})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("h3",{className:"text-token-text-primary mb-2 text-base font-semibold",children:e.jsx(i,{...p.enterEmailToConfirm})}),e.jsx(de,{ariaLabel:s.formatMessage(p.enterEmailToConfirm),type:"text",name:"user-email",placeholder:"abcd@acme.com",onChange:S=>{h(S.target.value)}})]})]}),e.jsxs("div",{className:"mt-6 flex w-full flex-row justify-end",children:[e.jsx(b,{title:s.formatMessage(p.keepSubscriptionButton),onClick:n,disabled:m}),e.jsx(b,{title:s.formatMessage(p.cancelSubscriptionButton),onClick:w,disabled:!v,loading:m,color:"danger",className:"ms-2"})]})]})})}const p=z({dataUnavailable:{id:"cancelTeamPlanModal.dataUnavailable",defaultMessage:"All workspace data including chat history and settings will not be available."},cancelPlan:{id:"cancelTeamPlanModal.cancelPlan",defaultMessage:"Cancel subscription"},retainUntil:{id:"cancelTeamPlanModal.retainUntil",defaultMessage:"You will retain access to the workspace until the end of your billing cycle on {expiryDate, date, long}."},retainEmailAccess:{id:"cancelTeamPlanModal.retainEmailAccess",defaultMessage:"You will still be able to use ChatGPT with the other workspaces associated with this email address."},errorCancellingSubscription:{id:"cancelTeamPlanModal.errorCancellingSubscription",defaultMessage:"There was a problem cancelling your subscription."},areYouSure:{id:"cancelTeamPlanModal.areYouSure",defaultMessage:"Are you sure?"},enterEmailToConfirm:{id:"cancelTeamPlanModal.enterEmailToConfirm",defaultMessage:"Enter your Email address to confirm"},emailPlaceholder:{id:"cancelTeamPlanModal.emailPlaceholder",defaultMessage:"abcd@acme.com"},doneButton:{id:"cancelTeamPlanModal.doneButton",defaultMessage:"Done"},keepSubscriptionButton:{id:"cancelTeamPlanModal.keepSubscriptionButton",defaultMessage:"Keep subscription"},cancelSubscriptionButton:{id:"cancelTeamPlanModal.cancelSubscriptionButton",defaultMessage:"Cancel subscription"},successfullyCanceled:{id:"cancelTeamPlanModal.successfullyCanceled",defaultMessage:"You have successfully canceled your subscription."},membersCount:{id:"yourComponent.membersCount",defaultMessage:"{count, plural, one {# member} other {# members}}"}}),Fe=B.p`text-base font-semibold mb-3 mt-3`;function Ve({isOpen:a,onClose:n,initialTeamBillingType:s,initialSeats:t,accountId:l,renewalDate:o,billingDetails:r}){const d=y(),u=L(),[g,h]=f.useState(t),[m,x]=f.useState(!1),[v,j]=f.useState(!1),{flexibleBillingPlan:T,annualBillingPlan:w}=Q(r.currency),S=s===ue.FLEXIBLE?T:w,O=J(l),I=async()=>{j(!0);try{await O.mutateAsync({accountId:l,updatedPriceInterval:void 0,updatedSeats:g}),j(!1),u.success(d.formatMessage({id:"teamBilling.successfullyUpdatedSubscription",defaultMessage:"Your subscription was updated successfully"}),{hasCloseButton:!0}),x(!1),n()}catch{u.warning(d.formatMessage({id:"teamBilling.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0})}finally{j(!1)}},U=()=>{x(!1),h(t),n()};return e.jsx(R,{testId:"modal-teams-manage-seats",type:"success",isOpen:a,onClose:U,size:"custom",noPadding:!0,className:"max-w-2xl",showCloseButton:!0,title:m?d.formatMessage({id:"teamsManageSeatsModal.title",defaultMessage:"Manage seats"}):d.formatMessage({id:"teamsManageSeatsModalConfirmPage.title",defaultMessage:"Review"}),children:m?e.jsx(Re,{numSeats:g,initialSeats:t,handleUpdate:I,isUpdating:v,renewalDate:o,accountId:l,selectedPlanBillingInfo:S,onClose:U}):e.jsx(He,{selectedPlan:s,selectedPlanBillingInfo:S,numSeats:g,initialSeats:t,setNumSeats:h,renewalDate:o,setConfirmPage:x,billingDetails:r})})}function He({selectedPlan:a,selectedPlanBillingInfo:n,numSeats:s,initialSeats:t,setNumSeats:l,setConfirmPage:o,billingDetails:r,renewalDate:d}){const u=y(),g=ge(isNaN(s)?0:s,t,me);return e.jsxs("div",{className:"grid grid-flow-row grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col gap-2 p-5",children:[e.jsx(fe,{numSeats:s,minSeats:t,setNumSeats:l}),e.jsx(ee,{className:"col-span-2 grid md:col-span-1 md:grid-cols-1",defaultValue:a,children:e.jsx(F,{billingType:a,...n,selectedValue:a})})]}),e.jsxs("div",{className:"border-token-main-surface-tertiary bg-token-main-surface-secondary col-span-3 flex h-full flex-col overflow-hidden border-s p-6 md:col-span-1",children:[e.jsx(Fe,{children:e.jsx(i,{...C.summaryTitle})}),e.jsx(Te,{numSeats:g,selectedPlan:a,billingDetails:r,totalLabel:C.allPlansTotal,billDate:e.jsx(k,{value:d,year:"numeric",month:"long",day:"numeric"})}),e.jsx(b,{title:u.formatMessage(M.continue),disabled:g===t,onClick:()=>o(!0),className:"w-full rounded-xl",color:"primary"})]})]})}function Re({numSeats:a,initialSeats:n,renewalDate:s,handleUpdate:t,isUpdating:l,accountId:o,selectedPlanBillingInfo:r,onClose:d}){const u=y(),{data:g,isError:h,isLoading:m}=xe(o,a);if(m)return e.jsx("div",{className:"flex items-center justify-center py-32",children:e.jsx(X,{})});if(!(h||!g))return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...M.additionalSeats,values:{additionalSeats:a-n}})}),e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...M.additionalSeatsTotal,values:{currencySign:u.formatMessage(r.currencySign),totalCost:(g.total_amount/100).toFixed(2)}})})]}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:e.jsx(i,{...M.proratedAmountMessage})}),e.jsx("span",{className:"bg-token-main-surface-secondary text-token-text-secondary mt-4 flex flex-col rounded-2xl p-4 text-sm",children:e.jsx(i,{...M.chargeMessage,values:{numSeats:a,date:e.jsx(k,{value:s,year:"numeric",month:"long",day:"numeric"})}})}),e.jsx("hr",{className:"mt-4"}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...M.subtotal})}),e.jsx("span",{children:e.jsx(i,{...M.subtotalPrice,values:{currencySign:u.formatMessage(r.currencySign),totalCost:(g.amount_excluding_tax/100).toFixed(2)}})})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...M.tax})}),e.jsx("span",{children:e.jsx(i,{...M.taxAmount,values:{currencySign:u.formatMessage(r.currencySign),tax:(g.tax_amount/100).toFixed(2)}})})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...M.totalDueToday})}),e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...M.totalDueTodayAmount,values:{currencySign:u.formatMessage(r.currencySign),totalCost:(g.total_amount/100).toFixed(2)}})})]}),e.jsx("hr",{className:"mt-4"}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx(b,{title:u.formatMessage(C.cancel),color:"secondary",onClick:d,disabled:l}),e.jsx(b,{title:u.formatMessage(M.payNow),color:"primary",onClick:t,loading:l})]})]})}const M={continue:{id:"teamsManageSeatsModal.continue",defaultMessage:"Continue",description:"Continue button for manage seats modal"},payNow:{id:"teamsManageSeatsModal.payNow",defaultMessage:"Pay now",description:"Team manage seats modal pay now button"},tax:{id:"teamsManageSeatsModal.tax",defaultMessage:"Tax",description:"Tax label"},subtotal:{id:"teamsManageSeatsModal.subTotal",defaultMessage:"Subtotal",description:"Subtotal label"},proratedAmountMessage:{id:"teamsManageSeatsModal.proratedAmountMessage",defaultMessage:"Prorated amount until next billing cycle",description:"Informing user that they will be charged a prorated amount today"},chargeMessage:{id:"teamsManageSeatsModal.chargeMessage",defaultMessage:"You will be charged for {numSeats} total seats at your next renewal on {date}",description:"Number of additional seats being purchased"},additionalSeats:{id:"teamsManageSeatsModal.additionalSeats",defaultMessage:"{additionalSeats} additional {additionalSeats, plural, one {seat} other {seats}}",description:"Number of additional seats being purchased"},additionalSeatsTotal:{id:"teamsManageSeatsModal.additionalSeatsTotal",defaultMessage:"{currencySign}{totalCost}",description:"Summary total of selected plan"},subtotalPrice:{id:"teamsManageSeatsModal.subtotalPrice",defaultMessage:"{currencySign}{totalCost}",description:"Subtotal price for selected plan"},taxAmount:{id:"teamsManageSeatsModal.taxAmount",defaultMessage:"{currencySign}{tax}",description:"Tax amount"},totalDueToday:{id:"teamsManageSeatsModal.totalDueToday",defaultMessage:"Total due today",description:"Total due today label"},totalDueTodayAmount:{id:"teamsManageSeatsModal.totalDueTodayAmount",defaultMessage:"{currencySign}{totalCost}",description:"Total due today"}};function We({numInUse:a,numAllocated:n,isTeam:s,subscriptionWillRenew:t,subscriptionBillingPeriod:l,accountId:o,subscriptionRenewalDate:r,billingDetails:d}){const g=Math.max(n,a)>10?$e:Ge,h=q("3954884439")?.value,[m,x]=f.useState(!1),v=function(){x(!m)},j=l==="monthly"?N.FLEXIBLE:N.ANNUAL;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"mt-1 text-start text-sm",children:e.jsx(i,{...$.description,values:{num:`${a}/${n}`}})}),s&&t&&h&&e.jsx(G,{color:"secondary",className:"text-end",onClick:v,children:e.jsx(i,{id:"components.business.NumSeats.manageSeats",defaultMessage:"Manage seats"})}),e.jsx(Ve,{isOpen:m,onClose:v,initialTeamBillingType:j,initialSeats:n,accountId:o,renewalDate:r,billingDetails:d})]}),e.jsx(g,{numInUse:a,numAllocated:n})]})}function $e({numAllocated:a,numInUse:n}){const s=y(),t=n>a,l=t?100:n/a*100,o=t?a/n*100:100;return e.jsx("div",{className:P("relative w-full rounded-full",t?"bg-orange-500":"bg-token-main-surface-primary"),children:e.jsxs("div",{className:"relative h-4",style:{width:`${o}%`},children:[e.jsx("div",{className:P("h-4 overflow-hidden rounded-s-full bg-green-600",n===a&&"rounded-e-full"),style:{width:`${l}%`}}),n!==a&&t&&e.jsx("div",{className:"bg-token-main-surface-primary absolute end-0 top-[-3px]",children:e.jsx(Z,{label:s.formatMessage($.dividerTooltip,{count:a}),children:e.jsx(ae,{className:"px-1 py-0.5"})})})]})})}const ae=({className:a})=>e.jsxs("div",{className:P("flex flex-col gap-0.5",a),children:[e.jsx(_,{}),e.jsx(_,{}),e.jsx(_,{}),e.jsx(_,{})]}),W=B.div`h-4 w-4 rounded-full`,Ye=B(W)`bg-green-600`,Xe=B(W)`bg-token-main-surface-tertiary`,qe=B(W)`bg-orange-500`,_=B.span`w-[3px] h-[3px] bg-gray-400 dark:bg-gray-500 rounded-full`;function Ge({numAllocated:a,numInUse:n}){const s=y(),t=n>a,l=f.useMemo(()=>Array.from(Array(t?n:a).keys()),[t,a,n]);return e.jsx("div",{className:"flex items-center gap-2",children:l.map(o=>{let r=qe,d=null;return o<n&&!t?r=Ye:o<a&&!t&&(r=Xe),o===a-1&&(d=e.jsx(Z,{label:s.formatMessage($.dividerTooltip,{count:a}),children:e.jsx(ae,{})})),e.jsxs(e.Fragment,{children:[e.jsx(r,{},o),d]})})})}const $=z({dividerTooltip:{defaultMessage:"Your team has {count, plural, =0 {no seats} one {# seat} other {# seats}} purchased",id:"components.business.NumSeats.dividerTooltip"},description:{defaultMessage:"{num} seats in use",id:"components.business.NumSeats.description"}});function Ze(a,n){const s=y(),t=L();return ie({queryKey:["organization-invoices",{...a,options:n}],queryFn:async()=>await K.getInvoices(a,n).catch(l=>{throw t.danger(s.formatMessage(Je.invoicesLoadError,{error:l.message})),l}),enabled:"account_id"in a||"organization_id"in a})}function Ke(a){const n=D(),s=n?.id,t=n?.data.organizationId??void 0,l=n?.isEnterprisey();return Ze(l?{organization_id:t}:{account_id:s},a)}const Je=z({invoicesLoadError:{id:"organizationBillingInfo.invoicesLoadError.0",defaultMessage:"Failed to load invoices. Contact support@openai.com if error persists."}});function Qe(){const{data:a,isLoading:n,isError:s}=A(),t=D();if(n)return e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx(X,{})});if(s||!a||!t)return null;const l=a.active_until!=null,o=a?.seats_in_use>a?.seats_entitled;return e.jsx(e.Fragment,{children:e.jsxs(V,{children:[e.jsx(H,{children:e.jsx(i,{...c.planTitle})}),e.jsx("hr",{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Y,{children:t?.isEdu()?l?e.jsx(i,{...c.activeEduLicense}):t?.isResellerHosted()?e.jsx(i,{...c.resellerHostedEduLicense}):e.jsx(i,{...c.pendingEduLicense}):t?.isEnterprisey()?l?e.jsx(i,{...c.activeEnterpriseLicense}):t?.isResellerHosted()?e.jsx(i,{...c.resellerHostedEnterpriseLicense}):e.jsx(i,{...c.pendingEnterpriseLicense}):l?a.non_profit_org_discount_applied?e.jsx(i,{...c.activeTeamLicenseNonProfitOrg}):e.jsx(i,{...c.activeTeamLicense}):e.jsx(i,{...c.pendingTeamLicense})}),a.active_until!=null&&e.jsx(Le,{className:"mt-1",children:t?.isEnterprisey()?e.jsx(i,{...c.licenseExpiry,values:{expiryDate:new Date(a.active_until)}}):a.will_renew?e.jsx(i,{...c.renewalDate,values:{expiryDate:new Date(a.active_until)}}):e.jsx(i,{...c.deactivateDate,values:{expiryDate:new Date(a.active_until)}})})]}),e.jsx(ea,{})]}),e.jsx("hr",{}),l&&e.jsxs("div",{children:[e.jsx(Y,{children:e.jsx(i,{...c.seatsTitle})}),e.jsx(ta,{isTeam:t?.isTeam()??!1,accountId:t.id}),t?.isTeam()&&o&&e.jsxs("span",{className:"text-token-text-secondary text-sm",children:[e.jsx(i,{...c.teamsAutochargeMessage}),e.jsx(he,{className:"ps-1",openNewTab:!0,href:"https://help.openai.com/en/articles/8792536-manage-billing-on-the-chatgpt-team-subscription-plan",children:e.jsx(i,{...c.billingLearnMore})})]})]}),e.jsx("hr",{})]})})}function ea(){const[a,n]=f.useState(!1),s=y(),t=L(),l=D(),{data:o}=A(),[r,d]=f.useState(!1),u=function(){d(!r)},[g,h]=f.useState(!1),m=q("1318146997")?.value;if(!l||!l.isTeam()||!o)return;const x=async()=>{n(!0);try{const j=await K.fetchCustomerPortalUrl(l?.getWorkspaceId());location.href=j.url}catch{t.warning(s.formatMessage(c.stripeErrorWarning),{hasCloseButton:!0})}finally{n(!1)}},v=o?.billing_period==="monthly"?N.FLEXIBLE:N.ANNUAL;return e.jsxs(e.Fragment,{children:[e.jsxs(se,{size:"default",contentAlign:"end",sideOffset:4,triggerButton:e.jsx(G,{color:"secondary",icon:je,children:e.jsx(i,{...c.manageLicenseBtn})}),children:[e.jsx(E.Item,{icon:Ne,onClick:x,children:e.jsx(i,{...c.managePaymentMethod})}),o.will_renew&&m&&e.jsx(E.Item,{icon:Ae,onClick:()=>h(!0),children:e.jsx(i,{...c.manageBillingSchedule})}),o?.will_renew&&e.jsx(E.Separator,{}),o?.will_renew&&e.jsx(E.Item,{icon:Me,color:"danger",onClick:()=>{u()},children:e.jsx(i,{...c.cancelSubscriptionBtn})})]}),o.active_until!=null&&e.jsx(De,{isOpen:g,onClose:()=>h(!1),initialTeamBillingType:v,renewalDate:new Date(o.active_until),accountId:l.id,billingDetails:{currency:o.billing_currency}}),e.jsx(Ue,{isOpen:r,onClose:u})]})}function aa({invoice:a}){const n=a?.status_transitions.paid_at!=null&&new Date(a.status_transitions.paid_at*1e3),s=a&&new Date(a.due_date*1e3),t=a&&new Date(a.created*1e3);return e.jsxs(_e,{className:"items-center",children:[e.jsxs("div",{className:"flex grow flex-col gap-1",children:[e.jsx("span",{children:t?e.jsx(i,{...c.invoiceName,values:{createdDate:t}}):e.jsx(i,{...c.defaultInvoiceName})}),a?.paid&&n!=null?e.jsx("div",{className:"text-token-text-secondary text-xs",children:e.jsx(i,{...c.paidInvoice,values:{invoiceDate:n}})}):a&&e.jsx("div",{className:"text-xs text-green-600",children:e.jsx(i,{...c.upcomingInvoice,values:{invoiceDate:s}})})]}),e.jsx("a",{href:a?.hosted_invoice_url,className:P("mx-auto",a?.hosted_invoice_url==null&&"cursor-not-allowed opacity-20"),target:"_blank",rel:"noreferrer",children:e.jsx(be,{className:"icon-sm text-green-600"})})]})}function sa(){const[a,n]=f.useState({limit:5}),{data:s,isError:t}=Ke(a),l=a.startingAfter!=null||a.endingBefore!=null&&s?.has_more,o=a.endingBefore!=null||s?.has_more&&a.endingBefore==null;return t||s==null?e.jsxs(V,{children:[e.jsx(H,{children:e.jsx(i,{...c.invoicesTitle})}),e.jsx(ye,{children:e.jsx(i,{...c.noInvoices})})]}):e.jsxs(V,{children:[e.jsx(H,{children:e.jsx(i,{...c.invoicesTitle})}),e.jsx(Ee,{children:s.data.map(r=>e.jsx(aa,{invoice:r},r.id))}),e.jsxs("div",{className:"flex",children:[l&&e.jsx("button",{onClick:()=>{s&&n(r=>({...r,endingBefore:s.data[0].id,startingAfter:void 0}))},children:e.jsx(ve,{className:"icon-sm"})}),e.jsx("div",{className:"grow"}),o&&e.jsx("button",{onClick:()=>{s&&n(r=>({...r,startingAfter:s.data[s.data.length-1].id,endingBefore:void 0}))},children:e.jsx(te,{className:"icon-sm"})})]})]})}function ta({isTeam:a,accountId:n}){const{data:s,isLoading:t,isError:l}=A();return l||!s||t||!s.billing_period||!s.active_until?null:e.jsx(We,{numInUse:s.seats_in_use,numAllocated:s.seats_entitled,isTeam:a,subscriptionWillRenew:s.will_renew,subscriptionBillingPeriod:s.billing_period,subscriptionRenewalDate:new Date(s.active_until),accountId:n,billingDetails:{currency:s.billing_currency}})}function na(){const n=pe(t=>t.currentWorkspace)?.organizationId,s=y();return n===void 0?null:e.jsxs(e.Fragment,{children:[e.jsx(Se,{title:s.formatMessage(c.title),subtitle:s.formatMessage(c.subtitle)}),e.jsx(we,{children:e.jsxs(Ie,{children:[e.jsx(Qe,{}),e.jsx(sa,{})]})})]})}const c=z({title:{id:"organizationBillingInfo.title.1",defaultMessage:"Billing"},subtitle:{id:"organizationBillingInfo.subtitle",defaultMessage:"Only workspace owners can view and change these settings"},planTitle:{id:"organizationBillingInfo.planTitle",defaultMessage:"Plan"},activeEnterpriseLicense:{id:"organizationBillingInfo.activeEnterpriseLicense",defaultMessage:"Enterprise License"},pendingEnterpriseLicense:{id:"organizationBillingInfo.pendingEnterpriseLicense",defaultMessage:"Enterprise License (pending activation)"},resellerHostedEnterpriseLicense:{id:"organizationBillingInfo.resellerHostedEnterpriseLicense",defaultMessage:"Enterprise License"},activeEduLicense:{id:"organizationBillingInfo.activeEduLicense",defaultMessage:"Edu License"},pendingEduLicense:{id:"organizationBillingInfo.pendingEduLicense",defaultMessage:"Edu License (pending activation)"},resellerHostedEduLicense:{id:"organizationBillingInfo.resellerHostedEduLicense",defaultMessage:"Edu License"},activeTeamLicense:{id:"organizationBillingInfo.activeTeamLicense",defaultMessage:"Team License"},activeTeamLicenseNonProfitOrg:{id:"organizationBillingInfo.activeTeamLicenseNonProfitOrg",defaultMessage:"Team License (Non Profit Discount)"},pendingTeamLicense:{id:"organizationBillingInfo.pendingTeamLicense",defaultMessage:"Team License (pending activation)"},licenseExpiry:{id:"organizationBillingInfo.licenseExpiry",defaultMessage:"Active until {expiryDate, date, long}"},renewalDate:{id:"organizationBillingInfo.renewalDate",defaultMessage:"Renews on {expiryDate, date, long}"},deactivateDate:{id:"organizationBillingInfo.deactivateDate",defaultMessage:"Deactivates on {expiryDate, date, long}"},seatsTitle:{id:"organizationBillingInfo.seatsTitle",defaultMessage:"Seats"},seatsInUse:{id:"organizationBillingInfo.seatsInUse",defaultMessage:"{numSeats} in use ({numSeatsPct})"},invoicesTitle:{id:"organizationBillingInfo.invoicesTitle",defaultMessage:"Invoices"},invoiceName:{id:"organizationBillingInfo.invoiceName",defaultMessage:"Invoice: {createdDate, date, long}"},defaultInvoiceName:{id:"organizationBillingInfo.defaultInvoiceName",defaultMessage:"Invoice"},paidInvoice:{id:"organizationBillingInfo.paidInvoice",defaultMessage:"Paid: {invoiceDate, date, long}"},upcomingInvoice:{id:"organizationBillingInfo.upcomingInvoice",defaultMessage:"Due: {invoiceDate, date, long}"},noInvoices:{id:"organizationBillingInfo.noInvoices",defaultMessage:"No invoices found"},manageSubscription:{id:"organizationBillingInfo.manageSubscription",defaultMessage:"Manage subscription"},cancelSubscriptionBtn:{id:"organizationBillingInfo.cancelSubscriptionBtn",defaultMessage:"Cancel subscription"},manageLicenseBtn:{id:"organizationBillingInfo.manageLicenseBtn",defaultMessage:"Manage license"},managePaymentMethod:{id:"organizationBillingInfo.managePaymentMethod",defaultMessage:"Payment method"},manageBillingSchedule:{id:"organizationBillingInfo.manageSchedule",defaultMessage:"Billing schedule"},stripeErrorWarning:{id:"organizationBillingInfo.stripeErrorWarning",defaultMessage:"Error loading account information"},teamsAutochargeMessage:{id:"organizationBillingInfo.teamsAutochargeMessage",defaultMessage:"Your additional seats will be included on your next invoice."},billingLearnMore:{id:"organizationBillingInfo.billingLearnMore",defaultMessage:"Learn more"}}),Ba=ne(function(){return Be(),e.jsx(na,{})});export{Ba as default};
//# sourceMappingURL=iqbv6apsxxyd721f.js.map
