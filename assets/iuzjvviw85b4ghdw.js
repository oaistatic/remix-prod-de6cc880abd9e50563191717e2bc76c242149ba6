const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/o7zkmpa3qy4py88d.js","assets/khl8ktun31iepecq.js","assets/n4exq6o15ap1g74l.js","assets/haannt40upmuwmtk.js","assets/root-eulobrch.css","assets/conversation-small-bh1estgu.css","assets/i9hz850fstkvaggv.js","assets/tz4ej7gxut2bs91y.js","assets/bylwo0urduht67h8.js","assets/mrplmdgld1e6xzde.js","assets/clnsff4iry6w4nrt.js","assets/lipljdtfaomxepb8.js","assets/e4mtqust07fsbtad.js","assets/jbl38r5yycb2mrt9.js","assets/ce74if69ckoer67u.js","assets/hvdwpbr2ljyv44tg.js","assets/4ckzxvix48gclldi.js","assets/gz7bga55ows7jmp7.js","assets/hd4fy7o51pss65he.js","assets/lw7iuxfcvakfk3jy.js","assets/lwf90qiowciecvux.js","assets/iqvx7rzarjxgbosl.js","assets/n9mj8uc7ojykmfw2.js","assets/ici1r2pdfnai9c6r.js","assets/kiredz58u04n7vci.js","assets/njzb2k6yfzjolpk6.js","assets/gwmp2bbho6vd4qt8.js","assets/pb40qsj3szdq5sx1.js","assets/jows9759jdyt51hg.js","assets/kw97lv1qq6sjlhnf.js","assets/oyqlb501dhlk5b61.js","assets/dryvpx92fe6zevra.js","assets/b9iv65ef6it0bnl8.js","assets/h1em0bjkpkjv8ykw.js","assets/i3axmsntxbz0hz1f.js","assets/cv6si9v270pdl3vk.js","assets/mh4bwze9qp65qu97.js","assets/miy9m4xp0yschmng.js","assets/dlwdwnl197lh1mf5.js","assets/eiq9v0oy1lyfg3c8.js","assets/dblaaxd78ezocyc0.js","assets/ougcm9i7phfim0kn.js","assets/mr4t2sawqo9d3nrg.js","assets/pc2givv05uuq8g6l.js","assets/gna4hr6ugwtsnaih.js","assets/ctjt1fjp3mtlelcg.js","assets/cot-message-lf3q5fj1.css","assets/c0o2d6hkugb6w3of.js","assets/im6ysdo3xspl1742.js","assets/i6znoehwjoglo80e.js","assets/j1dfci759c59u8qn.js","assets/n1d2aipnlhx1bwjb.js","assets/o5lwpov0aqbkd311.js"])))=>i.map(i=>d[i]);
import{b8 as fe,ac as De,cq as z,a as b,V as Le,cX as Me,m as pe,dE as Oe,P as Re,o as Ie,F as he,E as Pe,T as Fe,aj as Q,gg as ze,bX as Y,aG as O,cm as Be,gO as $,fR as Ue,fS as Ve,cx as He,fL as ae,fK as Xe,D as We,da as Ke,co as y,cp as S,fb as Je,db as u,as as $e,at as Qe,gf as ne,K as Ye,z as Ze,aH as X,b$ as qe}from"./haannt40upmuwmtk.js";import{e as B,r as x,j as e,M as w,a9 as R,a8 as A,b as Ge}from"./khl8ktun31iepecq.js";import{iZ as es,i_ as ss,am as _e,ez as ts,eA as as,i$ as ns,j0 as is,aL as W,j1 as os,j2 as rs,j3 as ls,j4 as cs,j5 as ds,hv as ms,j6 as us,j7 as ie,j8 as F,j9 as oe,cm as je,cn as be,L as ye,R as U,ja as gs,jb as xs,jc as fs,jd as re,je as ve,ds as ps,jf as hs,jg as _s,jh as js,ji as bs,aY as ys,aX as vs,i6 as Ns,jj as Ss,jk as Es,jl as ks,jm as Cs,jn as Ts,aO as ws,jo as As,h9 as Ds,gB as Ls,jp as Ms,jq as Os,jr as Rs,js as Is,g_ as Ps,jt as Fs,ju as zs,aJ as Bs,jv as Us,jw as Vs,du as Hs,jx as Xs}from"./n4exq6o15ap1g74l.js";const K={div:s=>{const{node:n,children:t,...a}=s;return e.jsx("div",{...a,className:"text-red-500",children:t})},p:s=>{const{node:n,children:t,...a}=s;return e.jsx("p",{...a,className:"text-token-text-primary text-start leading-6",children:t})},a:s=>{const{node:n,children:t,...a}=s;return e.jsx("a",{...a,className:"font-sm text-token-text-primary! leading-6",children:t})}},Ws=1e3*60*2,Ks=30;function Ne({taskId:s,clientThreadId:n,onClick:t,statusMessage:a,showSources:i,includeMargin:c,sources:l,progressBar:d}){const r=B(),m=Le(),p=_e(),f=ns({taskId:s,intl:r,toaster:m}),g=f.isPending?Me:is,_=pe(),j=Oe(_,"2007855518"),v=x.useCallback(()=>{f.mutate(),fe(n,N=>{N.async_status=null}),Re.logEvent("Pause Completion",{threadId:Ie(n),currentLeafId:he.getCurrentNode(Pe(n)).message.id,eventSource:"mouse"})},[f,n]);return e.jsxs("div",{className:"relative flex w-4/5 max-w-[416px]",children:[s&&j&&e.jsx("button",{onClick:v,disabled:!s||f.isPending,className:"hover:bg-token-bg-elevated-secondary bg-token-bg-elevated-primary absolute end-4 top-14 flex items-center justify-center rounded-full border border-black/10 p-1 dark:border-white/10",children:e.jsx(g,{className:"icon-lg"})}),e.jsx("button",{onClick:()=>p&&t(),className:b("bg-token-main-surface-primary mt-4 flex w-full items-start justify-start gap-[18px] rounded-2xl border border-black/10 px-5 py-4 shadow-sm dark:border-white/10",p?"hover:bg-token-main-surface-secondary cursor-pointer":"cursor-auto"),children:e.jsxs("div",{className:"flex w-full flex-col gap-3",children:[e.jsxs("div",{className:b("flex flex-col items-start justify-start self-stretch md:h-7 md:flex-row md:items-center md:justify-between",i?"h-12":"h-6"),children:[e.jsx("div",{className:b("font-sm text-token-text-primary w-full flex-1 truncate text-start leading-7 md:w-0",c&&"me-[30px]"),children:a}),i&&l]}),e.jsx("div",{className:b("flex w-full items-center justify-start gap-4 self-stretch pb-2",s&&j&&"pe-10"),children:d})]})})]})}function Z({taskId:s,clientThreadId:n,toggleSidebar:t,openSidebar:a,startTime:i}){const c=B(),[l,d]=x.useState(!1),r=es();return x.useEffect(()=>{if(!i)return;const m=Date.now()-i,p=Ws-m;if(p>0){const f=setTimeout(()=>{d(!0),a()},p);return()=>clearTimeout(f)}else d(!0),a()},[i,a]),e.jsx(Ne,{taskId:s,clientThreadId:n,onClick:t,statusMessage:l?c.formatMessage({id:"T2SbxC",defaultMessage:"Waiting…"}):e.jsx("div",{className:"text-token-text-primary text-sm font-medium text-pretty",children:r.startingMessage}),progressBar:e.jsx(ss,{className:"h-2 w-full"}),showSources:!1})}function Js(s,n,t){const a=s.formatMessage({id:"Bs+OcV",defaultMessage:"Thinking…"});if(n.length<2)return t?.initial??a;const i=n[n.length-2];return i.type==="summary"?i.title:i.type==="search"?i.query:i?.type==="websiteOpen"?e.jsx(W,{componentOverrides:K,children:i.activeRowText}):i.type==="fileOpen"?e.jsx(W,{componentOverrides:K,children:i.activeRowText}):i.type==="pythonAnalysis"?e.jsx(W,{componentOverrides:K,children:i.analysisSummary}):a}function $s({task:s,clientThreadId:n,caterpillarRows:t,messageWithTaskMetadata:a,totalSources:i,handleToggleCaterpillarSidebar:c}){const l=B(),d=_e(),r=Js(l,t,a.metadata?.async_task_status_messages),m=(s?.expectedDurationMinutes??Ks)*60*1e3,p=ts(t[1]?.created_at?t[1].created_at*1e3:Date.now(),m),f=t[1]&&t[1].created_at?p:0;x.useEffect(()=>{fe(n,j=>{j.async_status=De.STREAMING})},[n]);const{openThreadSidebar:g}=z();x.useEffect(()=>{t.length===2&&d&&g({type:"caterpillar",caterpillarId:s.taskId,initialTab:"activity",clientThreadId:n})},[t.length,g,s.taskId,n,d]);const _=x.useCallback(()=>{g({type:"caterpillar",caterpillarId:s.taskId,initialTab:"activity",clientThreadId:n})},[g,s.taskId,n]);return t.length<=1?e.jsx(Z,{taskId:s.taskId,clientThreadId:n,toggleSidebar:()=>c("activity"),openSidebar:_,startTime:new Date(s.createdAt).getTime()}):e.jsx(Ne,{taskId:s.taskId,clientThreadId:n,onClick:()=>c("activity"),statusMessage:r,showSources:!0,includeMargin:i>0,sources:i===0?e.jsx("div",{className:"text-token-text-tertiary text-sm text-pretty",children:e.jsx(w,{id:"zfwUjs",defaultMessage:"Looking for sources…"})}):e.jsxs("button",{onClick:j=>{j.stopPropagation(),c("sources")},className:b("flex shrink-0 gap-1 text-[13px] leading-[18px] text-[#0285ff]",d?"cursor-pointer hover:text-[#0285ff]/80":"cursor-auto"),children:[e.jsx("div",{className:"relative",children:e.jsx(R,{initial:!1,children:e.jsx(A.span,{initial:{opacity:0,rotateX:-90,translateY:20},animate:{opacity:1,rotateX:0,translateY:0},exit:{opacity:0,rotateX:90,translateY:-20},transition:{duration:.35},className:"absolute start-0 md:end-0",children:i},i)})}),e.jsx("div",{className:b("md:pe-0",i>0&&"ps-2",i>9&&"ps-[14px]",i>99&&"ps-[22px]"),children:i>1?e.jsx(w,{id:"zN+MuO",defaultMessage:" sources"}):e.jsx(w,{id:"dMowmJ",defaultMessage:" source"})})]}),progressBar:e.jsx("div",{className:"bg-token-main-surface-tertiary flex h-2 shrink grow basis-0 items-start justify-start gap-2.5 overflow-hidden rounded-[10px]",children:e.jsx(as,{percentage:f,barClassName:"bg-token-text-primary",backgroundClassName:"bg-token-main-surface-tertiary"})})})}function Qs({messages:s,clientThreadId:n}){const t=s.find(m=>m.metadata?.b1de6e2_s&&m.metadata?.async_task_id),a=t?.metadata?.async_task_id,i=s.find(m=>m.recipient===Fe.START_RESEARCH_TASK),c=Q(n,m=>os(m,i?.id)),l=ze({clientThreadId:n}),[d,r]=x.useState(l);return x.useEffect(()=>{const m=setTimeout(()=>{r(c&&l)},3e3);return()=>clearTimeout(m)},[l,c]),!t||!a?d?e.jsx(Z,{taskId:a,clientThreadId:n,toggleSidebar:()=>{},openSidebar:()=>{},startTime:new Date().getTime()}):null:e.jsx(Ys,{clientThreadId:n,payloadTaskId:a,messageWithTaskMetadata:t})}function Ys({payloadTaskId:s,messageWithTaskMetadata:n,clientThreadId:t}){rs(s,n,t);const a=ls(g=>s?g.tasks[s]:null),i=B(),c=a?.status,l=x.useMemo(()=>a?.rows?a.rows:[],[a?.rows]),{toggleThreadSidebar:d}=z(),{totalSources:r,totalSearches:m}=x.useMemo(()=>{if(!l)return{uniqueSources:[],totalSources:0,totalSearches:0};const g=cs(l),_=g.reduce((v,N)=>v+N.count,0),j=ds(l);return{uniqueSources:g,totalSources:_,totalSearches:j}},[l]),p=ms("caterpillar"),f=x.useCallback(g=>{s&&d({type:"caterpillar",caterpillarId:s,initialTab:g,clientThreadId:t},p)},[d,s,p,t]);return us(s),n.metadata?.async_task_status_messages?.completed_with_time?e.jsx(ie,{task:a,clientThreadId:t,messageWithTaskMetadata:n,totalSources:r,totalSearches:m,handleToggleCaterpillarSidebar:f}):!a||!c||c===F.UNDETERMINED?e.jsx(Z,{taskId:s,clientThreadId:t,toggleSidebar:()=>{},openSidebar:()=>{},startTime:new Date().getTime()}):a.status===F.COMPLETED?e.jsx(ie,{task:a,clientThreadId:t,messageWithTaskMetadata:n,totalSources:r,totalSearches:m,handleToggleCaterpillarSidebar:f}):a.status===F.FAILED?e.jsx(oe,{message:n.metadata?.async_task_status_messages?.error??i.formatMessage({id:"at6zk8",defaultMessage:"Failed to think"}),handleToggleCaterpillarSidebar:()=>f("activity")}):a.status===F.CANCELLED?e.jsx(oe,{message:n.metadata?.async_task_status_messages?.cancelled??i.formatMessage({id:"u1rIr5",defaultMessage:"Task Cancelled"}),handleToggleCaterpillarSidebar:()=>f("activity")}):e.jsx($s,{task:a,clientThreadId:t,caterpillarRows:l,messageWithTaskMetadata:n,totalSources:r,handleToggleCaterpillarSidebar:f})}const le=4;function Zs({navigation:s,onShowSearchResults:n,trackContentReferenceEvent:t}){const{value:a}=O("3472722167"),i=s.domains.filter(r=>r.url);x.useEffect(()=>{t("Search Content Reference Shown","search_content_reference_shown",s.type,{urls:i.map(r=>r.url).join(",")})},[i]);let c=[],l=[],d=i[0].sub_domains.length>0&&a;return i.length>3||d?(c=[i[0]],l=i.slice(1,le)):c=i,e.jsxs("div",{className:b("not-prose mb-3 flex gap-2",l.length>0?"flex-col":"flex-row"),children:[c.map((r,m)=>e.jsx(ce,{isPrimaryDomain:m===0,isFistLineDomain:!0,navigationDomain:r,trackContentReferenceEvent:t,analyticsMetadata:{section_index:m}},r.url)),l.length>0&&e.jsxs("div",{className:"flex items-stretch gap-2",children:[l.map((r,m)=>e.jsx(ce,{navigationDomain:r,trackContentReferenceEvent:t,analyticsMetadata:{section_index:c.length+m}},r.url)),s.domains.length>le&&e.jsx(qs,{onShowSearchResults:n,trackContentReferenceEvent:t})]})]})}const Se=Y.div`border border-token-border-default shadow-xxs hover:bg-token-main-surface-secondary dark:border-token-border-xlight dark:bg-token-main-surface-secondary dark:hover:bg-token-main-surface-tertiary`,qs=({onShowSearchResults:s,trackContentReferenceEvent:n})=>e.jsx(Se,{className:"flex w-8 cursor-pointer items-center justify-center rounded-xl",onClick:()=>{n("Search Content Reference Clicked","search_content_reference_clicked","navigation",{sidebar:"sidebar"}),s(je.Sources,be.Links)},children:e.jsx(Be,{className:"opacity-50"})}),ce=({isPrimaryDomain:s,isFistLineDomain:n,navigationDomain:t,trackContentReferenceEvent:a,analyticsMetadata:i})=>(x.useEffect(()=>{a("link_action","link_action","navigation",{url:t.url,title:t.title,link_type:"card",action:"show",section:"fast_nav",section_location:"response",section_index:i.section_index})},[]),e.jsx("div",{className:b("flex-1",s?"min-w-[40%]":"min-w-0"),children:e.jsx(Gs,{isFistLineDomain:n,isPrimaryDomain:s,title:t.title,subtitle:t.subtitle??void 0,url:t.url,domain:t.domain,subDomains:t.sub_domains,trackContentReferenceEvent:a,analyticsMetadata:i})})),Gs=({isFistLineDomain:s,isPrimaryDomain:n,title:t,subtitle:a,url:i,subDomains:c,trackContentReferenceEvent:l,analyticsMetadata:d})=>{const{value:r}=O("3472722167");x.useState(!1);const m={url:i,title:t,link_type:"card",section:"fast_nav",section_location:"response",section_index:d.section_index};return c.length>0,e.jsxs(Se,{className:"group/navigation text-token-link flex flex-col rounded-2xl",children:[e.jsxs(ye,{href:i,target:"_blank",onClick:()=>l("link_action","link_action","navigation",{...m,action:"click"}),onMouseEnter:()=>{l("link_action","link_action","navigation",{...m,action:"hover"})},className:b("flex flex-row items-center gap-2",s?"px-4 py-3":"px-4 py-2.5"),children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-[#1D53BF0D] group-hover/navigation:bg-[#1D53BF1A] dark:bg-[#7CA8FF33] dark:group-hover/navigation:bg-[#7CA8FF33]",children:e.jsx(U,{url:i,size:32,minSize:20,className:"icon-sm rounded-full"})}),e.jsxs("div",{className:"flex min-w-0 flex-col gap-0.5",children:[e.jsxs("div",{className:b("flex items-center gap-1 font-semibold",s?"text-sm":"text-xs"),children:[e.jsx("span",{className:"flex-1 truncate",children:t}),!1]}),e.jsx("div",{className:"truncate text-xs",children:a})]})]}),!1]})},J=3,et=3;function st({navigation:s,onShowSearchResults:n,trackContentReferenceEvent:t}){const{value:a}=O("756982149"),i=x.useContext(gs)!=null,c=x.useContext(xs);return e.jsx("div",{className:b({hidden:c&&i}),children:a?e.jsx(tt,{navigation:s,onShowSearchResults:n,trackContentReferenceEvent:t}):e.jsx(Zs,{navigation:s,onShowSearchResults:n,trackContentReferenceEvent:t})})}function tt({navigation:s,onShowSearchResults:n,trackContentReferenceEvent:t}){const a=s.domains.filter(l=>l.url);x.useEffect(()=>{t("Search Content Reference Shown","search_content_reference_shown",s.type,{urls:a.map(l=>l.url).join(",")})},[a]);let i=a.slice(0,J),c=a.slice(J,J+et);return e.jsxs("div",{className:"not-prose mb-3 flex gap-4",children:[i.map((l,d)=>e.jsx(nt,{isPrimaryDomain:d===0,isFistLineDomain:!0,navigationDomain:l,trackContentReferenceEvent:t,analyticsMetadata:{section_index:d}},l.url)),c.length>0&&e.jsx(at,{onShowSearchResults:n,trackContentReferenceEvent:t,moreDomains:c})]})}const at=({onShowSearchResults:s,trackContentReferenceEvent:n,moreDomains:t})=>e.jsx("div",{className:"group hover:bg-token-main-surface-secondary flex w-20 cursor-pointer rounded-xl p-2",onClick:()=>{n("Search Content Reference Clicked","search_content_reference_clicked","navigation",{sidebar:"sidebar"}),s(je.Sources,be.Links)},children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"text-token-text-primary flex items-center truncate text-sm font-semibold",children:e.jsx(w,{id:"gJPygN",defaultMessage:"More"})}),e.jsx("div",{className:"flex items-center",children:t.map((a,i)=>e.jsx("div",{style:{zIndex:t.length-i},className:"ms-[-6px] first:ms-0",children:e.jsx("div",{className:b("flex h-5 w-5 items-center overflow-hidden rounded-full","border-token-main-surface-primary bg-token-main-surface-primary border-2"),children:e.jsx(U,{url:a.url,size:32,minSize:20,className:"icon-sm rounded-full"})},a.url)},a.url))})]})}),nt=({isPrimaryDomain:s,isFistLineDomain:n,navigationDomain:t,trackContentReferenceEvent:a,analyticsMetadata:i})=>(x.useEffect(()=>{a("link_action","link_action","navigation",{url:t.url,title:t.title,link_type:"card",action:"show",section:"fast_nav",section_location:"response",section_index:i.section_index})},[]),e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx(it,{isFistLineDomain:n,isPrimaryDomain:s,title:t.title,subtitle:t.subtitle??void 0,url:t.url,domain:t.domain,subDomains:t.sub_domains,trackContentReferenceEvent:a,analyticsMetadata:i})})),it=({isFistLineDomain:s,isPrimaryDomain:n,title:t,subtitle:a,url:i,subDomains:c,trackContentReferenceEvent:l,analyticsMetadata:d})=>{const{value:r}=O("3472722167");x.useState(!1);const m={url:i,title:t,link_type:"card",section:"fast_nav",section_location:"response",section_index:d.section_index};return c.length>0,e.jsxs("div",{className:"group/navigation text-token-link hover:bg-token-main-surface-secondary -ms-2 flex flex-col rounded-xl p-2",children:[e.jsxs(ye,{href:i,target:"_blank",onClick:()=>l("link_action","link_action","navigation",{...m,action:"click"}),onMouseEnter:()=>{l("link_action","link_action","navigation",{...m,action:"hover"})},className:"flex flex-row items-center gap-2",children:[e.jsx(ot,{url:i}),e.jsxs("div",{className:"flex min-w-0 flex-col",children:[e.jsxs("div",{className:b("flex items-center gap-1 font-semibold",s?"text-sm":"text-xs"),children:[e.jsx("span",{className:"text-token-text-primary flex-1 truncate",children:t}),!1]}),e.jsx("div",{className:"text-token-text-secondary truncate text-sm",children:a})]})]}),!1]})},ot=({url:s})=>{const n=fs(s,32);return e.jsxs("div",{className:"icon-bg relative flex h-10 w-10 shrink-0 items-center justify-center overflow-hidden rounded-[10px]",children:[e.jsx("div",{className:"h-10 w-10 bg-cover bg-center bg-no-repeat opacity-35 blur-xl",style:{backgroundImage:`url(${n})`,backgroundSize:"5rem 5rem"}}),e.jsx("div",{className:"absolute flex h-10 w-10 items-center justify-center",children:e.jsx(U,{url:s,size:32,minSize:20,className:"icon-sm rounded-full"})})]})},rt=2e3,Ee=.4,lt=.45,ct=.2,dt=.1,mt=.25;var L=(s=>(s[s.Running=0]="Running",s[s.Finished=1]="Finished",s[s.Error=2]="Error",s[s.Stopped=3]="Stopped",s[s.Paused=4]="Paused",s))(L||{});function Ut({conversationMessages:s,icon:n,status:t,text:a,estimatedToolDurationMs:i,animationLoopDurationMs:c=rt,shouldPersistAfterFinished:l=!1}){const[d,r]=x.useState(t===0?0:t===1&&!l?7:1),[m,p]=x.useState(0);x.useEffect(()=>{t===2?r(8):t===3?r(9):t===4?r(10):t===1?r(d===2?3:7):t===0&&d===10&&(r(2),p(g=>g+1))},[t]);const f=xt(d);return x.useEffect(()=>{const g=s[0].id;if(f)return re.addDelayedRenderingMessage(g),()=>{re.removeDelayedRenderingMessage(g)}},[f]),ve(()=>{M(d)&&p(g=>g+1)},c),d===7&&!l?null:e.jsxs("div",{className:"my-2.5 flex items-center gap-2.5",children:[e.jsx(ut,{icon:n,status:t,uiState:d,estimatedToolDurationMs:i,animationLoopCounter:m,shouldPersistAfterFinished:l,onFillProgressBarAnimationComplete:()=>r(4),onFinishAnimationComplete:()=>{r(5),setTimeout(()=>{r(l?7:6)},dt*1e3)},onHideAnimationComplete:()=>r(7)}),e.jsx(gt,{text:a,uiState:d,animationLoopCounter:m,onEnterAnimationComplete:()=>r(2)})]})}const de=50;function ut({icon:s,status:n,uiState:t,estimatedToolDurationMs:a,animationLoopCounter:i,shouldPersistAfterFinished:c,onFillProgressBarAnimationComplete:l,onFinishAnimationComplete:d,onHideAnimationComplete:r}){const[m,p]=x.useState(0);ve(()=>{M(t)?p(D=>D+de):t===10&&p(0)},de);let f,g,_;M(t)||t===10?(f="running",g=e.jsx(s,{animationLoopCounter:i}),_="bg-transparent"):t===4||t===5||t===7&&c?(f="finished",g=e.jsx(hs,{}),_="bg-brand-purple"):n===2?(f="error",g=e.jsx(_s,{}),_="bg-orange-500"):n===3&&(f="stopped",g=e.jsx(js,{}),_="bg-gray-300");let j={opacity:0,scale:0,rotate:-180,x:0},v={type:"spring",bounce:.3,duration:lt},N={opacity:0,scale:.6,rotate:0,x:0};t===0?(j={opacity:0,scale:.5,rotate:-180,x:-8},v={type:"spring",bounce:.3,duration:Ee}):t===1?j=!1:t===5&&(N={opacity:0,scale:0,rotate:0,x:0},v={type:"spring",bounce:.3,duration:mt});const C=bs(m,a);return e.jsx("div",{className:"relative h-5 w-5 shrink-0",children:e.jsx(R,{onExitComplete:()=>{t===6&&r()},children:f!=null&&e.jsxs(A.div,{className:b("absolute start-0 top-0 flex h-full w-full items-center justify-center rounded-full text-white",_),initial:j,animate:{opacity:1,scale:1,rotate:0,x:0},exit:N,transition:v,onAnimationComplete:()=>{t===4&&d()},children:[g,(M(t)||t===10)&&e.jsx(ps,{percentage:t===3?100:C,thickness:1.5/23,className:"text-brand-purple absolute start-1/2 top-1/2 h-[23px] w-[23px] -translate-x-1/2 -translate-y-1/2",backgroundStrokeClassName:"stroke-brand-purple/25 dark:stroke-brand-purple/50",transitionDuration:t===3?`${(100-C)/100*ct}s`:void 0,transitionTimingFunction:t===3?"cubic-bezier(0.55, 0, 1, 1)":void 0,onTransitionEnd:()=>{t===3&&l()}})]},f)})})}function gt({text:s,uiState:n,animationLoopCounter:t,onEnterAnimationComplete:a}){const[i,c]=x.useState(s);x.useEffect(()=>{n===2&&c(s)},[t]),x.useEffect(()=>{M(n)||c(s)},[n,s]);let l={opacity:0,x:0,y:15},d={type:"spring",bounce:.3,opacity:{duration:.15},y:{duration:.3}};n===0?(l={opacity:0,x:-8,y:0},d={type:"spring",bounce:.3,duration:Ee,delay:.15}):n===1&&(l=!1);const r=i??void 0;return e.jsx("div",{className:b("relative h-5 w-full leading-5",n===8||n===9?"text-token-text-tertiary":"text-token-text-secondary"),children:e.jsx(R,{children:r!=null&&e.jsx(A.div,{className:"absolute start-0 top-0 line-clamp-1 overflow-visible",initial:l,animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:0,y:-15},transition:d,onAnimationComplete:()=>{n===0&&a()},children:r},r.toString())})})}function M(s){return s===0||s===2||s===3}function xt(s){return M(s)||s===4||s===5||s===6||s===10}const me=Y.div`group start-0 top-0 me-1.5 overflow-hidden mt-1 text-start`,ft=({highlightedCommand:s,status:n,children:t,showWorkUserSetting:a=!1,hideOnlyIfNotInteractedWith:i=!1,defaultExpanded:c=!1,onOpenAnalytics:l,onClick:d,...r},m)=>{const p=t!=null||d!=null,[f]=x.useState(a),[g,_]=x.useState(a||c),[j,v]=x.useState(!1),N=n===L.Finished||n===L.Error,C=i?f?!1:!j:!1,D=n===L.Running&&"loading-shimmer";return N&&C?null:p?e.jsxs(e.Fragment,{children:[e.jsx(ue,{ref:m,$canShowWork:!0,...r,children:e.jsx(R,{children:e.jsx(me,{children:e.jsx(A.button,{onClick:V=>{g||l?.(),_(H=>!H),v(!0),d?.(V)},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:b(D),children:e.jsxs("div",{className:"flex items-center justify-start gap-1",children:[e.jsx("span",{className:"text-start",children:s}),!d&&(g?e.jsx(ys,{className:"icon-md"}):e.jsx(vs,{className:"icon-md"}))]})},s?.toString())})})}),e.jsx(R,{children:g&&t&&e.jsx(A.div,{initial:"collapsed",animate:"reveal",exit:"collapsed",variants:{collapsed:{translateY:-20,opacity:0,height:0},reveal:{translateY:0,opacity:1,height:"auto"}},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:t})})]}):e.jsx(ue,{ref:m,$canShowWork:!1,...r,children:e.jsx(me,{className:b(D),children:s})})},ue=Y.span`block first:mt-0 relative
${({$canShowWork:s})=>s?"text-token-text-secondary hover:text-token-text-primary my-1.5":"text-token-text-secondary"}`,pt=x.forwardRef(ft),ht=3,_t=.1,ge=[0,.26,.4];function jt({nextMessage:s,isLastMessage:n,isRequestActive:t,isLastTurnInConversation:a,clientThreadId:i,turnIndex:c}){let l=n||!s||s&&!$(s);const d=x.useRef(!1),r=Ge(),m=Q(i,he.getGizmoId);x.useEffect(()=>{s&&$(s)&&!d.current&&(d.current=!0,Ns(r,m))},[s,r,m]);const p=Ue(s),f=Ve(s);s?.id&&Ss(s?.id);const g=[];if(f?.[0]?.type==="navigation"&&s&&g.push(e.jsx(bt,{clientThreadId:i,turnIndex:c,nextMessage:s,isRequestActive:t,isLastTurnInConversation:a,navigationCitation:f[0]},"fast-nav")),l){const _=He(p.slice(0,ht).map(v=>v.entries[0].url)),j=t?e.jsxs("div",{className:"flex items-center gap-1",children:[_.map((v,N)=>e.jsx(A.div,{className:b("-ms-1.5 first:ms-0 last:me-1.5","relative"),initial:{width:N===0?0:6,opacity:0},animate:{width:20,opacity:1},transition:{duration:_t,delay:ge[Math.min(N,ge.length-1)]},children:e.jsx("div",{className:b("flex h-[22px] w-[22px] items-center overflow-hidden rounded-full","border-token-main-surface-primary bg-token-main-surface-primary border-2"),children:e.jsx(U,{url:v,size:32,minSize:16,className:"icon-md rounded-full"})})},v)),e.jsx(w,{id:"jjx8Qg",defaultMessage:"Searching the web"})]}):e.jsx(w,{id:"fssXGM",defaultMessage:"Error while searching"});g.push(e.jsx(pt,{highlightedCommand:j,status:t?L.Running:L.Error},"search-gpt-query"))}return g.length?e.jsx(e.Fragment,{children:g}):null}const bt=({clientThreadId:s,turnIndex:n,nextMessage:t,isRequestActive:a,isLastTurnInConversation:i,navigationCitation:c})=>{const{scrollToHeader:l}=ae("searchSources")??{},d=Xe(),r=ae("searchSources"),{openThreadSidebar:m}=z(),{value:p}=O("756982148");return x.useEffect(()=>{We.addFirstTiming("render.fastNavigation")},[]),x.useEffect(()=>{d&&r&&m({type:"searchSources",scrollToHeader:l,clientThreadId:s,turnIndex:n,messageId:t?.id??""})},[]),x.useEffect(()=>{const f=t,g=f.metadata?.search_source,_=c.domains.map(j=>j.url);Es.logEvent("Search Tool Request Time To Fast Nav",s,f.id,{search_source:g,urls:_},()=>{g===Ke.InstantQuery&&ks.logEvent("Search Tool Page Load Time To Fast Nav",{message_id:f.id,urls:_,search_source:g})})},[s,t,c]),a&&i&&p?e.jsx(A.div,{initial:{opacity:a?0:1,height:a?0:"auto"},animate:{opacity:1,height:"auto"},children:e.jsx(xe,{clientThreadId:s,turnIndex:n,nextMessage:t,navigationCitation:c})}):e.jsx(xe,{clientThreadId:s,turnIndex:n,nextMessage:t,navigationCitation:c})},xe=({clientThreadId:s,turnIndex:n,nextMessage:t,navigationCitation:a})=>{const{toggleThreadSidebar:i}=z(),{value:c}=O("756982148"),l=x.useMemo(()=>({clientThreadId:s,turnIndex:n,messageId:t?.id}),[s,n,t?.id]),d=x.useCallback((m,p)=>{i({type:"searchSources",scrollToHeader:p,clientThreadId:s,turnIndex:n,messageId:t?.id??""})},[i,s,n,t?.id]),r=Cs(l);return c?e.jsx(st,{navigation:a,onShowSearchResults:d,trackContentReferenceEvent:r}):e.jsx(Ts,{tldr:{type:"tldr",status:"done",display_title:a.domains[0].title,url:a.domains[0].url,matched_text:"",start_idx:0,end_idx:0,page_title:"",breadcrumbs:[a.domains[0].domain],refs:[]},trackContentReferenceEvent:r})},yt=y(()=>S(()=>import("./o7zkmpa3qy4py88d.js"),__vite__mapDeps([0,1,2,3,4,5]))),vt=y(()=>S(()=>import("./i9hz850fstkvaggv.js"),__vite__mapDeps([6,1,3,4,7]))),Nt=y(()=>S(()=>import("./bylwo0urduht67h8.js"),__vite__mapDeps([8,1,3,4,2,5]))),St=y(()=>S(()=>import("./mrplmdgld1e6xzde.js"),__vite__mapDeps([9,1,3,4,2,5,10]))),Et=y(async()=>()=>null),kt=y(async()=>(await S(()=>import("./lipljdtfaomxepb8.js"),__vite__mapDeps([11,3,1,4,10,2,5,12,13,14,15]))).ImageGenMessage),Ct=y(()=>S(()=>import("./4ckzxvix48gclldi.js"),__vite__mapDeps([16,1,3,4,2,5]))),Tt=y(()=>S(()=>import("./gz7bga55ows7jmp7.js"),__vite__mapDeps([17,1,3,4,2,5])).then(s=>s.BrowsingMessage)),wt=y(()=>S(()=>import("./hd4fy7o51pss65he.js"),__vite__mapDeps([18,1,3,4,2,5])).then(s=>s.SearchResultMessage)),At=y(()=>S(()=>import("./lw7iuxfcvakfk3jy.js"),__vite__mapDeps([19,1,3,4,2,5,20])).then(s=>s.JITPluginMessage)),Dt=y(()=>S(()=>import("./iqvx7rzarjxgbosl.js"),__vite__mapDeps([21,3,1,4,22,2,5,23,24])).then(s=>s.DataAnalysisMessage)),Lt=y(()=>S(()=>import("./njzb2k6yfzjolpk6.js"),__vite__mapDeps([25,1,3,4,2,5,26]))),Mt=y(()=>S(()=>import("./pb40qsj3szdq5sx1.js"),__vite__mapDeps([27,1,12,3,4,13,2,5,28,29,30,31,32,33,34,23,24,35,36,37,38,39,40,41,42,43,44,45,46])).then(s=>s.CoTMessage)),Ot=y(()=>S(()=>import("./c0o2d6hkugb6w3of.js"),__vite__mapDeps([47,1,3,4,13,2,5,23,24,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46])).then(s=>s.CoT)),Rt=y(()=>S(()=>import("./im6ysdo3xspl1742.js"),__vite__mapDeps([48,1,2,3,4,5,49,50,51,52])).then(s=>s.JawboneMessage));y(async()=>()=>null);y(async()=>()=>null);const It=y(async()=>()=>null);function Vt({groupedMessagesToRender:s,allMessages:n,allGroupedMessages:t,clientThreadId:a,isUserTurn:i,isCompletionRequestInProgress:c,isFeedbackEnabled:l,isFinalTurn:d,isFinalUserTurn:r,turnIndex:m,hasActiveRequest:p,onRequestCompletion:f,shouldGrowContainer:g=!0,isParagen:_=!1,renderingView:j="chat"}){const{showDebugConversationTurns:v}=ws(),[N]=Q(a,o=>[o?.mode]),C=Je(a),D=As(),V=t.some(o=>o.type===u.Browsing||o.type===u.RetrievalBrowsing||o.type===u.SearchGPTQuery),H=Ds(()=>$e.count(Qe.DEFAULT,"conversation_turn_grouped_messages.attempted_render_missing_type_f959b8c")),q=s.map((o,h)=>{const E=h===t.length-1;if(o.type===ne)return e.jsx(Ot,{isStreaming:E&&c,messageGroups:o.groups},"cot-v2-"+o.groups[0].messages[0].id);const G=h===0?void 0:s[h-1],ee=G?.type!==ne?G:void 0,se=ee?.type,te=ee?.messages,we=o&&!$(o.messages[0]),Ae=V&&we,I=[];switch(Ae||I.push(e.jsx(Ls,{className:"min-h-8",message:o.messages[0],isFeedbackEnabled:l,isFinalUserTurn:r,isCompletionInProgress:E&&c,hasActiveRequest:p,turnIndex:m,clientThreadId:a,isUserTurn:i,prevGroupedMessageType:se,prevGroupedMessages:te},"text-message-"+o.messages[0].id)),v&&I.push(e.jsx(It,{clientThreadId:a,message:o.messages[0]},"message-debug-"+o.messages[0].id)),o.type){case u.Text:case u.MultiText:return o.type===u.Text?e.jsxs(x.Fragment,{children:[I,e.jsx(Fs,{isUserTurn:i,message:o.messages[0]})]},"group-"+o.messages[0].id):o.type===u.MultiText?e.jsx(Nt,{clientThreadId:a,messages:o.messages,isCompletionInProgress:E&&c,isFeedbackEnabled:l,hasActiveRequest:p,prevGroupedMessageType:se,prevGroupedMessages:te},"multitext-"+(o.messages[0]?.id??h)):o.type;case u.Browsing:case u.RetrievalBrowsing:{const k=N!=null&&[X.GizmoInteraction,X.GizmoMagicCreate,X.GizmoTest].includes(N.kind),T=C?Ps(C):!1;return e.jsx(Tt,{messages:o.messages,isRequestActive:p,isLastMessageInTurn:E,isUsingGizmo:k,isUsingSnorlax:T,isRetrieval:o.type===u.RetrievalBrowsing},"browsing-"+(o.messages[0]?.id??h))}case u.SearchGPTQuery:{const k=t.slice(h+1).find(({type:P})=>P===u.Text),T=k?.type===u.Text?k:void 0;return e.jsx(jt,{clientThreadId:a,turnIndex:m,isRequestActive:p,isLastMessage:E,isLastTurnInConversation:d,nextMessage:T?.messages[0]},"searchquery-"+(o.messages[0]?.id??h))}case u.StructuredThoughts:return null;case u.ReasoningRecap:return null;case u.CoTSearchTool:return null;case u.n7jupd_c:return null;case u.n7jupd_s:return null;case u.a8km123:{if(!o.messages.some(T=>T.metadata?.model_slug==="o1-pro")){const T=Ye(n,P=>P.author.role===Ze.Assistant&&P.recipient==="all");return e.jsx(Mt,{clientThreadId:a,turnIndex:m,isStreaming:(E||T<h)&&c,messages:o.messages},"sum-"+(o.messages[0]?.id??h))}return e.jsx(Lt,{messages:o.messages,isStreaming:E&&c,isLastMessage:E,clientThreadId:a,currentGroupedMessageIndex:h,turnIndex:m},"sum-"+(o.messages[0]?.id??h))}case u.f959b8c:return H(),null;case u.is_loading_message:return E&&c?e.jsx(Is,{},"loading-message-"+h):null;case u.c12k321:return null;case u.l1p9k3u:return null;case u.l1239dk1:return null;case u.l1239dk2:return null;case u.b1de6e2_c:return e.jsx(Rs,{messages:o.messages,clientThreadId:a,isLastMessage:E},"b1de6e2-"+(o.messages[0]?.id??h));case u.b1de6e2_s:return e.jsx(Qs,{messages:o.messages,clientThreadId:a},"b1de6e2_s-"+(o.messages[0]?.id??h));case u.b1de6e2_d:return null;case u.b1de6e2_rm:return e.jsx(Os,{messages:o.messages,clientThreadId:a,renderingView:j,children:I},"b1de6e2_rm-"+(o.messages[0]?.id??h));case u.de1d73e:if(D){const k=h+1<t.length?t[h+1]:void 0;return e.jsx(Rt,{clientThreadId:a,currentGroupedMessage:o,nextMessage:k&&k.type===u.Text?k.messages[0]:void 0,isLastMessage:E,isRequestActive:p},"jawbone-"+(o.messages[0]?.id??h))}else return null;case u.ParallelBrowsing:return e.jsx(Ct,{messages:o.messages},"parallel-"+(o.messages[0]?.id??h));case u.CodeInterpreter:return e.jsx(Dt,{messages:o.messages,isRequestActive:p,clientThreadId:a},"ada-"+(o.messages[0]?.id??h));case u.JITPlugin:return e.jsx(At,{messages:o.messages,clientThreadId:a,isLastTurnInConversation:d,onRequestCompletion:f},"jit-"+(o.messages[0]?.id??h));case u.t2uay3k:return e.jsx(kt,{messages:o.messages,clientThreadId:a,disableClickThru:_,isLastTurnInConversation:d},"t2uay3k-"+(o.messages[0]?.id??h));case u.Dalle:return e.jsx(St,{messages:o.messages,clientThreadId:a,disableClickThru:_},"dalle-"+(o.messages[0]?.id??h));case u.GizmoEditor:return e.jsx(yt,{messages:o.messages},"gizmo-editor-"+(o.messages[0]?.id??h));case u.oiw209h:return e.jsx(Et,{messages:o.messages,clientThreadId:a},"oiw209h-"+(o.messages[0]?.id??h));case u.Canmore:return e.jsx(Ms,{messages:o.messages,allTurnMessages:n,isFinalTurn:d,isRequestActive:p,clientThreadId:a,isUserTurn:i},"canmore-"+(o.messages[0]?.id??h));case u.Oboe:return null;case u.Debug:return v?e.jsx(vt,{message:o.messages[0]},"debug-"+o.messages[0].id):null;case u.SearchResult:return e.jsx(wt,{messages:o.messages},"search-result-"+(o.messages[0]?.id??h))}}),ke=Xs(),Ce=pe(),{isWordFadeDisabled:Te}=zs();return e.jsx("div",{className:b({"flex max-w-full flex-col":!0,grow:g}),children:e.jsx(qe,{name:"GroupedMessages",fallback:Pt,children:i?q:e.jsxs(Bs,{isDisabled:i||!d||!c||Te,children:[Us(Ce)&&d&&e.jsx(Vs,{isStreaming:c,debug:ke}),q]},n[0]?.id)})})}function Pt(){return e.jsx(Hs,{type:"danger",children:e.jsx(w,{id:"5eGo3w",defaultMessage:"Unable to display this message due to an error."})})}export{Vt as C,xe as F,st as N,L as T,pt as a,Ut as b};
//# sourceMappingURL=iuzjvviw85b4ghdw.js.map
