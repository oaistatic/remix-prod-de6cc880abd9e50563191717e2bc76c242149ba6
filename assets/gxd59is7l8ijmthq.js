import{r as z,e as B,j as n,d as G}from"./khl8ktun31iepecq.js";import{m as _,d8 as H,l as P,d9 as q,a as h,cX as $,gu as k,bB as D}from"./haannt40upmuwmtk.js";import{dg as V,eB as N,eC as W,d9 as X,eD as J,eE as K,eF as O,ey as Q,eG as Y,eH as Z}from"./n4exq6o15ap1g74l.js";function ee({asset:s,contextConnectorSourceUrl:u,isSingle:t,isUserTurn:m,className:l}){const i=_(),o=H(i).flags,[r,f]=z.useState(!1),{isUnauthenticated:e}=P(),a=o?.includes(q.NoAuthEnableFileUploads),I=V(s.asset_pointer),d=N.useState(b=>N.selectFile(b,I)),p=W(d?.file??null,d?.file.name,d?.fileId??void 0,d?.gizmoId,d?.contextConnectorInfo,!0),C=e&&d&&a,{gizmoEditorData:F}=X(),w=J(),M=K(m),j=B(),{data:U,isLoading:E,error:R}=O({asset:s,gizmoId:F?.id,getServerUrl:!C}),{url:v,width:g,height:x}=p&&a?{width:s.width,height:s.height,url:p}:U??{},y=E||!r,A=g&&x?{Landscape:g>x,Portrait:g<x,Square:g===x}:void 0,c=["overflow-hidden rounded-lg"];if(t&&(c.push("w-full h-full"),A?.Landscape?c.push("max-w-96 max-h-64"):A?.Portrait?c.push("max-h-96 max-w-64"):c.push("max-w-64 max-h-64")),l&&c.unshift(l),M)return null;let S;return v!=null&&(S=n.jsx(Q,{alt:j.formatMessage(L.imageAltText),className:h("max-w-full",!t&&"aspect-square","object-cover object-center",c),src:v,width:g,height:x,onLoad:()=>f(!0)}),w||(S=n.jsx(Y,{src:v,alt:j.formatMessage(L.imageAltText),contextConnectorSourceUrl:u,className:h(c),children:S}))),n.jsx("div",{className:h(c),children:n.jsx("div",{className:h("bg-token-main-surface-secondary text-token-text-tertiary relative flex h-auto w-full max-w-lg items-center justify-center overflow-hidden",!t&&"aspect-square"),children:v!=null?S:n.jsx("div",{className:"flex items-center justify-center",style:{aspectRatio:`${g} / ${x}`,width:g},title:y?j.formatMessage(L.loadingImage):j.formatMessage(L.errorLoadingImage),children:y?n.jsx($,{}):R?n.jsx(k,{className:"icon-sm"}):null})})})}const L=G({loadingImage:{id:"textMessage.loadingImage",defaultMessage:"Loading..."},errorLoadingImage:{id:"textMessage.errorLoadingImage",defaultMessage:"Could not load image"},imageAltText:{id:"textMessage.imageAltText",defaultMessage:"Uploaded image"},targetedReply:{id:"textMessage.targetedReply",defaultMessage:"Replying to:"}});function T({assets:s,attachments:u,isUserTurn:t=!0,clientThreadId:m}){const l=s.length===1,{containerClassname:i,imageClassnames:o}=T.computeClassnames(s.length);return n.jsxs("div",{className:"flex w-[var(--user-chat-width,70%)] flex-col items-end",children:[n.jsx("div",{className:h("flex flex-row items-center justify-end gap-1",i),children:s.map((r,f)=>{const e=u?.find(a=>a.id&&r.asset_pointer.includes(a.id));return n.jsx(ee,{asset:r,isSingle:l,isUserTurn:t,contextConnectorSourceUrl:e?.context_connector_info?.source_url,className:o[f]},f)})}),n.jsx(Z,{featureType:D.ATTACHMENT,isUserTurn:t,clientThreadId:m})]})}T.computeClassnames=s=>{if(s<2)return{containerClassname:null,imageClassnames:[]};let u=s>=4?"flex-wrap":"";const t=Array(s),m=e=>{t.fill(e)},l=e=>{u+=` ${e}`},i=(e,a)=>{t[e]=h(t[e],a)},o=s<=4&&s%2===0?2:3,r=Math.ceil(s/o),f=s%o!==0;o===2?(m("h-32 w-32"),l("max-w-72")):r<=2?(m("h-24 w-24 sm:h-32 sm:w-32"),l("max-w-80 sm:max-w-100")):(m("h-16 w-16"),l("max-w-52"));for(let e=0;e<s;e++){const a=Math.floor(e/o),I=e%o,d=Math.min(s-a*o,o),p=a===0,C=a===r-1,F=a===r-2,w=I===0,M=I===d-1;p&&w&&i(e,"rounded-ss-2xl"),p&&M&&i(e,"rounded-se-2xl"),C&&w&&i(e,"rounded-es-2xl"),C&&M&&i(e,"rounded-ee-sm"),f&&w&&F&&i(e,"rounded-es-2xl")}return{containerClassname:u,imageClassnames:t}};export{T as TextMessageImageGroup};
//# sourceMappingURL=gxd59is7l8ijmthq.js.map
