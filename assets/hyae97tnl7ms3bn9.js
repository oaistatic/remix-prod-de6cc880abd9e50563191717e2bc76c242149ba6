const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/j1oo0eciwoztqgjs.js","assets/khl8ktun31iepecq.js","assets/haannt40upmuwmtk.js","assets/root-eulobrch.css","assets/j5kjflan8nbqjm6e.js","assets/g0kxck7ediewm05i.js","assets/n4exq6o15ap1g74l.js","assets/conversation-small-bh1estgu.css","assets/nybw3qoqoq0g4w1d.js","assets/d3y72ugnrmac5z1v.js","assets/fzrn137102spawew.js","assets/e9lafxuzyeh4418f.js","assets/n4mh0ete7jlifz2u.js"])))=>i.map(i=>d[i]);
import{j as e,M as h,h as us,r as m,a8 as T,R as Y,d as J,f as xe,e as L,a9 as ee,u as ms}from"./khl8ktun31iepecq.js";import{iL as Pe,iB as Le,iD as xs,o as fe,cY as Fe,iM as Ee,a5 as I,e_ as se,af as fs,db as S,iz as he,o_ as hs,oY as me,o$ as ps,jm as gs,ct as js,cu as bs,p0 as vs,bk as Oe,aI as Ss,f1 as ys,f2 as ws,R as Ns,aM as Cs,cC as ks,p1 as Ae,p2 as Ms,p3 as Is,p4 as Ts,p5 as ne,p6 as Be,p7 as Re,or as ze,i0 as _s,p8 as ce,I as Ps,kh as Ls,h_ as Fs,ko as Es,G as Os,ke as As,cZ as Bs,e5 as Rs,z as zs,p9 as Q,dU as Us,pa as Ds,pb as Gs,iI as Hs,gd as Ws,pc as Vs,bH as re,pd as $s,e7 as Ue,aY as qs,aX as Xs,pe as Ks,iq as Qs,pf as ae,n as De,es as Ys,pg as Zs,ph as Js,pi as oe,i1 as et,hZ as st,pj as de,pk as tt,pl as at,pm as nt,pn as it,be as rt,ip as ye,po as ot,pp as lt,pq as ct,a$ as dt,b0 as ut,iJ as mt,iK as xt,pr as ie,ps as ft,pt as ht,pu as we,pv as Ge,aG as pt,id as gt,iy as jt,b9 as bt,iv as vt,pw as St,px as yt,py as q,pz as wt,gy as Nt,bK as Ct,n1 as kt,pA as Mt,pB as pe,pC as It,pD as Tt,pE as _t,pF as Pt,pG as Lt,pH as Ft,pI as Ne,pJ as Et,pK as Ot,pL as He,B as We,aH as At,j3 as Bt,pM as Rt,iZ as zt,j4 as Ut,pN as Dt,pO as Gt,pP as Ve,pQ as Ht,pR as Wt,pS as Vt,fQ as $t,pT as qt,pU as Xt,ee as Kt,pV as Qt}from"./n4exq6o15ap1g74l.js";import{l as D,P as _,fb as $e,aj as ge,F as qe,u as Yt,cH as U,dS as Zt,a as y,cQ as Jt,cS as ea,cT as sa,cV as ta,ds as aa,dZ as na,d_ as ia,aG as Xe,cr as B,bF as ra,cq as Ke,fL as oa,cW as la,di as ca,m as da,aL as je,J as ua,b9 as ma,co as Qe,cp as Ye,I as Ze,aW as xa,d$ as Ce,e9 as fa,dD as z,dk as ha,am as Z,ag as Je,bX as es,ae as ss,h8 as pa,cL as ga,V as ja,b5 as ba,e6 as va,aR as Sa,fc as ya,aA as be,cX as wa,h9 as Na,C as Ca,h as ka,gj as Ma,bZ as ts,cP as Ia,cG as Ta,fP as as,g4 as R,fK as _a}from"./haannt40upmuwmtk.js";import{f as ve,g as ns,h as Pa,i as La,j as Fa}from"./e473oe6zkw5lqbph.js";import{G as is}from"./m4g7yy9fehqi204r.js";import{e as Ea}from"./jjqeoesb3rhorlyg.js";import{W as Oa}from"./eiq9v0oy1lyfg3c8.js";import{P as Aa}from"./dlwdwnl197lh1mf5.js";function Un({onClick:s,className:t,...a}){return e.jsx(hs,{onClick:s,className:y(t,"grow overflow-hidden"),...a})}function Dn({onNewChatButtonClick:s}){const{isUnauthenticated:t,isLoading:a}=D();return a||!t?null:e.jsx(ve,{className:"me-3",onClick:()=>{_.logNewChatButtonClicked({location:"Mobile header"}),s()}})}function Gn({onNewChatButtonClick:s,clientThreadId:t}){const{isUnauthenticated:a,isLoading:n}=D(),r=Pe(),i=$e(t),c=Le(i),o=ge(t,qe.getIsNewConversation),u=Yt(),d=o&&u&&c;if(n)return null;if(a)return r?e.jsx(Ra,{}):e.jsx(Ba,{});const l=e.jsx(ve,{onClick:()=>{_.logNewChatButtonClicked({location:"Mobile header"}),s()}});return d?e.jsx(xs,{layout:"compact",clientThreadId:t}):l}function Ba(){const s=fe(),t=Fe(Se.signUpButtonText);return e.jsx(U,{as:"button",size:"small",color:"primary",onClick:()=>{s({authType:"signup",callback:a=>{_.logSignUpButtonClicked({location:"Mobile Chat Stage Header",provider:a})}})},children:e.jsx(h,{...t})})}function Ra(){const s=fe();return e.jsx(U,{as:"button",size:"small",color:"primary",onClick:()=>{s({authType:"login",callback:t=>{_.logLogInButtonClicked({location:"Mobile Chat Stage Header",provider:t})}})},"data-testid":"mobile-login-button",children:e.jsx(h,{...Zt.logInButtonText})})}function za({onClick:s}){const t=ns(ps,me,!0,!0);return e.jsxs("button",{type:"button",className:"hover:text-token-text-primary inline-flex rounded-md focus:ring-2 focus:ring-white focus:outline-hidden focus:ring-inset active:opacity-50",onClick:s,"data-testid":"open-sidebar-button",children:[e.jsx("span",{className:"sr-only",children:e.jsx(h,{...Se.openSidebar})}),e.jsx(t,{className:"icon-lg text-token-text-secondary mx-2"})]})}const Ua=({rightContentExpanded:s,onOpenSidebar:t,children:a,showNavSidebar:n,leftContent:r,rightContent:i,bottomContent:c})=>{const o=us(),u=o.pathname+o.search+o.hash;m.useEffect(()=>{Ee(window)||I.toggleNavCollapsed(!0)},[u]);const d=se(l=>l.isConversationScrolledFromTop);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:y("draggable h-header-height bg-token-main-surface-primary sticky top-0 z-10 flex items-center justify-center border-transparent ps-0 md:hidden",d?"[box-shadow:var(--sharp-edge-top-shadow)]":"[box-shadow:var(--sharp-edge-top-shadow-placeholder)]"),children:[(n||r)&&e.jsxs("div",{className:"no-draggable absolute start-0 top-0 bottom-0 ms-3 inline-flex items-center justify-center",children:[n&&e.jsx(za,{onClick:t}),r]}),e.jsx("div",{className:"no-draggable",children:a}),i&&e.jsx("div",{className:y("no-draggable absolute end-0 top-0 bottom-0 me-3 inline-flex items-center justify-center",s&&"start-10"),children:i})]}),c&&e.jsx("div",{className:"no-draggable bg-token-main-surface-primary flex w-full items-center justify-center md:hidden",children:c})]})};function Da({isPopoverOnDesktop:s=!1,children:t}){const a=fs();S.markStart("StageNavigationSidebar"),S.markRendered("StageNavigationSidebar");const n=!a||s;return e.jsxs(e.Fragment,{children:[n?e.jsx(Ha,{children:t}):null,a&&!n&&e.jsx(Ga,{children:t})]})}const rs={type:"spring",bounce:.12,duration:.64},ke={...rs,duration:.4},Ga=({style:s,children:t})=>{const a=m.useRef(null),n=m.useRef(void 0);return n.current===void 0&&(n.current=Ee(window)),n.current&&S.trackNamespace(S.NS_SIDEBAR),e.jsx(T.div,{className:y("bg-token-sidebar-surface-primary z-21 shrink-0 overflow-x-hidden [view-transition-name:var(--sidebar-slideover)] max-md:w-0!"),ref:a,initial:{width:0},transition:rs,animate:{width:260},exit:{width:0},style:s,children:e.jsx("div",{className:"h-full w-[var(--sidebar-width)]",children:e.jsx("div",{className:"flex h-full min-h-0 flex-col",children:t})})})},Ha=({style:s,children:t})=>{const a=he(),n=se(i=>i.temporaryDisableHoverSidebar),r=Y.useRef(null);return e.jsx(Jt,{open:!0,onOpenChange:i=>{i||I.toggleNavCollapsed(!0)},children:e.jsxs(ea,{forceMount:!0,children:[!a&&e.jsx(sa,{asChild:!0,className:"fixed inset-0 z-10 bg-gray-50/50 dark:bg-black/50",children:e.jsx(T.div,{transition:ke,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}})}),e.jsx(ta,{asChild:!0,className:"bg-token-sidebar-surface-primary top-banner-visible:bottom-0 top-banner-visible:top-(--top-banner-height,0px) top-banner-visible:h-auto fixed start-0 top-0 z-50 h-full w-[var(--sidebar-width)] max-w-xs border-e border-gray-200 shadow-[0_0_64px_0_rgba(0,0,0,0.07)] [view-transition-name:var(--sidebar-popover)] focus:outline-hidden dark:border-gray-800",onMouseLeave:a&&!n?()=>{r.current=window.setTimeout(()=>{I.toggleNavCollapsed(!0,"hover")},200)}:void 0,onMouseEnter:a&&!n?()=>{r.current&&window.clearTimeout(r.current)}:void 0,onOpenAutoFocus:a&&!n?i=>{i.preventDefault()}:void 0,children:e.jsxs(T.div,{transition:ke,initial:{translateX:"-100%"},animate:{translateX:"0"},exit:{translateX:"-100%"},style:s,children:[e.jsx(aa,{asChild:!0,children:e.jsxs(na,{children:[e.jsx(h,{...Se.sidebarTitle}),e.jsx(ia,{})]})}),t]})})]})})},Se=J({sidebarTitle:{id:"navigation.sidebarTitle",defaultMessage:"Sidebar"},closeSidebar:{id:"navigation.closeSidebar",defaultMessage:"Close sidebar"},openSidebar:{id:"navigation.openSidebar",defaultMessage:"Open sidebar"},signUpButtonText:{id:"navigation.signUpButtonText",defaultMessage:"Sign up"}}),Me=3;function Wa({product:s,descriptionCitation:t,clientThreadId:a,messageId:n,contentReferenceStartIndex:r,productIndex:i,analyticsMetadata:c}){const{value:o}=Xe("573184874"),[u,d]=m.useState(void 0),l=m.useRef([]),x=u?.product.offers??s.offers??[];for(const p of x)l.current.some(b=>b.merchant_name===p.merchant_name)||l.current.push(p);const[f,g]=m.useState(!1);m.useEffect(()=>g(!1),[s]);const j=gs(c),v=js.useStore();return e.jsxs("div",{className:"bg-token-main-surface-primary flex h-full flex-col",children:[e.jsx(Va,{product:s,onImageClick:p=>{v.setCurrentImage({image:{url:p,content_url:p,thumbnail_url:p,title:s.title,content_size:{width:0,height:0},thumbnail_size:{width:0,height:0}},source:bs.ProductDetails,analyticsMetadata:c,contentReferenceStartIndex:r,productIndex:i})}}),e.jsxs("div",{className:"border-token-border-sharp flex flex-col border-t px-6 py-4",children:[e.jsx("div",{className:"text-token-text-primary text-xl font-semibold",children:s.title}),s.num_reviews&&s.num_reviews>0&&e.jsxs("div",{className:"flex flex-row items-center gap-1 pt-1 text-sm text-nowrap text-ellipsis",children:[e.jsx(vs,{rating:s.rating??0}),e.jsx(h,{id:"Tj10jZ",defaultMessage:"{rating} ({num_reviews})",values:{rating:(s.rating??0).toFixed(1),num_reviews:new Intl.NumberFormat().format(s.num_reviews)}}),e.jsx(B,{label:e.jsx(h,{id:"zngDZ6",defaultMessage:"Ratings and pricing are sourced from third parties which may update over time"}),children:e.jsx(Oe,{className:"text-token-text-secondary ms-1 h-4 w-4"})})]}),s.description&&e.jsxs("div",{className:"pt-3 text-sm",children:[s.description,t&&e.jsx(Oa,{webpageItem:t,trackContentReferenceEvent:j,analyticsMetadata:{section:"products",section_location:"response"}})]})]}),e.jsx(Ss,{title:e.jsx(h,{id:"ITQW8G",defaultMessage:"Purchasing Options"}),children:e.jsxs("div",{className:"-mx-3 flex flex-col",children:[l.current.slice(0,f?l.current.length:Me).map((p,b)=>e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:e.jsx($a,{offer:p,onClick:()=>{_.logEventWithStatsig("Product Offer Clicked","product_offer_clicked",{...ra(c),content_reference_start_index:r,product_index:i,offer_index:b,product_id:s.id,offer_url:p.url,shopify_checkout_url:p.shopify_checkout_url}),window.open(p.shopify_checkout_url||p.url,"_blank")}},p.url)},p.url)),l.current.length>Me&&e.jsxs(U,{className:"w-fit px-3",size:"small",color:"ghost",onClick:()=>g(!f),children:[f?e.jsx(h,{id:"Gl3oLS",defaultMessage:"See less"}):e.jsx(h,{id:"f9tOaY",defaultMessage:"See more"}),f?e.jsx(ys,{}):e.jsx(ws,{})]})]})}),o&&e.jsx(Aa,{clientThreadId:a,messageId:n,product:s,trackContentReferenceEvent:j,onProductEntityUpdated:p=>{d(p)}})]})}function Va({product:s,onImageClick:t}){const[a,n]=m.useState(0),r=m.useRef(null);if(m.useEffect(()=>{n(0),r.current&&(r.current.scrollLeft=0)},[s]),!s.image_urls)return null;const i=s.image_urls;return e.jsxs("div",{className:"flex flex-col",children:[i[a]&&e.jsx(T.div,{className:"bg-token-main-surface-secondary dark:bg-token-main-surface-primary-inverse",drag:"x",dragConstraints:{left:0,right:0},dragElastic:0,onDragEnd:(c,{offset:o,velocity:u})=>{const d=Math.abs(o.x)*u.x,l=1e3;d<-l?a<i.length-1&&n(a+1):d>l&&a>0&&n(a-1)},onClick:()=>t(i[a]),children:e.jsx("img",{className:"m-0 aspect-square w-full object-contain mix-blend-darken",src:i[a],alt:s.title,draggable:!1})}),i.length>1&&e.jsx("div",{ref:r,className:"no-scrollbar flex flex-row gap-2.5 overflow-x-scroll px-6 py-3",children:i.map((c,o)=>e.jsx("div",{className:y("flex-none cursor-pointer overflow-hidden rounded-md border-2 p-0.5",a===o?"border-token-text-primary":"border-transparent"),onMouseEnter:()=>n(o),onClick:()=>t(c),children:e.jsx("div",{className:"bg-token-main-surface-secondary dark:bg-token-main-surface-primary-inverse",children:e.jsx("img",{className:"h-10 w-10 rounded-xs object-cover mix-blend-darken",src:c,alt:s.title})})},`${o}-${c}`))})]})}function $a({offer:s,onClick:t}){const a=s.price_details,n=a?.base&&a.shipping&&a.tax&&a.total,r=a?.display_price==="total_price"||n,i=a?.display_price==="total_price";let c=null;n&&a?c=e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("div",{children:e.jsx(h,{id:"offer.breakdown.base",defaultMessage:"Base price: {amount}",values:{amount:a.base}})}),e.jsx("div",{children:e.jsx(h,{id:"offer.breakdown.shipping",defaultMessage:"Shipping: {amount}",values:{amount:a.shipping}})}),e.jsx("div",{children:e.jsx(h,{id:"offer.breakdown.tax",defaultMessage:"Tax: {amount}",values:{amount:a.tax}})})]}):i&&(c=e.jsx(h,{id:"ur3//V",defaultMessage:"Prices shown include estimated tax and shipping."}));const o=!!s.shopify_checkout_url;return e.jsxs("div",{className:y("flex cursor-pointer flex-col rounded-xl p-3","hover:bg-token-main-surface-secondary"),onClick:t,children:[e.jsxs("div",{className:"flex flex-row items-center gap-2 text-sm font-semibold",children:[e.jsx(Ns,{className:"h-5 w-5 rounded-full",url:s.url,size:128,minSize:16,fallback:e.jsx(Cs,{className:"text-token-text-quaternary"})}),e.jsx("div",{className:"min-w-0 flex-1 truncate",children:s.merchant_name}),r&&c?e.jsx(B,{label:c,children:e.jsxs("span",{className:"flex items-baseline",children:[e.jsx(Oe,{className:"text-token-text-secondary h-3 w-3"}),e.jsx("span",{children:s.price})]})}):e.jsx("span",{children:s.price}),e.jsx(U,{className:"w-fit min-w-20 truncate",size:"small",color:o?"primary":"secondary",children:o?e.jsx(h,{id:"LlDx51",defaultMessage:"Buy now"}):e.jsx(h,{id:"sTpOJt",defaultMessage:"Buy"})})]}),e.jsx("div",{className:"text-token-text-secondary pt-2.5 text-xs",children:s.product_name}),e.jsx("div",{className:"text-token-text-secondary text-xs",children:s.details})]})}function qa({clientThreadId:s,type:t="sidebar"}){const{closeThreadSidebar:a}=Ke(),{clientThreadId:n,messageId:r,turnIndex:i,contentReferenceStartIndex:c,productIndex:o}=oa("product")??{},u=ge(n,j=>j),d=m.useMemo(()=>({clientThreadId:s,messageId:r,turnIndex:i}),[s,r,i]);if(n!==s||c===void 0||o===void 0||!r)return null;const{product:l,descriptionCitation:x}=ks({thread:u,messageId:r,contentReferenceStartIndex:c,productIndex:o});if(!l)return null;const f=`${r}-${c}-${o}`,g=e.jsx(Wa,{product:l,descriptionCitation:x,clientThreadId:s,messageId:r,contentReferenceStartIndex:c,productIndex:o,analyticsMetadata:d});switch(t){case"sidebar":return e.jsx(Ae,{handleClose:a,children:e.jsx("div",{className:"mt-[calc(var(--threadFlyOut-leading-height,57px)*-1)] h-[100vh]",children:g})},f);case"modal":return e.jsxs(la,{testId:"modal-chat-screen-product-flyout",className:"relative max-w-md",size:"custom",type:"success",noPadding:!0,title:l.title,visuallyHiddenHeader:!0,isOpen:!0,onClose:a,children:[g,e.jsx(ca,{className:"absolute end-2.5 top-2.5 z-10",onClick:a})]},f)}}function Ie({isNewConversation:s}){const t=Ms(),{value:a}=Xe("2113934735");return S.markStart("OperatorSidebarListItem",S.NS_SIDEBAR),a?a&&S.markRendered("OperatorSidebarListItem",S.NS_SIDEBAR):S.cancelRender("OperatorSidebarListItem",S.NS_SIDEBAR),e.jsxs(e.Fragment,{children:[e.jsx(Xa,{isNewConversation:s}),null,null,a?e.jsx(Is,{}):null,t?e.jsx(Ts,{}):null]})}const Xa=({isNewConversation:s})=>{const[t,a]=m.useState(!1),n=da(),r=xe(),i=L(),c=je();let o;return c==null?null:(o=ze,e.jsx("div",{className:"bg-token-sidebar-surface-primary pt-0",children:e.jsx(B,{side:"right",label:i.formatMessage(ne.newChat),className:"flex w-full items-center",children:e.jsx("div",{className:"flex-1 transition-transform duration-100 active:scale-[0.98]",onPointerEnter:u=>{u.pointerType!=="touch"&&a(!0)},onPointerLeave:u=>{u.pointerType!=="touch"&&a(!1)},children:e.jsx(Be,{loggingGizmoId:"primary",href:"/",isHovered:t,onClick:u=>{!ua(n)&&!s?(u.preventDefault(),Re(r)):ma.publish({kind:"newChatRequested"})},icon:e.jsx(is,{isFirstParty:!0,className:"h-6 w-6"}),isMenuOpen:!1,label:o,hoverRightIcon:null})})})}))},Ka=Qe(()=>Ye(()=>import("./j1oo0eciwoztqgjs.js"),__vite__mapDeps([0,1,2,3,4])).then(s=>s.SnorlaxFolderAnimation),{loading:({color:s})=>e.jsx(os,{color:s})}),Qa={open:{opacity:1,y:0,transition:{duration:.15,ease:"easeOut"}},closed:{opacity:0,y:-5,transition:{duration:.15,ease:"easeIn"}}};function Ya({color:s,folderState:t,gizmoId:a,sidebarSnorlaxFolderStore:n}){const r=L(),[i,c]=m.useState(!1);return e.jsx(B,{side:"top",sideOffset:4,delayDuration:600,label:t==="open"?r.formatMessage(re.hideChatsForProjectTooltip):r.formatMessage(re.showChatsForProjectTooltip),children:e.jsx("button",{onClick:o=>{o.preventDefault(),t==="open"?n.collapseProject(a):n.expandProject(a)},className:"text-token-text-secondary hover:bg-token-sidebar-surface-tertiary -m-0.5 flex rounded-xl p-0.5",onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},children:e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"text-token-text-primary relative flex h-full items-center justify-center",children:e.jsx(Ka,{isOpen:t==="open",isHovered:i,color:s})})})})})}function os({color:s}){return e.jsx("div",{className:"text-token-text-primary flex h-6 w-6 shrink-0 items-center justify-center",children:e.jsx(_s,{className:"h-3/4 w-3/4",style:{color:s}})})}function le({gizmo:s,historyDisabled:t,section:a,onClick:n,isActive:r,hideOverflowMenu:i=!1,elementRef:c}){const{clientThreadId:o}=Ea(),u=Ze(o),d=L(),[l,x]=m.useState(!1),[f,g]=m.useState(!1),j=s.gizmo.id,v=ce.useStore(),p=ce.useState(M=>ce.selectFolderState(M,j)),b=xa(),N=!!s.gizmo.tags?.includes(Ps.FirstParty),w=Ls(),C=Fs(),{items:F=[],hasNextPage:V}=Es(s.gizmo.id),k=Os(j),G=As(s),P=Bs();let $=!1;r&&k&&!(p==="open"&&u)&&($=!0),m.useEffect(()=>{p!=="open"&&r&&u&&v.expandProject(j)},[r,u,v,j]);let H;if(s!=null)H=s.gizmo.display.name||Rs;else{if(b==null)return null;t?H=d.formatMessage(ne.clearChat):H=ze}const te=w!=null&&w.kind==="conversation"&&(w.gizmoId==null||w.gizmoId!=j);return e.jsxs(e.Fragment,{children:[e.jsx(T.div,{onMouseEnter:P?()=>{g(!0)}:void 0,onMouseLeave:()=>{g(!1)},onDrop:M=>{M.preventDefault(),te&&(C({newGizmoId:j,conversation:w.conversation,previousGizmoId:w.gizmoId??null}),g(!1))},onDragOver:M=>{M.preventDefault(),te&&g(!0)},onDragLeave:()=>{g(!1)},children:e.jsx(Be,{loggingGizmoId:s?.gizmo.id??"primary",href:zs(s),onClick:n,showActiveIndicator:$,isHovered:f,icon:k&&F.length>0?e.jsx(Ya,{color:G,folderState:p,gizmoId:j,sidebarSnorlaxFolderStore:v}):k?e.jsx(os,{color:G}):e.jsx(is,{isFirstParty:N,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6 shrink-0"}),isMenuOpen:l,label:H,rightIcon:a===Q.Workspace&&e.jsx(B,{side:"right",label:d.formatMessage(Te.workspaceRecommended,{workspace_name:b?.name??"Your Workspace"}),children:e.jsx(Us,{className:"icon-md text-token-text-secondary",alt:d.formatMessage(Te.workspaceRecommended,{workspace_name:b?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(f||l)&&!i&&(k?e.jsx("div",{className:"text-token-text-tertiary",onClick:M=>{M.preventDefault()},children:e.jsx(Ds,{gizmo:s,isOpen:l,setIsOpen:x})}):e.jsx("div",{className:"text-token-text-tertiary",onClick:M=>{M.preventDefault()},children:e.jsx(Gs,{gizmo:s,isOpen:l,setIsOpen:x,section:a})})),!k&&!i&&e.jsx(B,{side:"right",label:d.formatMessage(t?ne.clearChat:ne.newChat),className:"flex items-center",children:e.jsx("button",{className:l?"text-token-text-tertiary":"text-token-text-secondary hover:text-token-text-primary invisible group-hover:visible",children:t?e.jsx(Hs,{className:"icon-md"}):e.jsx(Ws,{className:"icon-md"})})})]}),elementRef:c})}),e.jsx(ee,{initial:!1,children:k&&p==="open"&&F.length>0&&e.jsx(T.div,{initial:"closed",animate:"open",exit:"closed",variants:Qa,className:"overflow-hidden",children:e.jsx(Vs,{gizmoResource:s,serverThreadId:u,isOnProjectPage:$,conversations:F,hasNextPage:V})},"nested-conversations")})]})}const Te=J({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}}),Za=2;function Ja({gizmos:s,maxToShowOnLoad:t=4,showAllSidebarItems:a}){const n=Qs(s,f=>f.flair.kind),r=[...(n[ae.Workspace]?.map(({resource:f})=>({gizmo:f,section:Q.Workspace}))??[]).slice(0,3),...n[ae.FirstParty]?.map(({resource:f})=>({gizmo:f,section:Q.Keep}))??[],...n[ae.SidebarKeep]?.map(({resource:f})=>({gizmo:f,section:Q.Keep}))??[]],i=n[ae.Recent]??[],o=(a?i:i.slice(0,Za)).map(({resource:f})=>({gizmo:f,section:Q.Recents})),u=r.length;let d=[];d=[...r,...o],a||(d.length>t&&u>t?d=d.slice(0,u):d.length>t&&(d=d.slice(0,t)));const x=s.length>d.length;return{listItems:d,itemsLeft:s.length-d.length,needsToCollapseItems:x,total:s.length}}function en({gizmo:s,currentGizmoId:t,maxToShowOnLoad:a,hideOverflowMenu:n=!1}){const r=se(d=>!$s.isGptListCollapsed(d)),{listItems:i,needsToCollapseItems:c,itemsLeft:o}=Ja({gizmos:s,maxToShowOnLoad:a,showAllSidebarItems:r});function u(d,l){return e.jsx(le,{gizmo:d,isActive:d.gizmo.id===t,section:l,hideOverflowMenu:n},d.gizmo.id)}return e.jsxs("div",{children:[i.map(({gizmo:d,section:l},x)=>e.jsxs(m.Fragment,{children:[x>1&&l!==i[x-1].section&&e.jsx("div",{className:"bg-token-border-default my-2 ms-2 h-px w-7"}),u(d,l)]},x)),c?e.jsxs("button",{onClick:I.toggleGptListCollapsed,className:"text-token-text-primary hover:bg-token-sidebar-surface-secondary flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm",children:[e.jsx("div",{className:"flex h-6 w-6 shrink-0 items-center justify-center",children:e.jsx(Ue,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:r?e.jsxs(e.Fragment,{children:[e.jsx(h,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(qs,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:o}}),e.jsx(Xs,{className:"icon-xs"})]})})]}):null,e.jsx(Ks,{})]})}function sn({currentGizmoId:s}){const t=De(),a=je(),{data:{gizmos:n}={}}=Ys();let r=n;t&&(r=n?.filter(o=>!Zs(o.resource))),S.markStart("GizmoSidebarList",S.NS_SIDEBAR),r!==void 0&&S.markRendered("GizmoSidebarList",S.NS_SIDEBAR);const i=Ce("2152104812","hide_gpts_if_none",!1),c=Ce("2152104812","hide_default_gpts",!1);return a?i&&n?.length===0?!c&&e.jsx(Ie,{isNewConversation:!0}):e.jsxs(e.Fragment,{children:[!c&&e.jsx(Ie,{isNewConversation:!0}),e.jsx(en,{gizmo:r??[],currentGizmoId:s,maxToShowOnLoad:7})]}):null}function tn({currentGizmoId:s,onClick:t}){const{isSidebarFlyoutOpen:a,onSidebarFlyoutOpenChange:n}=Js(),r=a(oe.Snorlax);return e.jsx("div",{className:"group flex w-full items-center justify-start",children:e.jsx(fa,{onOpenChange:i=>n(oe.Snorlax,i),side:"right",sideOffset:4,open:r,contentAlign:"end",triggerButton:e.jsxs("button",{className:y("tracking-condensed text-token-text-secondary hover:bg-token-sidebar-surface-secondary screen-arch:py-[7px] screen-arch:text-body can-hover:hover:screen-arch:bg-token-main-surface-secondary flex flex-1 items-center gap-2.5 rounded-lg px-2 py-1.5 text-sm ease-[var(--spring-bounce)] select-none focus:ring-0 motion-safe:active:scale-[98%] motion-safe:active:transition-transform",r&&"bg-token-main-surface-secondary"),onClick:t,children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"text-token-text-primary relative flex h-full items-center justify-center",children:e.jsx(Ue,{className:"icon-md text-token-sidebar-icon font-semibold"})})}),e.jsx("span",{className:"text-start",children:e.jsx(h,{...re.seeMoreProjectItems})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] w-80 overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(z,{children:e.jsx(et,{currentGizmoId:s,inSidebarFlyout:!0,customListItem:le})})})})})}function an({snorlaxes:s,currentGizmoId:t}){return e.jsx(e.Fragment,{children:s.map(a=>e.jsx(le,{gizmo:a.gizmo,isActive:a.gizmo.gizmo.id===t},a.gizmo.gizmo.id))})}function nn({currentGizmoId:s,includeRevisedSidebarIa:t}){const a=L(),{snorlaxes:n,data:r,isLoading:i,isError:c,refetch:o,hasNextPage:u}=st(),d=n.slice(0,de),l=m.useRef(!1),[x,f]=m.useState(!0),g=m.useCallback(function(F){F&&f(!1),o()},[o,f]),j=(n??[]).length===0,v=c||r===void 0&&!i&&l.current;S.markStart("SnorlaxSidebarList",S.NS_SIDEBAR),r!=null&&!i&&S.markRendered("SnorlaxSidebarList",S.NS_SIDEBAR),r===void 0&&!i&&!l.current&&(l.current=!0,g(!1));const b=n?.find(C=>C.gizmo.gizmo.id===s),N=d.some(C=>C.gizmo.gizmo.id===s),w=n&&(n?.length>(!s||N?de:de+1)||u);return e.jsxs(e.Fragment,{children:[v&&e.jsx(tt,{showRetry:x,refetch:g}),!v&&e.jsx(at,{id:"snorlax-heading",condensed:t,header:e.jsxs(z,{children:[a.formatMessage(re.projectsHeading),!j&&e.jsx(nt,{})]}),isLastInGroup:!0,ulClassName:"screen-arch:mb-3",children:!i&&e.jsxs(e.Fragment,{children:[e.jsx(an,{snorlaxes:d,currentGizmoId:s}),b&&!N&&e.jsx(le,{gizmo:b.gizmo,isActive:!0}),w&&e.jsx(tn,{currentGizmoId:s}),!i&&j&&e.jsx(it,{})]})})]})}function rn({clientThreadId:s}){const t=Ze(s),{isUnauthenticated:a}=D(),n=$e(s),r=Je(),i=De(),[c,o]=m.useState(!1),u=m.useCallback(l=>l===oe.Snorlax?c:!1,[c]),d=m.useCallback((l,x)=>{l===oe.Snorlax&&o(x)},[]);return e.jsx(ct,{value:{isSidebarFlyoutOpen:u,onSidebarFlyoutOpenChange:d},children:e.jsxs("div",{id:"sidebar",className:"group/sidebar",children:[!a&&e.jsx(sn,{currentGizmoId:n}),e.jsx(dt,{}),i&&e.jsx(nn,{currentGizmoId:n}),null,!a&&e.jsx(ut,{activeId:r?void 0:t})]})})}function Hn({clientThreadId:s}){const{isUnauthenticated:t}=D();return t?null:e.jsx(rn,{clientThreadId:s})}function on({className:s,onNewThread:t}){const a=L(),n=ha(()=>navigator.windowControlsOverlay),{isFannyPackEnabled:r}=rt(),i=ns(xt,mt,!0,!0),c=Pa(),o=se(x=>x.isSidebarLocked),u=he(),d=a.formatMessage({id:"Q6nsOM",defaultMessage:"Close sidebar"}),l=a.formatMessage({id:"FIsqAC",defaultMessage:"Lock sidebar open"});return e.jsxs("div",{id:"sidebar-header",className:y("flex",n?.visible&&n.getTitlebarAreaRect().left>0?"justify-end":"justify-between",s),children:[o||!u?e.jsx(B,{sideOffset:4,label:d,className:"flex",side:"right",children:e.jsx(ye,{className:"no-draggable","aria-label":d,onClick:()=>{I.toggleNavCollapsed(void 0,"button_click"),u&&I.setTemporaryDisableHoverSidebar()},icon:i,mobileIcon:me,"data-testid":"close-sidebar-button"})}):e.jsx(B,{sideOffset:4,label:l,className:"flex",side:"right",children:e.jsx(ye,{className:"no-draggable","aria-label":l,onClick:()=>{Z.logEvent("chatgpt_web_sidebar_locked"),I.setIsSidebarLocked(!0),I.setTemporaryDisableHoverSidebar()},icon:ot,mobileIcon:me,"data-testid":"lock-sidebar-button"})}),e.jsxs("div",{className:"flex",children:[c&&e.jsx(La,{}),r&&e.jsx(lt,{}),e.jsx(ve,{onClick:t,testId:"create-new-chat-button"})]})]})}function ln({showFreeTrialLoadingPayment:s,handleGetPaymentLink:t}){const a=L(),n=()=>{s||(ie(!0),t())},r=g=>{g.stopPropagation(),ft(!0),ht(!0)},{data:i,isLoading:c,isSuccess:o}=ms({queryKey:["claimedReferralInvite"],queryFn:()=>ss.getClaimedReferralInvite(),refetchOnMount:!1,refetchOnWindowFocus:!1,refetchInterval:!1,refetchOnReconnect:!1}),u=i?.invite_code,[d,l]=m.useState(!1);if(m.useEffect(()=>{u&&!d&&o&&(l(!0),Z.logEvent("chatgpt_referral_show_claimed_sidebar_menu_promo"),_.logEvent("Referral: Show Claimed Sidebar Menu Promo"))},[u,l,d,o]),!u||c||!o)return null;const x=u.invite_metadata.invite_data,f=x?.referral_trial_duration_months?x?.referral_trial_duration_months>1?a.formatMessage(ue.monthsOfBenefit,{referralTrialDurationMonths:x?.referral_trial_duration_months}):a.formatMessage(ue.daysOfBenefit,{referralTrialDurationDays:x?.referral_trial_duration_days}):null;return e.jsx(T.div,{className:y("relative",{"cursor-progress opacity-50":s}),layout:"position",initial:{y:-10,opacity:1},animate:{y:0,opacity:1,transition:{duration:.1,ease:"easeIn"}},children:e.jsxs(cn,{className:y(s&&"opacity-75"),onClick:n,children:[e.jsxs("div",{className:"flex w-full flex-row items-center justify-start gap-3",children:[e.jsx(pa,{className:"icon-sm shrink-0"}),e.jsx(h,{...ue.freeTrialCta,values:{duration:f}})]}),!s&&e.jsx(ga,{onClick:r,className:"icon-md text-token-text-tertiary shrink-0 rounded-full p-0.5 opacity-50 transition-colors duration-200 group-hover:opacity-100 hover:bg-[#0077FF] hover:text-red-500"}),e.jsx("span",{className:"absolute top-11 h-0 w-0 border-s-8 border-e-8 border-t-8 border-s-transparent border-e-transparent border-t-[#0077FF] transition-colors duration-200 group-hover:border-t-[#0077FF]"})]})})}const cn=es.a`group relative mb-1 rounded-md hover:[#0077FF] bg-[#0077FF] flex px-3 min-h-[44px] py-1 items-center gap-3 transition-colors duration-200 dark:text-white cursor-pointer text-sm`,ue=J({freeTrialCta:{id:"PaymentMenuItems.freeTrialCta",defaultMessage:"Get {duration}!"},monthsOfBenefit:{id:"FreeTrialMenuItem.monthsOfBenefit",defaultMessage:"{referralTrialDurationMonths, plural, one {one month free} other {# months free}}"},daysOfBenefit:{id:"FreeTrialMenuItem.daysOfBenefit",defaultMessage:"{referralTrialDurationDays, plural, one {one day free} other {# days free}}"}}),dn=Qe(()=>Ye(()=>import("./g0kxck7ediewm05i.js"),__vite__mapDeps([5,1,6,2,3,7,8,9,10,11,12])));function un(){const s=L(),t=ja(),a=ba(),{isLoading:n,data:r}=va(),i=Sa(r),c=i?.hasPaidSubscription()??!1,o=i?.hasClaimedFreeTrial()??!1,u=m.useMemo(()=>i?.subscriptionAnalyticsParams,[i]),d=async()=>{ie(!0),_.logEvent("Account Pay: Payment Checkout Clicked",u);try{const P=await ss.getCheckoutLink(a,"PaymentMenuItems");window.location.href=P.url}catch{t.warning(s.formatMessage(A.paymentErrorWarning),{hasCloseButton:!0}),ie(!1)}finally{}},l=()=>{f||(ie(!0),d())},x=we(P=>P.didCloseFreeTrial),f=we(P=>P.showFreeTrialLoadingPayment),g=!x&&o,j=i?.wasPaidCustomer()??!1;let v=i?.isWorkspaceAccount()??!1;const p=i?.hasPaidSubscription()??!1,b=i?.isPlus()??!1,N=r&&ya(r),{layer:w}=be("2670443078");let C=b;!v&&!b&&N&&w.get("is_gating_fix_enabled",!1)&&(C=N,v=!0);const F=!n&&!v,V=xe(),k=()=>{_.logEvent("Account Pay: Click Sidebar Account Pay",u),bt(V,"Sidebar account payment menu item")};let G=i?.isTeam()??!1;return e.jsxs(e.Fragment,{children:[!c&&g&&e.jsx(ln,{showFreeTrialLoadingPayment:f,handleGetPaymentLink:d}),G&&e.jsx(mn,{currentWorkspace:i}),F&&e.jsx(Ge,{onClick:g?l:k,className:"m-0 rounded-lg px-2",children:e.jsx("span",{className:"flex w-full flex-row flex-wrap-reverse justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(xn,{wasPaidCustomer:j,showFreeTrialLoadingPayment:f,hasPlusSubscription:C,hasPaidSubscription:p})})})})]})}const mn=({currentWorkspace:s})=>e.jsxs(e.Fragment,{children:[e.jsx(Ge,{onClick:()=>{I.openModal(pt.InviteUsersToWorkspace),_.logEvent("Account: Invite Member Button Clicked",{location:"payment-menu-click"}),Z.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"payment-menu-click",text:"AddTeammatesWithInfo",step:"OpenModal"})},className:"m-0 rounded-lg px-2",children:e.jsx("span",{className:"flex w-full flex-row flex-wrap-reverse justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(e.Fragment,{children:[e.jsx("span",{"aria-label":"",className:"border-token-border-default flex h-7 w-7 items-center justify-center rounded-full border",children:e.jsx(gt,{className:"icon-sm shrink-0"})}),e.jsx("div",{className:"flex flex-col",children:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:e.jsx(h,{...A.addTeammates})}),e.jsx("span",{className:"text-token-text-tertiary line-clamp-1 text-xs",children:e.jsx(h,{...A.addTeammatesUpsell})})]})})]})})})}),s!=null&&e.jsx(dn,{workspace:s})]}),xn=({wasPaidCustomer:s,showFreeTrialLoadingPayment:t,hasPlusSubscription:a,hasPaidSubscription:n})=>t?e.jsx(wa,{className:"icon-sm shrink-0"}):n&&!a?null:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"border-token-border-default flex h-7 w-7 shrink-0 items-center justify-center rounded-full border",children:e.jsx(jt,{className:"icon-sm"})}),e.jsx("div",{className:"flex flex-col",children:s?e.jsx(h,{...A.renewPlus}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:a?e.jsx(h,{...A.viewPlans}):!n&&e.jsx(h,{...A.upgradePlan})}),e.jsx("span",{className:"text-token-text-tertiary line-clamp-1 text-xs",children:a?e.jsx(h,{...A.upgradeToProOrTeamUpsell}):!n&&e.jsx(h,{...A.upgradeToPlusUpsell})})]})})]}),A=J({upgradePlan:{id:"PaymentMenuItems.upgradePlan",defaultMessage:"Upgrade plan"},viewPlans:{id:"PaymentMenuItems.viewPlans",defaultMessage:"View plans"},upgradeToTeamUpsell:{id:"PaymentMenuItems.upgradeToTeamUpsell",defaultMessage:"Collaborate on a Team plan"},upgradeToProOrTeamUpsell:{id:"PaymentMenuItems.upgradeToProOrTeamUpsell",defaultMessage:"Unlimited access, team features, and more"},upgradeToPlusUpsell:{id:"PaymentMenuItems.upgradeToPlusUpsell.0",defaultMessage:"More access to the best models"},renewPlus:{id:"PaymentMenuItems.renewPlus",defaultMessage:"Renew Plus"},inviteReferral:{id:"PaymentMenuItems.inviteReferral",defaultMessage:"Refer a friend"},addTeammates:{id:"PaymentMenuItems.addTeammates.0",defaultMessage:"Add teammates"},addTeammatesUpsell:{id:"PaymentMenuItems.addTeammatesUpsell.0",defaultMessage:"Invite coworkers to ChatGPT"},paymentErrorWarning:{id:"PaymentMenuItems.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."}});function Wn({navHeader:s,children:t,className:a}){const n=L(),r=m.useRef(null),i=Je(),c=Le(),o=i&&!c,{isUnauthenticated:u}=D(),{layer:d}=be("1578749296"),l=d.get("is_sticky_toggle_off",!1);return m.useEffect(()=>{l&&I.toggleNavCollapsed()},[l]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"draggable relative h-full w-full flex-1 items-start border-white/20",children:[e.jsx(Na,{asChild:!0,children:e.jsx("h2",{children:e.jsx(h,{...W.chatHistoryLabel})})}),e.jsxs("nav",{className:y("flex h-full w-full flex-col ps-3",a),"aria-label":n.formatMessage(W.chatHistoryLabel),children:[s,e.jsx(hn,{ref:r,$disableScroll:o&&!u,children:t}),e.jsx(z,{children:e.jsx("div",{className:"pe-3",children:e.jsx(fn,{})})})]})]})})}function fn(){const[s]=m.useState(()=>{const i=Ca.getCookie(ka.Workspace);return typeof i=="string"&&i!==Ma}),t=je(),{isUnauthenticated:a}=D(),{openSettings:n}=vt(),r=St();return s&&!t||!t?null:a?e.jsx(ls,{}):e.jsxs("div",{className:y("flex flex-col py-2 empty:hidden dark:border-white/20"),children:[e.jsx(yt,{}),e.jsx(un,{}),r&&e.jsx("div",{className:"flex w-full items-center md:hidden",children:e.jsx("div",{className:"max-w-[100%] grow",children:e.jsx(Fa,{onClickSettings:()=>n()})})})]})}const ls=()=>{const s=Pe(),t=fe(),a=Fe(W.unauthSignupCta),n=()=>{t({authType:"login",callback:o=>{_.logLogInButtonClicked({location:"Sidebar bottom unit",provider:o}),Z.logEvent("chatgpt_sidebar_login_button_clicked")}})},r=()=>{t({authType:"signup",callback:o=>{_.logSignUpButtonClicked({location:"Sidebar bottom unit",provider:o}),Z.logEvent("chatgpt_sidebar_signup_button_clicked")}})},i=e.jsx(U,{as:"button",size:"medium",color:s?"secondary":"primary","data-testid":"signup-button",onClick:r,children:e.jsx(h,{...a})},"signup-button"),c=e.jsx(U,{as:"button",size:"medium",color:s?"primary":"secondary","data-testid":"login-button",onClick:n,children:e.jsx(h,{...W.unauthLoginCta})},"login-button");return e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"mt-2 mb-4",children:[e.jsx("p",{className:"text-token-text-primary mb-1 text-sm font-semibold",children:e.jsx(h,{...s?W.logInOrSignUp:W.signUpOrLogIn})}),e.jsx("p",{className:"text-token-text-secondary text-sm",children:e.jsx(h,{id:"tr+zlt",defaultMessage:"Get smarter responses, upload files and images, and save your conversations."})})]}),e.jsx("div",{className:"flex flex-row items-start gap-2",children:s?[c,i]:[i,c]})]})},hn=es.div`flex-col flex-1 transition-opacity duration-500 relative pe-3
  ${({$disableScroll:s})=>s?"overflow-y-hidden opacity-20 pointer-events-none":"overflow-y-auto"}`,W=J({chatHistoryLabel:{id:"NavigationContent.chatHistoryLabel",defaultMessage:"Chat history"},closeSidebar:{id:"NavigationContent.closeSidebar",defaultMessage:"Close sidebar"},signInToChat:{id:"NavigationContent.signInToChat",defaultMessage:"Sign in to ChatGPT"},signUpOrLogIn:{id:"NavigationContent.signUpOrLogIn",defaultMessage:"Sign up or log in"},logInOrSignUp:{id:"NavigationContent.logInOrSignUp",defaultMessage:"Log in or sign up for free"},unauthSignupCta:{id:"NavigationContent.unauthSignupCta",defaultMessage:"Sign up"},unauthLoginCta:{id:"NavigationContent.unauthLoginCta",defaultMessage:"Log in"}}),pn=()=>{const s=xe();return e.jsxs("div",{className:"flex h-full flex-col gap-2 p-3",children:[e.jsx(on,{className:"h-header-height xs:pe-3 flex items-center",onNewThread:()=>{Re(s)}}),e.jsx(gn,{}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(ls,{})})]})},cs="border border-token-border-xlight bg-token-sidebar-surface-secondary";function O({className:s,width:t}){return e.jsx("div",{className:y("h-2.5 grow rounded-sm",cs,s),style:{maxWidth:t+"px"}})}function gn(){const s=e.jsx("div",{className:y("h-4 w-4 shrink-0 grow-0 rounded-full",cs)});return e.jsxs("div",{className:"mt-2 flex w-full grow flex-col gap-4 overflow-hidden px-2",style:{maskImage:"linear-gradient(to bottom, black 50%, transparent 100%)",WebkitMaskImage:"linear-gradient(to bottom, black 50%, transparent 100%)"},children:[e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(O,{width:80})]}),e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(O,{width:120})]}),e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(O,{width:100})]}),e.jsx("div",{className:"mt-5 flex flex-row items-center justify-start gap-3",children:e.jsx(O,{width:150})}),e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(O,{width:50})]}),e.jsxs("div",{className:"flex flex-row items-center justify-start gap-3",children:[s,e.jsx(O,{width:100})]}),e.jsxs("div",{className:"mb-5 flex flex-row items-center justify-start gap-3",children:[s,e.jsx(O,{width:80})]}),[120,180,160,100,90,190,140,120,180,170,100,120,180,150].map((t,a)=>e.jsx("div",{className:"flex flex-row items-center justify-start py-1",children:e.jsx(O,{width:t})},a))]})}function jn({children:s}){return e.jsx("div",{className:"bg-token-main-surface-primary h-full w-full px-[22px] py-4",children:s})}function bn(){return e.jsxs("div",{className:"flex w-full gap-2",children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx(q,{className:"h-full w-full rounded-full!"})}),e.jsxs("div",{className:"flex w-full flex-col gap-2",children:[e.jsx(q,{}),e.jsx(q,{}),e.jsx(q,{}),e.jsx(q,{})]})]})}function X({icon:s,message:t,iconClassName:a}){return e.jsx("div",{className:"loading-shimmer-pure-text flex h-8 gap-1 overflow-hidden",children:e.jsx(pe,{fillIcon:!1,icon:s,className:a,children:e.jsx("div",{className:"mt-[.5px] flex h-10",children:t})})})}const vn=({finalRow:s})=>{const t=L(),a=s.type==="fileOpen"?wt[s.iconType]??Nt:null;return e.jsx(ee,{children:e.jsx(T.div,{layout:!0,transition:{type:"spring",stiffness:300,damping:30},className:"flex flex-col items-start justify-start gap-4",children:s.type==="search"?e.jsx(X,{icon:e.jsx(Ct,{className:"text-token-text-primary relative h-5 w-5 opacity-50"}),message:t.formatMessage({id:"f9wsyE",defaultMessage:"Searching…"})}):s.type==="websiteOpen"?e.jsx(X,{icon:e.jsx(kt,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"8L6BBp",defaultMessage:"Reading…"})}):s.type==="fileOpen"?e.jsx(X,{icon:e.jsx(a,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"h5M4/O",defaultMessage:"Reading file…"})}):s.type==="pythonAnalysis"?e.jsx(X,{icon:e.jsx(Mt,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"jZ7gNw",defaultMessage:"Analyzing…"})}):e.jsx(X,{icon:e.jsx(ts,{className:"inline-flex h-5 w-5 items-center justify-center opacity-50"}),message:t.formatMessage({id:"bSPYmC",defaultMessage:"Thinking…"})})})})};function K({children:s}){return e.jsx(T.div,{className:"w-full",initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:s})}const Sn=({previousRow:s,currentRow:t})=>e.jsx("div",{className:"flex flex-col items-start justify-start gap-4",children:t.type==="search"?e.jsx(K,{children:e.jsx(It,{row:t,showIcon:!s||s.type!=="search"})},`search_${t.id}`):t.type==="summary"?e.jsx(K,{children:e.jsx(Tt,{row:t,showIcon:!s||s.type!=="summary"})},`summary_${t.id}`):t.type==="websiteOpen"?e.jsx(K,{children:e.jsx(_t,{website:t})},`website_${t.id}`):t.type==="fileOpen"?e.jsx(K,{children:e.jsx(Pt,{row:t})},`file_${t.id}`):t.type==="pythonAnalysis"?e.jsx(K,{children:e.jsx(Lt,{row:t})},`python_${t.id}`):null}),yn=120,wn=1e3*60*2;function _e(s){s?.scrollIntoView({block:"center",behavior:"smooth"})}function Nn({caterpillarStatusMessageTexts:s}){return e.jsx("div",{className:"p-4",children:e.jsx(We,{type:"error",title:s.failureMessage,content:s.failureBannerContentMessage})})}function Cn({caterpillarStatusMessageTexts:s}){return e.jsx("div",{className:"p-4",children:e.jsx(We,{title:s.cancelledMessage,content:""})})}function kn({interruptPrompt:s,setInterruptPrompt:t,handleInterruptCaterpillar:a}){const n=L();return e.jsxs("div",{className:"flex w-full flex-col justify-center gap-4 p-4",children:[e.jsx(At,{ariaLabel:n.formatMessage({id:"aYWRtV",defaultMessage:"Press enter to interrupt task"}),name:"interrupt-caterpillar-prompt",value:s,onChange:r=>t(r.target.value),color:"search",onPressEnter:a}),e.jsx(U,{onClick:a,children:e.jsx(h,{id:"h73FdF",defaultMessage:"Interrupt task"})})]})}function Mn({sourcesCount:s,taskInfo:t}){const a=ge(t.originalConversationId,r=>qe.findNode(r,i=>i.message.metadata?.b1de6e2_s===!0&&i.message.metadata?.async_task_id===t.taskId)?.message.metadata?.async_task_status_messages),n=m.useMemo(()=>a?.completed_no_time?e.jsxs(e.Fragment,{children:[a?.completed_with_time??a?.completed_no_time,e.jsx(h,{id:"zxfmo/",defaultMessage:" · {sourcesCount} sources",values:{sourcesCount:s}})]}):e.jsx(h,{id:"YG7a0T",defaultMessage:"Completed · {sourcesCount} sources",values:{sourcesCount:s}}),[s,a]);return!t.updatedAt&&!a?.completed?null:e.jsx(pe,{icon:e.jsx(Ta,{className:"text-token-text-secondary"}),fillIcon:!1,children:e.jsx("div",{className:"text-token-text-tertiary",children:n})})}function In({taskInfo:s,caterpillarStatusMessageTexts:t,sourcesCount:a,caterpillarHeaderRef:n}){const[r,i]=m.useState(""),[c,o]=m.useState(!1),u=Ia("caterpillar-interrupts"),d=m.useRef(!1),l=m.useRef(null),x=m.useMemo(()=>(d.current=!!l.current&&Ft(l.current,yn),s.rows??[]),[s.rows]);m.useEffect(()=>{if(x.length===0){const p=new Date(s.createdAt).getTime(),b=Date.now()-p,N=wn-b;if(N>0){const w=setTimeout(()=>{o(!0)},N);return()=>clearTimeout(w)}else o(!0)}else o(!1)},[x,s.createdAt]),m.useEffect(()=>{d.current&&_e(l.current)},[x]),m.useEffect(()=>{Ne(s)||setTimeout(()=>{l.current&&_e(l.current)},100)},[]);const f=Et({taskId:s.taskId,prompt:r}),g=Ne(s)||Ot(s),j=m.useCallback(async()=>{await f.mutateAsync(),i("")},[f,i]),v=m.useMemo(()=>x.length?g?x:x.slice(0,x.length-1):x,[x,g]);return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{ref:n},"task-header"),e.jsxs("div",{className:"flex w-full flex-col gap-4",children:[e.jsx("div",{className:"text-base font-medium",children:s.title}),x.length?e.jsxs(ee,{initial:!1,children:[v.map((p,b)=>e.jsx(Sn,{previousRow:b>0?x[b-1]:null,currentRow:p},p.id)),!g&&e.jsx(vn,{finalRow:x[x.length-1]})]}):c?e.jsx(pe,{fillIcon:!1,icon:e.jsx(ts,{className:"text-token-text-primary inline-flex h-5 w-5 items-center justify-center"}),children:t.waitingInQueueMessage}):e.jsx(bn,{}),He(s)&&u&&e.jsx(kn,{interruptPrompt:r,setInterruptPrompt:i,handleInterruptCaterpillar:j}),s.status==="failed"?e.jsx(Nn,{caterpillarStatusMessageTexts:t}):s.status==="cancelled"?e.jsx(Cn,{caterpillarStatusMessageTexts:t}):s.status==="completed"?e.jsx(Mn,{caterpillarStatusMessageTexts:t,taskInfo:s,sourcesCount:a}):null]}),e.jsx("div",{ref:l},"task-footer")]})}function Tn({taskId:s,setWidth:t=void 0,initialTab:a}){const n=Bt(f=>Rt.getTask(s,f)),{closeThreadSidebar:r}=Ke(),[i,c]=m.useState(a),o=zt(),u=m.useRef(null),d=!1;m.useEffect(()=>{c(a)},[a]),m.useEffect(()=>{},[n?.taskId,n?.status,d]),m.useEffect(()=>{},[n?.taskId,n?.status,i]),m.useEffect(()=>{},[t,n,d]);const{uniqueSources:l,totalSources:x}=m.useMemo(()=>{if(!n?.rows)return{uniqueSources:[],totalSources:0};const f=Ut(n.rows),g=f.reduce((j,v)=>j+v.count,0);return{uniqueSources:f,totalSources:g}},[n?.rows]);return e.jsx(Ae,{handleClose:r,leading:e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(Dt,{activeTab:i,setActiveTab:c,showAuxTab:d,sourcesCount:x,caterpillarHeaderRef:u})}),children:n&&e.jsxs(jn,{children:[!1,i==="activity"&&e.jsx(In,{taskInfo:n,caterpillarStatusMessageTexts:o,sourcesCount:x,caterpillarHeaderRef:u}),i==="sources"&&e.jsx(Gt,{taskIsPending:He(n),finalMessage:n.finalMessage,sources:l,caterpillarHeaderRef:u})]})})}function _n({isExpanded:s,children:t}){const a=m.useRef(null),[n,r]=m.useState("400px"),i=Y.isValidElement(t)?Y.cloneElement(t,{setWidth:r}):t;return e.jsx(ee,{children:e.jsx(T.div,{className:"bg-token-sidebar-surface-primary relative z-1 shrink-0 overflow-x-hidden max-lg:w-0!",ref:a,initial:!1,animate:{width:s?n:0,transition:{type:"spring",bounce:.12,duration:.3}},onAnimationStart:()=>{a.current&&(a.current.style.visibility="visible")},onAnimationComplete:()=>{a.current&&(s||(a.current.style.visibility="hidden"))},children:e.jsx("div",{className:y("absolute h-full",!s&&"pointer-events-none"),style:{width:n},children:e.jsx("div",{className:"flex h-full flex-col",children:i})})})})}const Vn=({setWidth:s,clientThreadId:t})=>{const a=as(),n=Ve();return a?e.jsxs(e.Fragment,{children:[R(a,"searchSources")&&e.jsx(Ht,{clientThreadId:t}),R(a,"retrievalResults")&&e.jsx(Wt,{clientThreadId:t}),n&&R(a,"summarizer")&&e.jsx(Vt,{clientThreadId:t}),R(a,"caterpillar")&&e.jsx(Tn,{taskId:a.caterpillarId,initialTab:a.initialTab,setWidth:s}),R(a,"product")&&e.jsx(qa,{clientThreadId:t})]}):null};function ds({children:s,hideNavigation:t=!1,mobileHeaderContent:a,mobileHeaderRightContentExpanded:n,mobileHeaderLeftContent:r,mobileHeaderRightContent:i,mobileHeaderBottomContent:c,renderNavSidebar:o,threadFlyout:u,forceOpenDesktopSidebar:d=!1}){const{isUnauthenticated:l}=D(),[x,f,g,j]=se(E=>[E.activeStageSidebar,E.activeSidebar,E.isSidebarLocked,E.temporaryDisableHoverSidebar]),v=he(),p=_a(),b=as(),N=$t(),w=[];let C=null;Y.Children.forEach(s,E=>{Y.isValidElement(E)&&(E.type===ds.Sidebars?C=E:w.push(E))});const{layer:F}=be("3737571708"),V=F.get("sidebar_type","slick"),k=(!l||V==="heavy")&&!t&&o!=null,G=!t&&(k||l),P=Ve(),$=b?R(b,"summarizer")&&P:!1,H=b?!R(b,"summarizer"):!1,te=p&&($||H),M=k&&(d||!N);return e.jsxs("div",{className:"flex h-full w-full flex-col",children:[e.jsx(z,{children:e.jsx(qt,{})}),e.jsxs("div",{className:y("relative flex h-full w-full flex-1 overflow-hidden transition-colors",f!=="popover-nav"&&"z-0"),children:[e.jsxs("div",{className:"relative flex h-full w-full flex-row overflow-hidden",children:[e.jsx(ee,{initial:!1,children:M&&e.jsx(Da,{isPopoverOnDesktop:x||v&&!g,children:l?e.jsx(pn,{}):o()})}),e.jsxs("div",{className:"relative flex h-full max-w-full flex-1 flex-col overflow-hidden",children:[G&&e.jsxs(z,{children:[e.jsx(Xt,{}),e.jsx(Ua,{rightContentExpanded:n,onOpenSidebar:()=>I.toggleNavCollapsed(),showNavSidebar:k,leftContent:r,rightContent:i,bottomContent:c,children:a})]}),e.jsx("main",{className:"transition-width relative h-full w-full flex-1 overflow-auto",id:"main","z-index":"-1",children:w})]})]}),e.jsx(z,{children:e.jsx(_n,{isExpanded:te,children:u})}),C]}),e.jsx(z,{children:e.jsx(Kt,{useManuallyControlledVisibility:!0})}),v&&N&&!j&&e.jsx(Qt,{})]})}function Pn({children:s}){return e.jsx(e.Fragment,{children:s})}ds.Sidebars=Pn;export{Hn as C,Vn as F,sn as G,Wn as N,ds as S,Dn as a,Gn as b,on as c,nn as d,Un as e};
//# sourceMappingURL=hyae97tnl7ms3bn9.js.map
