import{ac as F,e as b,r as u,j as e,a8 as j,b as W,f as E,d as G,a9 as O}from"./khl8ktun31iepecq.js";import{bX as B,a as g,cV as $,cH as C,cQ as D,cS as V,f as q,bL as H,cT as X,dZ as z,d_ as K,cU as Q,m as J,dE as Z,cJ as Y,d7 as ee,cW as ae,o as S,V as se,aL as _,P as I,di as te,cK as M,cX as ne,F as re,E as oe,R as ie}from"./haannt40upmuwmtk.js";import{cb as le,dg as P,dh as ce,f as de,d3 as ue,aE as fe,di as me,dj as ge,dk as he,dl as xe,aq as pe}from"./n4exq6o15ap1g74l.js";function ke({className:a,children:t,position:n="center",size:s,removePopoverStyling:r=!1,shadow:i="normal"}){const o=F(),l=b(),d=Math.random()*40-20;return u.useEffect(()=>{o.start({x:0,y:0,rotate:0,opacity:1,transition:{type:"spring",duration:.6,bounce:.15}})},[o]),e.jsx(j.div,{initial:{x:0,y:"100%",rotate:0,opacity:1},animate:o,exit:{x:0,y:"100%",rotate:d,opacity:1},transition:{type:"spring",duration:.6,bounce:.15},className:g("z-50 h-full w-full overflow-y-auto",s!=="fullscreen"&&"grid grid-cols-[10px_1fr_10px]",s!=="fullscreen"&&n==="center"&&"grid-rows-[minmax(10px,1fr)_auto_minmax(10px,1fr)] md:grid-rows-[minmax(20px,1fr)_auto_minmax(20px,1fr)]",s!=="fullscreen"&&n==="bottom"&&"grid-rows-[minmax(10px,1fr)_auto_10px] md:grid-rows-[minmax(20px,1fr)_auto_20px]"),children:e.jsx($,{className:g(!r&&"popover","bg-token-sidebar-surface relative start-1/2 col-auto col-start-2 row-auto row-start-2 h-full w-full gap-4 p-4 text-start ltr:-translate-x-1/2 rtl:translate-x-1/2 dark:bg-[#171717]",s!=="fullscreen"&&"rounded-[36px]",i==="normal"&&"shadow-[0_32px_48px_rgba(0,0,0,0.175),_0_0_1px_rgba(0,0,0,0.2)] dark:shadow-[0_32px_48px_rgba(0,0,0,0.175),_0_0_1px_rgba(255,255,255,0.4)]",a),"aria-description":l.formatMessage({id:"slide-up-modal.share-sheet.description",defaultMessage:"Share sheet"}),"aria-describedby":"",children:t})})}const be=a=>{const{color:t="secondary",title:n,children:s,...r}=a;return e.jsx(C,{as:"button",color:t,...r,children:n??s})};function we({isOpen:a,onClose:t,children:n,shouldIgnoreClickOutside:s=!1,className:r}){return e.jsx(D,{open:a,onOpenChange:i=>{s||i===!1&&t(!1)},children:e.jsx(V,{container:q()?.document.body,children:e.jsx("div",{className:g("absolute inset-0",r),children:n})})})}function ve({className:a,children:t,showBackground:n=!0}){const s=H(),r=n?s?"rgba(0, 0, 0, 0.8)":"rgba(249,249,249,0.8)":"rgba(0, 0, 0, 0)";return e.jsx(X,{asChild:!0,children:e.jsx(j.div,{initial:{backdropFilter:"blur(0px)",backgroundColor:s?"rgba(0, 0, 0, 0)":"rgba(255, 255, 255, 0)"},animate:{backdropFilter:n?"blur(4px)":"blur(0px)",backgroundColor:r},exit:{backdropFilter:"blur(0px)",backgroundColor:s?"rgba(0, 0, 0, 0)":"rgba(255, 255, 255, 0)"},className:g("fixed inset-0 z-50",a),children:t})})}function N({title:a,description:t,icon:n,type:s}){return e.jsxs("div",{className:"flex max-w-full min-w-0 items-center",children:[e.jsx(ye,{icon:n,type:s}),e.jsxs("div",{className:"flex max-w-full min-w-0 grow flex-col gap-1",children:[a!=null&&e.jsx(z,{className:"text-token-text-primary text-3xl leading-6 font-semibold tracking-tight max-sm:text-xl",children:a}),t!=null&&e.jsx(K,{className:"text-token-text-tertiary text-sm",children:t})]})]})}function Me({title:a,accessory:t,description:n,withSeparator:s=!0,icon:r,type:i,closeButton:o,textCenter:l}){return!a&&!n?null:e.jsxs(L,{$hasSeparator:s,children:[e.jsx("div",{className:g("flex max-w-full",l&&"flex-1 justify-center text-center"),children:e.jsx(N,{title:a,description:n,icon:r,type:i})}),e.jsxs("div",{className:"flex items-center gap-5",children:[t,o!=null&&e.jsx(Q,{asChild:!0,className:"sm:mt-0",children:o})]})]})}function Se({primaryButton:a,secondaryButton:t,isSpacedBetween:n=!1,modalHasContent:s=!0,textCenter:r=!1}){return a==null&&t==null?null:e.jsxs("div",{className:g("flex flex-col gap-3 sm:flex-row-reverse",r&&"justify-center",n&&"justify-between",s?"mt-5 sm:mt-4":"mt-1"),children:[a,t]})}const ye=({type:a,icon:t})=>t==null?null:e.jsx("div",{className:g("me-4 flex h-12 w-12 shrink-0 items-center justify-center rounded-full sm:h-10 sm:w-10",a==="danger"&&"bg-red-100",a==="warning"&&"bg-yellow-100",a==="success"&&"bg-green-100"),children:e.jsx(t,{className:g("icon-lg",a==="danger"&&"text-red-600",a==="warning"&&"text-yellow-700",a==="success"&&"text-green-700"),"aria-hidden":"true"})}),L=B.div`px-4 pb-2 sm:p-6 flex items-center justify-between ${({$hasSeparator:a})=>a&&"border-b border-black/10 dark:border-white/10"}`,k={Root:we,Overlay:ve,Content:ke,Title:N,TitleBar:L,Header:Me,Actions:Se,Button:be},f=G({copyLink:{id:"postSharingModal.copyLink",defaultMessage:"Copy link"},linkCopied:{id:"postSharingModal.linkCopied",defaultMessage:"Link copied!"},failedToGenerateShareLink:{id:"postSharingModal.failedToGenerateShareLink",defaultMessage:"Failed to generate share link"},fromChatGPT:{id:"postSharingModal.fromChatGPT",defaultMessage:"From ChatGPT"},contentUnavailable:{id:"postSharingModal.contentUnavailable",defaultMessage:"Content Unavailable"},unavailableReasonGeneral:{id:"postSharingModal.unavailableReasonGeneral",defaultMessage:"This share link is not available because it doesn’t exist or you don’t have access to it."},unavailableReasonWorkspace:{id:"postSharingModal.unavailableReasonWorkspace",defaultMessage:"This content was shared from a workspace you don’t have access to. Ask the owner to invite you if you’d like to view it."},ok:{id:"postSharingModal.ok",defaultMessage:"OK"},shareLinkVisibleToWorkspaceOnly:{id:"postSharingModal.shareLinkVisibleToWorkspaceOnly",defaultMessage:"The share links are visible to workspace members only."}});function je(a){const t=a.findLast(n=>M.getImageAssetPointers(n).length>0);return t?M.getImageAssetPointers(t)[0]:null}function Ce({showLinkCopied:a,isGeneratingShareLink:t,onClick:n,postText:s}){const r=b(),i=_()?.isWorkspaceAccount();let o=[{id:"copy",icon:t?e.jsx(ne,{}):e.jsx(ue,{}),label:a?r.formatMessage(f.linkCopied):r.formatMessage(f.copyLink),action:"copy"}];return i?o.push({id:"download",icon:e.jsx(fe,{}),label:r.formatMessage({id:"postSharingModal.download",defaultMessage:"Download"}),action:"download"}):o=o.concat({id:"x",href:l=>`https://twitter.com/intent/tweet?url=${encodeURIComponent(l)}&text=${s?encodeURIComponent(s):""}`,icon:e.jsx(me,{initialFillColor:"var(--text-primary)"}),label:r.formatMessage({id:"postSharingModal.x",defaultMessage:"X"}),action:"share"},{id:"linkedin",href:l=>`https://www.linkedin.com/shareArticle?url=${encodeURIComponent(l)}&text=${s?encodeURIComponent(s):""}`,icon:e.jsx(ge,{initialFillColor:"var(--text-primary)"}),label:r.formatMessage({id:"postSharingModal.linkedin",defaultMessage:"LinkedIn"}),action:"share"},{id:"reddit",href:l=>`https://www.reddit.com/submit?url=${encodeURIComponent(l)}&title=${s?encodeURIComponent(s):""}`,icon:e.jsx(he,{initialFillColor:"var(--text-primary)"}),label:r.formatMessage({id:"postSharingModal.reddit",defaultMessage:"Reddit"}),action:"share"}),e.jsx(e.Fragment,{children:o.map(l=>e.jsxs("button",{onClick:()=>{n(l),I.logEventWithStatsig("Share Post: Social Clicked","chatgpt_post_share_link_social_clicked",{platform:l.id})},disabled:t,className:"relative flex flex-col gap-y-4 disabled:opacity-50 max-sm:gap-y-2",children:[e.jsx("div",{className:"shadow-token-border-default flex h-16 w-16 items-center justify-center rounded-full shadow-md max-sm:h-12 max-sm:w-12",children:e.jsx("div",{className:"pointer-events-none flex h-8 w-8 items-center justify-center max-sm:h-6 max-sm:w-6",children:l.icon})}),e.jsx("div",{className:"w-full text-center text-xs",children:l.label})]},l.id))})}async function _e(a,t,n){return P(t.asset_pointer)?(await ce(a,[t],null,void 0,n))[0]:null}const Ie=async(a,t,n)=>{const s=()=>re.findNode(oe(t),({message:o})=>o.id===n||!!M.getImageAssetPointers(o).find(l=>l.asset_pointer===a));let r=s();if(!r?.message&&(await de(t,!0),r=s(),!r?.message))return null;const i=S(t);return{postText:r.message.metadata?.image_gen_title,imageAssetPointer:je([r.message]),serverThreadId:i}};async function R(a,t,n,s){const r=P(t.asset_pointer);if(!r)return null;const i=await ie.safePost("/share/post",{requestBody:{post_text:n,attachments_to_create:[{kind:"image_share",file_id:r,conversation_id:a,width:s?.width,height:s?.height}]}});return xe(i.post.id)}function Pe({postSharingData:a,onCloseFinished:t}){const{clientThreadId:n,postText:s,imageAssetPointer:r,imageAsset:i}=a,o=u.useRef(void 0),[l,d]=u.useState(!1),[h,m]=u.useState(!1),c=b(),w=se(),[U,y]=u.useState(!0),T=_()?.isWorkspaceAccount();u.useEffect(()=>{I.logEventWithStatsig("Share Post: Post Sharing Modal Shown","chatgpt_post_share_modal_shown")},[]),u.useEffect(()=>{o.current=void 0},[n]);const v=S(n),A=async x=>{if(!(l||!v)&&v){if(!o.current){if(!r)return;d(!0);try{const p=await R(v,r,s,i);p&&(o.current=p)}catch{w.danger(c.formatMessage(f.failedToGenerateShareLink))}finally{d(!1)}}if(o.current){if(x.action==="copy")navigator.clipboard.writeText(o.current),m(!0),w.success(c.formatMessage(f.linkCopied)),setTimeout(()=>{m(!1)},3e3);else if(x.action==="share"&&x.href)window.open(x.href(o.current),"_blank","noopener,noreferrer");else if(x.action==="download"){if(!i?.url)return;pe({url:i.url,fileName:`${s}.png`})}}}};return e.jsx(O,{onExitComplete:t,children:U&&e.jsx(k.Root,{isOpen:!0,onClose:()=>{y(!1)},className:"max-w-[664px] px-4",children:e.jsx(k.Overlay,{showBackground:!0,children:e.jsxs(k.Content,{size:"normal",position:"center",className:g("flex flex-col pb-4 focus:outline-hidden",{"max-w-[640px]":"normal"==="normal"}),removePopoverStyling:!1,shadow:"normal",children:[e.jsx(k.Header,{title:s,type:"success",closeButton:e.jsx(te,{onClick:()=>y(!1)})}),e.jsxs("div",{children:[i?.url&&e.jsx("div",{className:"max-xs:max-h-[260px] flex h-[30vh] max-h-[550px] max-w-full justify-center rounded-xl max-sm:max-h-[300px]",children:e.jsx("img",{src:i?.url,alt:s})}),e.jsx("div",{className:"mt-12 flex flex-wrap justify-center space-y-4 space-x-12 max-sm:mt-6 max-sm:space-x-6",children:e.jsx(Ce,{showLinkCopied:h,isGeneratingShareLink:l,onClick:A,postText:s})}),T&&e.jsx("p",{className:"text-token-text-tertiary text-center text-sm sm:mt-4",children:c.formatMessage(f.shareLinkVisibleToWorkspaceOnly)})]})]})})})})}const Ne=u.createContext({postWithProfile:null});function Fe(){return!!u.useContext(Ne)?.postWithProfile}async function Le({postText:a,clientThreadId:t,imageAssetPointer:n,imageAsset:s,usePostText:r,useShareLink:i,useShareImage:o}){const l=S(t);if(!l)return!1;try{const d=await R(l,n,a,s);if(!d)return!1;const h=s.url,m=await fetch(h).then(c=>c.blob()).then(c=>new File([c],`${a}.png`,{type:"image/png"}));return!navigator.share||!navigator.canShare({files:[m]})?!1:(await navigator.share({text:r?a:void 0,url:i?d:void 0,files:o?[m]:void 0}),!0)}catch{return!1}}function We({assetPointer:a=null,clientThreadId:t,messageId:n}){const s=W(),r=J(),i=le();return u.useCallback(async()=>{const o=await Ie(a,t,n);if(!o?.imageAssetPointer||!o?.serverThreadId)return;const{postText:l,imageAssetPointer:d,serverThreadId:h}=o,m=await _e(s,d,h);if(m){if(i&&Z(r,"1138231213")){const c=Y(r,"2382399797");if(await Le({clientThreadId:t,postText:l,imageAssetPointer:d,imageAsset:m,usePostText:c.get("navigator_share_text",!1),useShareLink:c.get("navigator_share_link",!1),useShareImage:c.get("navigator_share_image",!1)}))return}ee(r,({closeModal:c})=>e.jsx(Pe,{postSharingData:{clientThreadId:t,postText:l,imageAssetPointer:d,imageAsset:m},onCloseFinished:()=>{c()}}))}},[a,t,n,s,i,r])}function Ee({closeModal:a,reason:t}){const n=b(),s=E(),r=()=>{a(),s("/")};let i=n.formatMessage(f.unavailableReasonGeneral);switch(t){case"general":i=n.formatMessage(f.unavailableReasonGeneral);break;case"workspace":i=n.formatMessage(f.unavailableReasonWorkspace);break}return e.jsx(ae,{testId:"modal-post-sharing-error",isOpen:!0,type:"danger",textCenter:!0,title:n.formatMessage(f.contentUnavailable),description:i,onClose:r,footerContent:e.jsx(C,{size:"large",color:"primary",className:"w-full",onClick:r,children:n.formatMessage(f.ok)})})}export{Ne as P,Ee as a,Fe as b,We as u};
//# sourceMappingURL=i7mohl0pdm5438yu.js.map
