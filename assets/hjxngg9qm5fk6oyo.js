import{j as e,d as le,r as m,M as c,L as Q,e as B,c as Le,u as Ee,b as oa,f as Ne,k as pt,h as ra,aq as ca}from"./khl8ktun31iepecq.js";import{P as p,cH as N,aU as da,aT as y,aL as He,am as H,a_ as ft,ae as Me,aq as Re,m as ua,V as Ce,R as Ye,hc as ma,cW as oe,cX as Te,cL as ht,gu as ga,dF as it,L as ie,g as pe,b as yt,l as xt,hd as We,e4 as Mt,e2 as bt,e5 as Ct,e1 as Pt,e0 as _t,aW as pa,eG as be,aA as St,cr as Se,he as fa,b5 as ha,aG as lt,D as vt,b_ as ya,hf as xa,a as Ma,fg as ot}from"./haannt40upmuwmtk.js";import{S as ba}from"./brlfaqq2l0eg9ucx.js";import{q7 as Ae,cX as w,q8 as Et,q9 as jt,qa as Ca,qb as $e,ha as Pa,jC as wt,qc as Pe,qd as Be,qe as Ve,qf as Ge,jA as _a,hd as Sa,jE as kt,qg as Tt,om as va,qh as ke,qi as De,qj as ze,qk as Ea,ql as te,qm as ja,qn as Nt,qo as At,qp as wa,qq as ka,qr as Ta,qs as Na,qt as Ft,a5 as Aa,bw as Fa,qu as It,qv as Ia,qw as Oa,qx as Ua,aF as Da,qy as La,af as Ra,qz as Wa,lN as Ba,bx as Va,qA as Ga,qB as qa,qC as Ha}from"./n4exq6o15ap1g74l.js";import{I as Ot}from"./kkvepmv0ij3dcl10.js";import{C as rt}from"./oydd1gbwtq1785c3.js";function Ya({value:t,onChange:a}){return e.jsx(ba,{value:t,onChange:a,ariaLabel:je.toggleArialabel,leftItem:{ariaLabel:je.togglePersonalArialabel,label:je.togglePersonalLabel,value:"personal"},rightItem:{ariaLabel:je.toggleBusinessArialabel,label:je.toggleBusinessLabel,value:"business"}})}const je=le({toggleArialabel:{id:"U4v2Gf",defaultMessage:"Toggle for switching between Personal and Business plans"},togglePersonalArialabel:{id:"6Wikht",defaultMessage:"Toggle for switching to Personal plans"},toggleBusinessArialabel:{id:"uzlEV0",defaultMessage:"Toggle for switching to Business plans"},togglePersonalLabel:{id:"cGDsaD",defaultMessage:"Personal"},toggleBusinessLabel:{id:"sgisa2",defaultMessage:"Business"}}),Ut=t=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 19C6.44772 19 6 18.5523 6 18C6 16.3077 6.81186 15.0179 7.98298 14.1851C9.12436 13.3734 10.5892 13 12 13C13.4108 13 14.8756 13.3734 16.017 14.1851C17.1881 15.0178 18 16.3076 18 18C18 18.5523 17.5523 19 17 19C15.6012 19 8.39878 19 7 19Z",fill:"currentColor"}),m.createElement("path",{d:"M19.5 18C19.5 18 19.5 18 19.5 18C19.5 16.0565 18.6712 14.498 17.4529 13.4137C18.0999 13.1329 18.8086 13 19.5 13C20.5581 13 21.6567 13.3112 22.5128 13.9875C23.3911 14.6815 24 15.7564 24 17.1667C24 17.6269 23.6642 18 23.25 18H19.5Z",fill:"currentColor"}),m.createElement("path",{d:"M6.54712 13.4137C5.32885 14.498 4.5 16.0564 4.5 18C4.5 18 4.5 18 4.5 18L0.75 18C0.335786 18 0 17.6269 0 17.1667C0 15.7564 0.608892 14.6815 1.48723 13.9875C2.34327 13.3112 3.44193 13 4.5 13C5.19138 13 5.90009 13.1329 6.54712 13.4137Z",fill:"currentColor"}),m.createElement("path",{d:"M12 5C10.067 5 8.5 6.567 8.5 8.5C8.5 10.433 10.067 12 12 12C13.933 12 15.5 10.433 15.5 8.5C15.5 6.567 13.933 5 12 5Z",fill:"currentColor"}),m.createElement("path",{d:"M4.5 7C3.11929 7 2 8.11929 2 9.5C2 10.8807 3.11929 12 4.5 12C5.88071 12 7 10.8807 7 9.5C7 8.11929 5.88071 7 4.5 7Z",fill:"currentColor"}),m.createElement("path",{d:"M19.5 7C18.1193 7 17 8.11929 17 9.5C17 10.8807 18.1193 12 19.5 12C20.8807 12 22 10.8807 22 9.5C22 8.11929 20.8807 7 19.5 7Z",fill:"currentColor"})),Ze=()=>{p.logEvent("Account Portal: Click Get Help")};function $a(t){if(da(t))return"secondary";switch(t){case y.FREE:return"green";case y.PLUS:return"green";case y.TEAM:return"primary";case y.PRO:return"primary";default:throw new Error(`Invalid plan type: ${t}`)}}function ve({isCurrentPlan:t,planType:a,disabled:s,loading:i=!1,onClick:l,children:o,testId:n,activeColor:u,...g}){return e.jsx(N,{fullWidth:!0,size:"large",color:t?"secondary":u||$a(a),disabled:s,loading:i,onClick:l,"data-testid":n,className:s?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary border-none font-semibold":"font-semibold",...g,children:o})}function Ke(t,a){const[s,i]=m.useState(!1);m.useEffect(()=>{if(!s){i(!0);return}t?p.logEventWithStatsig("Email Verify Popup Shown","chatgpt_email_verify_popup_shown",a):p.logEventWithStatsig("Email Verify Popup Hidden","chatgpt_email_verify_popup_hidden",a)},[t])}const ct=y.ENTERPRISE,za=({enterprisePricingPlanProduce:t,billingDetails:a})=>{const i=He()?.isEnterprisey();return e.jsx(Ae,{icon:e.jsx(Ut,{className:"icon-md text-brand-purple"}),planName:"enterprise",pricingPlan:t,showForLine:!0,callToActionButton:i?e.jsx(N,{color:"secondary",disabled:!0,size:"large",className:"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold",children:e.jsx(c,{...w.free.callToAction.inactive})}):e.jsx(ve,{planType:ct,as:"link",to:Et,openNewTab:!0,onClick:()=>{p.logEvent("Account Pay: Click Enterprise Contact Sales Button"),H.logEvent("chatgpt_account_payment_modal_enterprise_sales_button_clicked",ct)},isCurrentPlan:!1,testId:"select-plan-button-enterprise",children:e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(c,{...w.enterprise.callToAction.inactive})})}),billingDetails:a})},Za=t=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M12.001 1.75C12.4972 1.75051 12.9141 2.12323 12.97 2.61632C13.2763 5.32075 14.096 7.2769 15.4108 8.61588C16.7197 9.9489 18.6326 10.7853 21.3602 11.0276C21.8643 11.0724 22.2506 11.495 22.25 12.0011C22.2494 12.5072 21.8622 12.9289 21.358 12.9726C18.6758 13.2047 16.7215 14.0404 15.381 15.381C14.0404 16.7215 13.2047 18.6758 12.9726 21.358C12.9289 21.8622 12.5072 22.2494 12.0011 22.25C11.495 22.2506 11.0724 21.8643 11.0276 21.3602C10.7853 18.6326 9.9489 16.7197 8.61588 15.4108C7.2769 14.096 5.32075 13.2763 2.61632 12.97C2.12323 12.9141 1.75051 12.4972 1.75 12.001C1.74949 11.5048 2.12137 11.0871 2.61434 11.0302C5.36466 10.713 7.27893 9.89303 8.58598 8.58598C9.89303 7.27893 10.713 5.36466 11.0302 2.61434C11.0871 2.12137 11.5048 1.74949 12.001 1.75Z",fill:"currentColor"})),Ka=({billingDetails:t})=>{const{data:a}=ft(),s=jt(a),i=Ca();return e.jsx(Ae,{planName:"free",pricingPlan:i,icon:e.jsx(Za,{className:"icon-md"}),showForLine:!s,callToActionButton:e.jsx(N,{color:"secondary",disabled:!0,size:"large",className:"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold",children:e.jsx(c,{...w.free.callToAction.inactive})}),additionalLinks:[e.jsx(c,{...Xa.haveExistingPlan,values:{link:l=>e.jsx(Q,{target:"_blank",to:$e,onClick:Ze,className:"underline",children:l},"row-plus-plan-help-link")}},"existing-plan-help")],billingDetails:t})},Xa=le({haveExistingPlan:{id:"FreeColumn.haveExistingPlan",defaultMessage:"Have an existing plan? See <link>billing help</link>"}}),Qa=t=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{d:"M6.394 4.444c.188-.592 1.024-.592 1.212 0C8.4 8.9 9.1 9.6 13.556 10.394c.592.188.592 1.024 0 1.212C9.1 12.4 8.4 13.1 7.606 17.556c-.188.592-1.024.592-1.212 0C5.6 13.1 4.9 12.4.444 11.606c-.592-.188-.592-1.024 0-1.212C4.9 9.6 5.6 8.9 6.394 4.444Zm8.716 9.841a.41.41 0 0 1 .78 0c.51 2.865.96 3.315 3.825 3.826.38.12.38.658 0 .778-2.865.511-3.315.961-3.826 3.826a.408.408 0 0 1-.778 0c-.511-2.865-.961-3.315-3.826-3.826a.408.408 0 0 1 0-.778c2.865-.511 3.315-.961 3.826-3.826Zm2.457-12.968a.454.454 0 0 1 .866 0C19 4.5 19.5 5 22.683 5.567a.454.454 0 0 1 0 .866C19.5 7 19 7.5 18.433 10.683a.454.454 0 0 1-.866 0C17 7.5 16.5 7 13.317 6.433a.454.454 0 0 1 0-.866C16.5 5 17 4.5 17.567 1.317Z",fill:"currentColor"})),Y=le({sendEmailFailure:{id:"emailVerify.sendEmailFailure",defaultMessage:"Could not send email verification code, please try again later."},sendEmailFailureInvalidEmail:{id:"emailVerify.invalidEmail",defaultMessage:'The email address "{email}" is not formatted correctly.'},sendEmailFailureInvalidEmailEmpty:{id:"emailVerify.invalidEmailEmpty",defaultMessage:"Please enter a valid email address to continue."},sendEmailFailureRateLimited:{id:"emailVerify.sendEmailFailure.rateLimited",defaultMessage:"You've sent too many requests. Please try again later."},verifyOtpFailure:{id:"emailVerify.verifyOtpFailure",defaultMessage:"Something went wrong, please try again later."},verifyOtpFailureInvalidOtp:{id:"emailVerify.verifyOtpFailure.invalidOtp",defaultMessage:"The code you entered is invalid. Please try again."},verifyOtpFailureInvalidFormat:{id:"emailVerify.verifyOtpFailure.invalidFormat",defaultMessage:"The code you entered is formatted incorrectly."},verifyOtpFailureEmailAlreadyLinked:{id:"emailVerify.verifyOtpFailure.emailAlreadyLinked",defaultMessage:'{branch, select, email {"{emailValue}"} other {Your email}} is already linked to another account.'},verifyOtpFailureRateLimited:{id:"emailVerify.verifyOtpFailure.rateLimited",defaultMessage:"You've sent too many requests. Please try again later."},verifyOtpSuccess:{id:"emailVerify.verifyOtpSuccess",defaultMessage:"Email confirmed."}});class dt extends Error{constructor(a){super(a),this.name="EmailValidationError"}}const Ja=(t,a)=>a.trim()===""?t.formatMessage(Y.sendEmailFailureInvalidEmailEmpty):/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)?null:t.formatMessage(Y.sendEmailFailureInvalidEmail,{email:a}),Dt=(t,a,s)=>{switch(s.status){case 429:throw new Error(t.formatMessage(Y.sendEmailFailureRateLimited));case 403:throw new Error(t.formatMessage(Y.verifyOtpFailureEmailAlreadyLinked,{branch:a?"email":"other",emailValue:a}));default:return}};function es(t){const a=B(),[s,i]=m.useState(null),l=Le({mutationFn:async o=>{try{const n=Ja(a,o);if(n)throw new dt(n);return await Me.addEmailBegin(o)}catch(n){throw n instanceof dt?n:(n instanceof Re&&Dt(a,o,n),new Error(a.formatMessage(Y.sendEmailFailure)))}},onSuccess:()=>{t.setStep("verifyOtp")},onError:o=>{i(o.message),p.logEventWithStatsig("Email Verify Enter Email Step - Error Sending Verification Email","chatgpt_email_verify_enter_email_step_error",{error:o.message})}});return m.useEffect(()=>{p.logEventWithStatsig("Email Verify Enter Email Step - Shown","chatgpt_email_verify_enter_email_step_shown")},[]),e.jsx("form",{onSubmit:o=>{o.preventDefault(),l.mutate(t.email),p.logEventWithStatsig("Email Verify Enter Email Step - Attempted Continue","chatgpt_email_verify_enter_email_step_continue")},noValidate:!0,children:e.jsxs("div",{className:"flex w-full flex-col items-center gap-3",children:[e.jsx("p",{className:"text-3xl font-semibold",children:t.title?t.title:e.jsx(c,{id:"emailVerify.enterEmailTitle",defaultMessage:"Add your email"})}),t.description&&e.jsx("p",{className:"text-token-text-primary text-center text-base",children:t.description}),e.jsx(Ot,{ariaLabel:a.formatMessage({id:"emailVerify.emailAddress",defaultMessage:"Email Address"}),placeholder:a.formatMessage({id:"emailVerify.emailAddressPlaceholder",defaultMessage:"Email Address"}),name:"email",type:"email",className:"mt-6 w-full",value:t.email,onChange:o=>{i(null),t.onEmailChange(o.target.value),p.logEventWithStatsig("Email Verify Enter Email Step - Typed","chatgpt_email_verify_enter_email_step_type")},autoFocus:!0,autoComplete:"email",error:s??void 0}),e.jsx(N,{className:"w-full rounded-md",color:"green",type:"submit",loading:l.isPending,disabled:l.isPending,children:e.jsx(c,{id:"emailVerify.continue",defaultMessage:"Continue"})}),t.cancelFlowButton]})})}class ut extends Error{constructor(a){super(a),this.name="OtpValidationError"}}const ts=(t,a)=>{if(a.length!==6)return t.formatMessage(Y.verifyOtpFailureInvalidFormat);try{parseInt(a)}catch{return t.formatMessage(Y.verifyOtpFailureInvalidFormat)}return null},as=(t,a,s)=>{switch(s.status){case 403:throw new Error(t.formatMessage(Y.verifyOtpFailureEmailAlreadyLinked,{branch:a?"email":"other",emailValue:a}));case 429:throw new Error(t.formatMessage(Y.verifyOtpFailureRateLimited));case 422:throw new Error(t.formatMessage(Y.verifyOtpFailureInvalidOtp));default:return}};function ss(t){const a=ua(),s=B(),i=Ce(),[l,o]=m.useState(null),n=m.useCallback(d=>{const r=d.target.value.trim();if(typeof r=="string"){if(r.match(/\D/)){d.preventDefault();return}t.onOtpChange(r.substring(0,6))}},[t]),u=Le({mutationFn:async d=>{try{return await Me.addEmailBegin(d)}catch(r){throw r instanceof Re&&Dt(s,d,r),new Error(s.formatMessage(Y.sendEmailFailure))}},onSuccess:()=>{t.setStep("verifyOtp")},onError:d=>{o(d.message),p.logEventWithStatsig("Email Verify Verify OTP Step - Error Resending OTP","chatgpt_email_verify_verify_otp_step_resend_error",{error:d.message})}}),g=Le({mutationFn:async d=>{try{const r=ts(s,d.code);if(r)throw new ut(r);await Ye.safePost("/accounts/add_email/verify",{requestBody:d}),await ma(a)}catch(r){throw r instanceof ut?r:(r instanceof Re&&as(s,t.email,r),new Error(s.formatMessage(Y.verifyOtpFailure)))}},onSuccess:()=>{i.success(s.formatMessage(Y.verifyOtpSuccess)),t.onVerified?.()},onError:d=>{o(d.message),p.logEventWithStatsig("Email Verify Verify OTP Step - Error Verifying OTP","chatgpt_email_verify_verify_otp_step_error",{error:d.message})}});return m.useEffect(()=>{p.logEventWithStatsig("Email Verify Verify OTP Step - Shown","chatgpt_email_verify_verify_otp_step_shown")},[]),e.jsxs("div",{className:"flex w-full flex-col items-center gap-3",children:[e.jsx("p",{className:"text-3xl font-semibold",children:e.jsx(c,{id:"verifyOtp.title",defaultMessage:"Check your email"})}),e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"text-token-text-primary text-base",children:e.jsx(c,{id:"verifyOtp.description",defaultMessage:"Enter the verification code we just sent to"})}),t.email&&e.jsx("br",{}),e.jsx("span",{className:`text-token-text-primary text-base leading-snug ${t.email&&"font-semibold"}`,children:e.jsx(c,{id:"verifyOtp.email",defaultMessage:"{branch, select, email {{emailValue}} other { your email.}}",values:{branch:t.email?"email":"other",emailValue:t.email}})})]}),e.jsxs("form",{onSubmit:d=>{d.preventDefault(),g.mutate({code:t.otp,email:t.email??""}),p.logEventWithStatsig("Email Verify Verify OTP Step - Attempted Continue","chatgpt_email_verify_verify_otp_step_continue")},className:"flex w-full flex-col items-center gap-3",children:[e.jsx(Ot,{error:l??void 0,ariaLabel:s.formatMessage({id:"emailVerify.otpAriaLabel",defaultMessage:"OTP"}),value:t.otp,onChange:d=>{o(null),n(d),p.logEventWithStatsig("Email Verify Verify OTP Step - Typed","chatgpt_email_verify_verify_otp_step_type")},name:"otp",type:"text",placeholder:"XXXXXX",className:"mt-6 w-full",autoComplete:"off",autoFocus:!0}),e.jsx(N,{className:"w-full rounded-md",color:"green",type:"submit",loading:g.isPending,disabled:g.isPending,children:e.jsx(c,{id:"verifyOtp.continue",defaultMessage:"Continue"})}),t.cancelFlowButton]}),e.jsxs("div",{className:"mt-6 flex w-full flex-col items-center gap-3",children:[e.jsx("p",{className:"text-token-text-primary text-sm",children:e.jsx(c,{id:"verifyOtp.resendMessage",defaultMessage:"Didn’t receive the code?"})}),e.jsx(N,{className:"w-full rounded-md",color:"secondary",onClick:()=>{u.mutate(t.email??""),p.logEventWithStatsig("Email Verify Verify OTP Step - Resend","chatgpt_email_verify_verify_otp_step_resend")},loading:u.isPending,disabled:u.isPending,children:e.jsx(c,{id:"verifyOtp.resend",defaultMessage:"Resend code"})}),e.jsx(N,{className:"w-full rounded-md",color:"secondary",onClick:()=>{t.setStep("enterEmail"),p.logEventWithStatsig("Email Verify Verify OTP Step - Back to Enter Email Step","chatgpt_email_verify_verify_otp_step_change_email")},children:e.jsx(c,{id:"verifyOtp.changeEmail",defaultMessage:"Change email"})})]})]})}function Xe(t){const[a,s]=m.useState(t.initialStep??"enterEmail"),[i,l]=m.useState(""),[o,n]=m.useState(""),u=t.email?{email:t.email,onEmailChange:t.onEmailChange}:{email:i,onEmailChange:l},g=t.otp?{otp:t.otp,onOtpChange:t.onOtpChange}:{otp:o,onOtpChange:n};return a==="enterEmail"?e.jsx(es,{title:t.enterEmailTitle,description:t.enterEmailDescription,cancelFlowButton:t.cancelFlowButton,step:a,setStep:s,...u}):e.jsx(ss,{email:u.email,onVerified:t.onVerified,cancelFlowButton:t.cancelFlowButton,step:a,setStep:s,...g})}const ns=y.PLUS;function is({isOpen:t,onClose:a,onCancelationComplete:s,analyticsParams:i}){const l=B(),o=Ce(),n=He(),{data:u,isLoading:g}=Pa(),d=wt(n?.id),r=m.useMemo(()=>({...i,planType:ns}),[i]),h=m.useCallback(()=>{a(),d.isSuccess||p.logEventWithStatsig("Cancel Plus: Closed cancel modal without cancellation","cancel_plus_modal_abort",r)},[a,d.isSuccess,r]),f=async()=>{if(!n)throw new Error("No account!");p.logEventWithStatsig("Cancel Plus: Clicked button to cancel plan","cancel_plus_modal_confirm",r),await d.mutateAsync(n?.id,{onError:()=>{o.danger(l.formatMessage(W.cancelFailure),{duration:2}),p.logEventWithStatsig("Cancel Plus: Something errored while cancelling","cancel_plus_modal_error",r)},onSuccess:()=>{p.logEventWithStatsig("Cancel Plus: Request to cancel was successful","cancel_plus_modal_success",r),s?.(),o.info(l.formatMessage(W.cancelSuccess),{duration:2}),a()}})};m.useEffect(()=>{d.isSuccess},[d.isSuccess,a]);const M=u?.active_until;return e.jsx(oe,{testId:"modal-cancel-plus",type:"success",onClose:h,isOpen:t,className:"",title:e.jsx(c,{...W.cancelPlan}),children:g||!n?e.jsx(Te,{}):d.isSuccess?e.jsx(c,{...W.cancelSuccess}):e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm",children:[!!M&&e.jsx("p",{className:"mb-4",children:e.jsx(c,{...W.planActiveUntil,values:{expirationDate:new Date(M)}})}),e.jsx("p",{className:"mb-2",children:e.jsx(c,{...W.cancelListHeader})}),e.jsx("div",{children:rs.map(P=>e.jsxs("div",{className:"text-l mb-2 flex justify-start gap-2",children:[e.jsx(ht,{className:"h-5 w-5 shrink-0 align-top text-gray-500"}),e.jsx("span",{children:e.jsx(c,{...P,values:{learnMoreLink:ls,mainModel:os}})})]},P.id))})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(N,{onClick:h,color:"secondary",children:e.jsx(c,{...W.closeModal})}),e.jsx(N,{color:"danger",onClick:f,disabled:d.isPending||d.isSuccess,children:e.jsx(c,{...d.isPending?W.cancellingInProgress:W.cancelButton})})]})]})})}const ls=t=>e.jsx("a",{target:"_blank",href:"https://help.openai.com/en/articles/9280126-what-happens-to-my-gpts-if-i-cancel-my-subscription",rel:"noreferrer",className:"underline",children:t}),os="GPT-4",W=le({cancelPlan:{id:"cancelPlusModal.cancelPlan",defaultMessage:"Cancel your Plus subscription?"},cancelListHeader:{id:"cancelPlusModal.cancelText",defaultMessage:"When your subscription ends, you'll no longer have:"},planActiveUntil:{id:"cancelPlusModal.planActiveUntil",defaultMessage:"If you cancel your subscription, you’ll be downgraded to the free plan on {expirationDate, date, long}."},cancelButton:{id:"cancelPlusModal.cancelButton",defaultMessage:"Cancel subscription"},cancellingInProgress:{id:"cancelPlusModal.cancellingInProgress",defaultMessage:"Cancelling..."},cancelSuccess:{id:"cancelPlusModal.cancelSuccess",defaultMessage:"Successfully cancelled your plan. Sorry to see you go!"},cancelFailure:{id:"cancelPlusModal.cancelFailure",defaultMessage:"Something went wrong while cancelling your plan. Please reach out to support"},lostFeatureGPTModels:{id:"0w7d5w",defaultMessage:"Access to {mainModel} and {liteModel}"},lostFeatureGPTModelSingular:{id:"cancelPlusModal.lostFeature.gptModelSingular",defaultMessage:"Access to {mainModel}"},lostFeatureNewModelUsageLimits:{id:"TjftEV",defaultMessage:"Higher usage limits for {limitedModel}"},lostFeatureDataAnalysisV2:{id:"cancelPlusModal.lostFeature.dataAnalysisV2",defaultMessage:"Access to advanced data analysis, file uploads, vision, and web browsing"},lostFeatureDataAnalysisLimits:{id:"dlGufV",defaultMessage:"Higher usage limits for advanced data analysis, file uploads, vision, and web browsing"},lostFeatureImageGeneration:{id:"cancelPlusModal.lostFeature.imageGeneration",defaultMessage:"DALL·E image generation"},lostFeatureCustomGPTs:{id:"cancelPlusModal.lostFeature.customGPTs",defaultMessage:"Custom GPT creation"},lostFeaturePersonalGPTs:{id:"cancelPlusModal.lostFeature.personalGPTs",defaultMessage:"GPTs you’ve created (<learnMoreLink>learn more</learnMoreLink>)"},closeModal:{id:"cancelPlusModal.close",defaultMessage:"Close"}}),rs=[W.lostFeatureGPTModelSingular,W.lostFeatureDataAnalysisV2,W.lostFeatureImageGeneration,W.lostFeatureCustomGPTs,W.lostFeaturePersonalGPTs];function Lt({isOpen:t,onClose:a,onContinue:s,analyticsParams:i}){m.useEffect(()=>{t&&p.logEventWithStatsig("Mobile Subscription Warning Modal Shown","chatgpt_mobile_subscription_warning_modal_shown",i)},[i,t]);const l=()=>{p.logEventWithStatsig("Mobile Subscription Warning Modal Continue Clicked","chatgpt_mobile_subscription_warning_modal_continue_clicked",i),s()},o=()=>{p.logEventWithStatsig("Mobile Subscription Warning Modal Close Clicked","chatgpt_mobile_subscription_warning_modal_close_clicked",i),a()};return e.jsx(oe,{testId:"modal-mobile-subscription-warning",isOpen:t,onClose:o,type:"warning",icon:ga,title:e.jsx(c,{...Fe.checkSubscriptionHeader}),primaryButton:e.jsx(it.Button,{title:Fe.dismissModal.defaultMessage,color:"primary",onClick:o}),secondaryButton:e.jsx(it.Button,{title:Fe.continueToNextStep.defaultMessage,color:"secondary",onClick:l}),children:e.jsx("span",{className:"gap-2 text-gray-600",children:Fe.checkSubscriptionBody.defaultMessage})})}const Fe=le({checkSubscriptionHeader:{id:"mobileSubscriptionWarningModal.checkSubscriptionHeader",defaultMessage:"Check your App Store subscription"},checkSubscriptionBody:{id:"mobileSubscriptionWarningModal.checkSubscriptionBody",defaultMessage:"Your subscription through the Apple App Store is currently on pause due to a payment issue. Please resolve that issue to resume using ChatGPT Plus and avoid duplicate charges."},dismissModal:{id:"mobileSubscriptionWarningModal.dismissModal",defaultMessage:"Cancel"},continueToNextStep:{id:"mobileSubscriptionWarningModal.continueToNextStep",defaultMessage:"I understand, continue anyways"}}),cs=ie.HasDismissedUpgradeInviteModal,ds={hasDismissedUpgradeInviteModal:!!pe.getItem(cs)};yt()(()=>({...ds}));const us=()=>{const{isUnauthenticated:t,isLoading:a}=xt();return Ee({queryKey:["updateInvites",t],queryFn:async()=>t?{plus:null,team:null}:await Me.getUpgradeInvites(),enabled:!a})},mt=le({plusWaitlistSignupSuccess:{id:"pricingPlanConstants.plusWaitlistSignupSuccess",defaultMessage:"You've been added to the waitlist to upgrade to Plus"},teamWaitlistSignupSuccess:{id:"pricingPlanConstants.teamWaitlistSignupSuccess",defaultMessage:"You've been added to the waitlist to upgrade to Team"}}),ms={[y.PLUS]:{localStorageKeyByVersion:{V1:ie.HasSignedUpForPlusUpgradeWaitlistV1,V2:ie.HasSignedUpForPlusUpgradeWaitlistV2},onSuccessMessage:mt.plusWaitlistSignupSuccess},[y.TEAM]:{localStorageKeyByVersion:{V1:ie.HasSignedUpForTeamUpgradeWaitlistV1,V2:ie.HasSignedUpForTeamUpgradeWaitlistV2},onSuccessMessage:mt.teamWaitlistSignupSuccess}},Rt=t=>{const a=B(),s=Ce(),{localStorageKeyByVersion:i,onSuccessMessage:l}=ms[t],o=i.V1,n=i.V2,[u]=m.useState(!!pe.getItem(o)),[g,d]=m.useState(!!pe.getItem(n)),{data:r}=us(),h=()=>{d(!0),pe.setItem(n,!0),s.success(a.formatMessage(l),{hasCloseButton:!0,duration:5}),p.logEvent("Upgrade Plan Waitlist Signup",{plan:t})};return{hasSignedUpForWaitlist:u||g,isEligibleToUpgrade:!!r?.plus||u,signUpForWaitlist:h}};function qs(t,a,s,i){let l,o;i===Mt?(l=Ve,o=bt):i===Ct?(l=Ge,o=Pt):(l=Be,o=_t);const n=l*a;let u;if("percentage"in s)u=n*(1-s.percentage/100);else if("value"in s)u=n-s.value;else throw new Error("Invalid discount type");return{formattedDiscountedCost:t.formatNumber(u,{style:"currency",currency:i,minimumFractionDigits:0,maximumFractionDigits:2}),currencySymbol:o}}function Wt(t,a,s,i){let l={...a},o;if(i&&(i.period==="year"?i.num_periods===1?o=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForSingleYear",defaultMessage:"for the first year"}):o=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForPluralYears",defaultMessage:"for the first {num_years} years"},{num_years:i.num_periods}):i.num_periods===1?o=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForSingleMonth",defaultMessage:"for the first month"}):o=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForPluralMonths",defaultMessage:"for the first {num_months} months"},{num_months:i.num_periods})),l.costDuration={id:"promoCostDuration",defaultMessage:o,description:"Cost duration for promo plan"},"percentage"in s||"discount_type"in s&&s.discount_type===We.PERCENTAGE){const n=("percentage"in s?s.percentage:s.amount)/100;l.costInDollars={id:"discountedCost",defaultMessage:Pe((1-n)*Be).toString()},l.costInEuros={id:"discountedCostEuros",defaultMessage:Pe((1-n)*Ve).toString()},l.costInPounds={id:"discountedCostPounds",defaultMessage:Pe((1-n)*Ge).toString()}}else if("value"in s||s.discount_type===We.FIXED){const n="value"in s?s.value:s.amount;l.costInDollars={id:"discountedCost",defaultMessage:Pe(Be-n).toString()},l.costInEuros={id:"discountedCostEuros",defaultMessage:Pe(Ve-n).toString()},l.costInPounds={id:"discountedCostPounds",defaultMessage:Pe(Ge-n).toString()}}return l}const Qe=yt(t=>({recentlyDowngraded:!1,recentlyUpgraded:!1,recentlyCanceled:!1,setRecentlyDowngraded:a=>t({recentlyDowngraded:a}),setRecentlyUpgraded:a=>t({recentlyUpgraded:a}),setRecentlyCanceled:a=>t({recentlyCanceled:a})}));function Bt(t){switch(t){case y.FREE:return"chatgptfreeplan";case y.PLUS:return"chatgptplusplan";case y.PRO:return"chatgptpro";case y.TEAM:return"chatgptteamplan";default:throw new Error(`Invalid plan type: ${t}`)}}function Vt({isOpen:t,onClose:a,accountId:s,initialPlanType:i,updatedPlanType:l,billingDetails:o}){const n=B(),u=Ce(),g=pa(),[d,r]=m.useState(!1),h=i===l,f=i===y.PLUS&&l===y.PRO,M=Bt(l);m.useEffect(()=>{p.logTogglePlanManagementModal({isOpen:!0})},[]);const P=()=>{p.logTogglePlanManagementModal({isOpen:!1}),a()},$=_a(s),z=Sa(s),Z=wt(s),{data:k,isError:E,isLoading:D}=kt(s,void 0,M);!h&&E&&(g?.planType===y.TEAM?u.warning(n.formatMessage({id:"planManagement.errorUpgradingTeam",defaultMessage:"Updates to Pro aren't yet supported for users with Team subscriptions"}),{hasCloseButton:!0}):u.warning(n.formatMessage({id:"planManagement.errorFetchingPreview",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0}),a());const A=C=>{const L=Tt(new Date,C);return new Intl.DateTimeFormat(n.locale,{year:"numeric",month:"short",day:"numeric"}).format(L)},F=g?.getDaysUntilPlanRenews(),b=F?A(F):"",{recentlyCanceled:I,setRecentlyUpgraded:O,setRecentlyDowngraded:re}=Qe(),_=g?.willRenewSubscription()||I,[ce,J]=m.useState(!1),de=oa();if(!g)return null;const X=async C=>{r(!0);try{if(h)await z.mutateAsync(s),u.success(b===""?n.formatMessage({id:"planManagement.successfullyRenewedSubscription2",defaultMessage:"Your subscription has been renewed."}):n.formatMessage({id:"planManagement.successfullyRenewedSubscription",defaultMessage:"Your subscription has been renewed. Your subscription will auto-renew on {renewalDate}."},{renewalDate:b}),{hasCloseButton:!0}),p.logEvent("Renew Plan Success",{planType:C}),H.logEvent("chatgpt_renew_plan_success",null,{planType:C});else{if(_||(await z.mutateAsync(s),J(!0)),await $.mutateAsync({accountId:s,updatedPlan:M,updatedPriceInterval:void 0,updatedSeats:void 0}),C!==l){const ee=f?"Upgrade Plan Success":"Downgrade Plan Success",ae=f?"chatgpt_upgrade_plan_success":"chatgpt_downgrade_plan_success";p.logEvent(ee,{fromPlan:C,toPlan:l}),H.logEvent(ae,null,{fromPlan:C,toPlan:l}),f?O(!0):re(!0)}const ue=k?.renewal_date?new Date(k?.renewal_date).toLocaleDateString(n.locale,{year:"numeric",month:"long",day:"numeric"}):"N/A",U=f?n.formatMessage({id:"planManagement.successfullyUpdatedSubscription",defaultMessage:"You're now subscribed to ChatGPT Pro"}):n.formatMessage({id:"planManagement.updatedSubscriptionToPlus",defaultMessage:"Your subscription has been updated. Your subscription will change to Plus on {renewalDateFormatted}."},{renewalDateFormatted:ue});localStorage.setItem(`subscriptionUpdateMessage_${g.id}`,U)}de.invalidateQueries({queryKey:["account-status"]});const L=pe.getItem(ie.CheckoutFrom);L&&rt[L]&&(pe.removeItem(ie.CheckoutFrom),window.location.href=rt[L]),a()}catch(L){L?.detail?.error_type==="card_declined"?u.warning(n.formatMessage({id:"planManagement.cardDeclinedError",defaultMessage:"Payment error. Your card may be invalid or authentication may be needed."}),{hasCloseButton:!0}):u.warning(n.formatMessage({id:"planManagement.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0}),ce&&await Z.mutateAsync(s),a()}finally{r(!1)}},[V,G,T]=Cs(o.currency);return e.jsx(oe,{testId:"modal-plan-management",type:"success",isOpen:t,onClose:P,size:"custom",noPadding:!0,className:"max-w-xl",showCloseButton:!0,title:n.formatMessage({id:"planManagementModal.title",defaultMessage:"Confirm changes"}),removePopoverStyling:!0,children:D?e.jsx(Gt,{}):h&&g?e.jsx(bs,{account:g,renewalDate:b,handleUpdate:()=>X(i),isUpdating:d,onClose:P,plusCost:V,proCost:G,currencySymbol:T}):E||!k?null:f?e.jsx(ps,{accountId:s,handleUpdate:()=>X(i),isUpdating:d,onClose:P,currencySymbol:T}):e.jsx(Ms,{renewalDate:k.renewal_date,handleUpdate:()=>X(i),isUpdating:d,onClose:P,plusCost:V,currencySymbol:T})})}function Gt(){return e.jsx("div",{className:"flex items-center justify-center p-6",children:e.jsx(Te,{})})}function gs({adjustmentMessage:t,proratedCreditMessage:a,proratedCreditInfoMessage:s}){return e.jsxs("div",{children:[e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:t}),e.jsx("span",{className:"font-semibold text-green-600",children:a})]}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:s})]})}function ps({accountId:t,handleUpdate:a,isUpdating:s,onClose:i,currencySymbol:l}){const o=B(),{data:n,isError:u,isLoading:g}=kt(t,void 0,Bt(y.PRO));if(g)return e.jsx(Gt,{});if(u||!n)return null;const d=fs(n,o,l);return e.jsxs("div",{className:"p-6",children:[e.jsx(hs,{data:n,currencySymbol:l}),d.filter(r=>r.value!==0).map((r,h)=>e.jsx(gs,{adjustmentMessage:r.adjustmentMessage,proratedCreditMessage:r.proratedCreditMessage,proratedCreditInfoMessage:r.proratedCreditInfoMessage},h)),e.jsx("hr",{className:"mt-4 mb-4"}),e.jsx(ys,{data:n,currencySymbol:l}),n.default_payment_method&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"mt-4 mb-4"}),e.jsx(xs,{defaultPaymentMethod:n.default_payment_method})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(be,{title:o.formatMessage({id:"planUpgradeModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:i}),e.jsx(be,{title:o.formatMessage({id:"planUpgradeModal.payNow",defaultMessage:"Pay now"}),color:"primary",onClick:a,loading:s})]})]})}function fs(t,a,s){return[{adjustmentMessage:e.jsx(c,{id:"planUpgradeModal.adjustment",defaultMessage:"Adjustment"}),proratedCreditMessage:e.jsx(c,{id:"planUpgradeModal.proratedCredit",defaultMessage:"-{currencySign}{adjustment}",values:{currencySign:a.formatMessage(s.sign),adjustment:(-t.negative_line_item_total/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(c,{id:"planUpgradeModal.proratedCreditInfo",defaultMessage:"Prorated credit for the remainder of your Plus subscription"}),value:t.negative_line_item_total},{adjustmentMessage:e.jsx(c,{id:"planUpgradeModal.discount",defaultMessage:"Adjustment"}),proratedCreditMessage:e.jsx(c,{id:"planUpgradeModal.discountAmount",defaultMessage:"-{currencySign}{discount}",values:{currencySign:a.formatMessage(s.sign),discount:(t.discount_amount/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(c,{id:"planUpgradeModal.discountInfo",defaultMessage:"Account discount applied"}),value:t.discount_amount},{adjustmentMessage:e.jsx(c,{id:"planUpgradeModal.credits",defaultMessage:"Adjustments"}),proratedCreditMessage:e.jsx(c,{id:"planUpgradeModal.creditsAmount",defaultMessage:"-{currencySign}{credits}",values:{currencySign:a.formatMessage(s.sign),credits:(t.applied_balance/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(c,{id:"planUpgradeModal.creditsInfo",defaultMessage:"Credits applied"}),value:t.applied_balance}]}function hs({data:t,currencySymbol:a}){const s=B();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planUpgradeModal.subscription",defaultMessage:"ChatGPT Pro subscription"})}),e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planUpgradeModal.subscriptionCost",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:s.formatMessage(a.sign),totalCost:(t.positive_line_item_total/100).toFixed(2)}})})]}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:e.jsx(c,{id:"planUpgradeModal.billingCycle",defaultMessage:"Billed monthly, starting today"})})]})}function ys({data:t,currencySymbol:a}){const s=B();return e.jsxs(e.Fragment,{children:[t.amount_due.tax_amount>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planUpgradeModal.subTotal",defaultMessage:"Subtotal"})}),e.jsx("span",{children:e.jsx(c,{id:"planUpgradeModal.subtotalPrice",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:s.formatMessage(a.sign),totalCost:(t.amount_due.amount_excluding_tax/100).toFixed(2)}})})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsxs("span",{className:"font-semibold",children:[e.jsx(c,{id:"planUpgradeModal.tax",defaultMessage:"Tax"}),e.jsx("span",{className:"text-token-text-secondary font-normal",children:e.jsx(c,{id:"planUpgradeModal.taxPercent",defaultMessage:" {taxPercent}%",values:{taxPercent:(t.amount_due.tax_amount/t.amount_due.amount_excluding_tax*100).toFixed(0)}})})]}),e.jsx("span",{children:e.jsx(c,{id:"planUpgradeModal.taxAmount",defaultMessage:"{currencySign}{tax}",values:{currencySign:s.formatMessage(a.sign),tax:(t.amount_due.tax_amount/100).toFixed(2)}})})]})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planUpgradeModal.totalDueToday",defaultMessage:"Total due today"})}),e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planUpgradeModal.totalDueTodayAmount",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:s.formatMessage(a.sign),totalCost:(t.amount_due.amount/100).toFixed(2)}})})]})]})}function xs({defaultPaymentMethod:t}){return e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planUpgradeModal.paymentMethod",defaultMessage:"Payment Method"})}),e.jsxs("span",{className:"text-token-text-secondary",children:[t.card_brand?.toUpperCase()," *",t.card_last4]})]})}function Ms({renewalDate:t,handleUpdate:a,isUpdating:s,onClose:i,plusCost:l,currencySymbol:o}){const n=B(),u=t?new Date(t).toLocaleDateString(n.locale,{year:"numeric",month:"long",day:"numeric"}):"N/A";return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-token-text-secondary",children:e.jsx(c,{id:"planDowngradeModal.currentSubscription",defaultMessage:"Your current Pro subscription will remain active until {renewalDateFormatted}, when it will change to Plus.",values:{renewalDateFormatted:u}})}),e.jsxs("div",{className:"bg-token-main-surface-secondary mt-4 rounded-md p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planDowngradeModal.newPlan",defaultMessage:"ChatGPT Plus"})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(c,{id:"planDowngradeModal.newPlanCost",defaultMessage:"{currencyCode} {currencySign}{plusCost}/month",values:{currencyCode:n.formatMessage(o.code),currencySign:n.formatMessage(o.sign),plusCost:n.formatMessage(l)}})})]}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(c,{id:"planDowngradeModal.billingStart",defaultMessage:"Billing will start on {renewalDateFormatted}",values:{renewalDateFormatted:u}})})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(be,{title:n.formatMessage({id:"planDowngradeModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:i}),e.jsx(be,{title:n.formatMessage({id:"planDowngradeModal.confirm",defaultMessage:"Confirm"}),color:"primary",onClick:a,loading:s})]})]})})}function bs({account:t,renewalDate:a,handleUpdate:s,isUpdating:i,onClose:l,plusCost:o,proCost:n,currencySymbol:u}){const g=B(),d=t.data.subscriptionStatus.planType,r=va(d.toLowerCase()),h=r==="Pro"?n:o;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-token-text-secondary",children:e.jsx(c,{id:"planRenewalModal.currentSubscription",defaultMessage:"Your current {planName} subscription will auto-renew on {renewalDate}.",values:{planName:r,renewalDate:a}})}),e.jsxs("div",{className:"bg-token-main-surface-secondary mt-4 rounded-md p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planRenewalModal.newPlan",defaultMessage:"ChatGPT {planName}",values:{planName:r}})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(c,{id:"planRenewalModal.newPlanCost",defaultMessage:"{currencyCode} {currencySign}{planCost}/month",values:{currencyCode:g.formatMessage(u.code),currencySign:g.formatMessage(u.sign),planCost:g.formatMessage(h)}})})]}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(c,{id:"planRenewalModal.billingStart",defaultMessage:"Billing will auto-renew on {renewalDate}",values:{renewalDate:a}})})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(be,{title:g.formatMessage({id:"planRenewalModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:l}),e.jsx(be,{title:g.formatMessage({id:"planRenewalModal.confirm",defaultMessage:"Confirm"}),color:"primary",onClick:s,loading:i})]})]})})}function Cs(t){return t==Mt?[ke.plusCostInEurosProduce,De.proCostInEuros,bt]:t==Ct?[ke.plusCostInPoundsProduce,De.proCostInPounds,Pt]:[ke.plusCostProduce,De.proCost,_t]}const xe=y.PLUS,Hs=({currentAccount:t})=>{const{data:{subscriptionStatus:a}}=t;return a.hasPaidSubscription&&a.subscriptionPlan===fa.PLUS?a.billingPeriod==="yearly"?w.plusYearly:w.plusProduceForPlusUsersExp:w.plusProduceForFreeUsersExp},Ps=()=>Ee({queryKey:["has-app-store-subscription-in-billing-retry"],queryFn:async()=>await Ye.safeGet("/subscriptions/has_app_store_subscription_in_billing_retry")});function qt(t,a){const s=t.data.subscriptionStatus.planType,i=t.getNextPlanType();let l=t.getDaysUntilPlanChanges(),o=i===y.PLUS&&s===y.PRO;return a&&!o&&(l=t.getDaysUntilPlanRenews(),o=!0),{daysUntilPlanChanges:l,isDowngradeScheduled:o}}function qe(t,a){const s=Tt(new Date,t);return new Intl.DateTimeFormat(a,{year:"numeric",month:"short",day:"numeric"}).format(s)}function _s(t,a,s){let i;switch(t){case"month":i=Na(new Date,a);break;case"year":i=Ta(new Date,a);break}return new Intl.DateTimeFormat(s,{year:"numeric",month:"short",day:"numeric"}).format(i)}const Ht=({analyticsParams:t,currentAccount:a,planLoading:s,isPromoLoading:i,onSubmit:l,setPlanLoading:o,plusPricingPlanProduce:n=null,shouldShowAdditionalLinks:u=!0,billingDetails:g,promoCode:d=null,promoMetadata:r=null,onCustomUpgradeClick:h=null,onUpgradeLoading:f=!1,handlePromoModalClose:M=()=>{},disableForMobile:P=!1,shouldShowMemoryUpsell:$=!1})=>{const{data:z}=ft(),{data:Z,refetch:k}=Ee(ze),{data:E,isError:D}=Ps(),A=a.features,{isUnauthenticated:F}=xt(),b=B(),I=Ce(),[O,re]=m.useState(!1);let _=n||Ea();const ce=m.useRef(!1),[J,de]=m.useState(!1),[X,V]=m.useState(!1),[G,T]=m.useState(!1),{recentlyDowngraded:C,recentlyCanceled:L,setRecentlyCanceled:ue}=Qe();let U=[];const ee=a.isOrWasPaidCustomer(),ae=a.hasPaidSubscription(),v=ae&&a.isPlus(),fe=ae&&a.isPro(),se=a.getLastActiveSubscription(),{hasSignedUpForWaitlist:me,signUpForWaitlist:x}=Rt(xe),{layer:R}=St("468168202"),he=Ne(),j=jt(z),ne=A.includes("disable_plus_upgrade_ui")&&!ee,Yt=A.includes("show_cancel_plus_ui"),{daysUntilPlanChanges:Je,isDowngradeScheduled:$t}=qt(a,C),K={...t,promoCode:d,planType:xe,isUpgradeUiDisabled:ne},zt=!!Z?.email,Oe=async q=>{if(!zt&&!q){T(!0);return}o(y.PLUS),p.logEvent("Account Pay: Payment Checkout Clicked",K),H.logEvent("chatgpt_account_payment_modal_upgrade_button_click",xe);try{const ge=await Me.getCheckoutLink(A,"ProducePlus",{plan_name:"chatgptplusplan",billing_details:g,promo_code:d});l?.(),p.logEvent("Account Pay: Navigating to Payment Checkout",{...K,url:ge.url}),H.logEvent("chatgpt_account_payment_modal_navigating_to_checkout",xe,{url:ge.url}),window.location.href=ge.url}catch{I.warning(b.formatMessage(S.paymentErrorWarning),{hasCloseButton:!0})}o(null)},Zt=()=>{re(!0),p.logEventWithStatsig("Cancel Plus: Opened cancel modal","cancel_plus_start",{...K,cancel_start_source:"manage plan"})},Kt=async()=>{o(y.PLUS);try{const q=await Me.fetchCustomerPortalUrl();p.logEvent("Account Portal: Navigating to Account Portal",K),location.href=q.url}catch{I.warning(b.formatMessage(S.accountErrorWarning),{hasCloseButton:!0})}o(null)},Xt=()=>{p.logEvent("Account Portal: Click iOS Manage Subscription",K)},Qt=()=>{p.logEvent("Account Portal: Click Android Manage Subscription",K)},Jt=v&&se.purchase_origin_platform===te.MOBILE_IOS,ea=v&&se.purchase_origin_platform===te.MOBILE_ANDROID,et=v&&(se.purchase_origin_platform===te.WEBAPP||se.purchase_origin_platform===te.GRANTED)&&a.hasCustomerObject(),ta=et&&!L&&v&&a.willRenewSubscription();if($){const q=_.advertisedFeatures??[];_={..._,advertisedFeatures:[...q.slice(0,4),ke.memoryUpsell,...q.slice(4)]}}if(j&&!v&&U.push(e.jsx(Q,{to:ja,target:"_blank",className:"px-2 underline",children:e.jsx(c,{...S.limitsApply})},"row-plus-plan-usage-limits")),Jt&&U.push(e.jsx(Q,{to:Nt,target:"_blank",onClick:Xt,className:"px-2 underline",children:b.formatMessage(w.manageSubscriptionIos.callToAction)},"row-plus-plan-manage-ios")),ea&&U.push(e.jsx(Q,{to:At,target:"_blank",onClick:Qt,children:b.formatMessage(w.manageSubscriptionAndroid.callToAction)},"row-plus-plan-manage-android")),et&&R.get("is_stripe_manage_subscription_link_enabled",!0)){const q=R.get("does_manage_my_subscription_link_take_user_to_subscription_settings",!1);U.push(e.jsx(Q,{to:"#",className:"px-2 underline",onClick:ge=>{ge.preventDefault(),p.logEvent("Account Portal: Click Manage My Subscription",K),q?he("/#settings/Subscription"):Kt()},children:e.jsx(c,{...w.manageSubscriptionWeb.callToAction})},"row-manage-subscription-link")),ta&&Yt&&U.push(e.jsxs("button",{children:[e.jsx("span",{onClick:Zt,className:"cursor-pointer px-2 underline",children:e.jsx(c,{...w.cancelSubscriptionWeb.callToAction})}),e.jsx(is,{isOpen:O,onClose:()=>re(!1),onCancelationComplete:()=>ue(!0),analyticsParams:K})]},"row-cancel-subscription-link"))}v&&ee&&U.push(e.jsx(Q,{target:"_blank",to:$e,onClick:Ze,className:"px-2 underline",children:e.jsx(c,{...S.billingHelp})},"row-plus-plan-help-link"));const tt=function(){de(!J)},aa=()=>{fe?(p.logEvent("Account Pay: Payment Checkout Clicked",K),H.logEvent("chatgpt_account_payment_modal_upgrade_button_click",xe),V(!0)):Oe()},sa=()=>{D||!E||!E.value?h?(h(g,K),l?.()):aa():tt()},Ue=(q,ge)=>e.jsx(ve,{planType:xe,isCurrentPlan:v&&!ye,disabled:q,onClick:ge,testId:"select-plan-button-plus-upgrade",activeColor:fe?"secondary":na?"primary":void 0,loading:f,children:s===y.PLUS&&!X?e.jsx(Te,{}):ye&&v&&_.callToAction.promo?b.formatMessage(_.callToAction.promo):v?b.formatMessage(_.callToAction.active):at&&F&&_.callToAction.inactiveUnauthenticated?b.formatMessage(_.callToAction.inactiveUnauthenticated):b.formatMessage(_.callToAction.inactive)});Ke(G,{plan:K});const ye=r!=null,na=r?.promotion_type==="student_discount",at=r!=null&&"referrer_name"in r,ia=(!v||ye)&&s==null;U=ye?[]:U;let st=null,nt=a.getDaysUntilPlanDiscountExpires();if(r!=null?_=Ss(b,_,r,g.currency):a.data.subscriptionStatus.discount&&(_.cost=Wt(b,_.cost,a.data.subscriptionStatus.discount),r==null&&(_.summary=ke.plusSummaryWithDiscount,a.data.subscriptionStatus.discount.discount_type===We.PERCENTAGE&&(st={discount:{percentage:a.data.subscriptionStatus.discount.amount,expires_at:nt?qe(nt,b.locale):void 0}}))),i!=null&&i)return null;const la=vs(a);return e.jsxs(e.Fragment,{children:[e.jsx(Ae,{planName:"plus",pricingPlan:_,icon:e.jsx(Qa,{className:"icon-md text-green-600"}),showForLine:!v&&!j,callToActionButton:ne?e.jsx("div",{className:"relative w-full",children:e.jsx(Se,{side:"bottom",sideOffset:20,label:b.formatMessage(w.disabledHighDemand.hoverText),children:e.jsx(ve,{planType:xe,disabled:me,onClick:x,isCurrentPlan:v,testId:"select-plan-button-plus-waitlist",activeColor:fe?"secondary":void 0,children:e.jsx(c,{...me?w.signUpForWaitlist.inactive:w.signUpForWaitlist.active})})})}):P&&la?e.jsx("div",{children:e.jsx(Se,{side:"top",sideOffset:20,label:b.formatMessage({id:"I2JCGZ",defaultMessage:"Mobile subscriptions are currently not eligible for this promotion."}),onOpenChange:q=>{q&&!ce.current&&(at&&wa.logMobileSubscriptionTooltipOpen(),ce.current=!0)},children:e.jsx("div",{children:Ue(!0,()=>{})})})}):e.jsxs("div",{children:[Je&&$t?e.jsx(Se,{side:"top",sideOffset:20,label:e.jsx(c,{id:"8/N1rV",defaultMessage:"Your subscription will change to Plus on {date}.",values:{date:qe(Je,b.locale)}}),children:Ue(!0,()=>{})}):e.jsx("div",{className:"bg-green-600/5",children:Ue(!ia,sa)}),e.jsx(Lt,{isOpen:J,onClose:tt,onContinue:Oe,analyticsParams:K}),X&&e.jsx(Vt,{isOpen:X,onClose:()=>V(!1),accountId:a.id,initialPlanType:y.PRO,updatedPlanType:y.PLUS,billingDetails:g})]}),secondaryCallToActionButton:ye?e.jsx(N,{size:"large",color:"secondary",onClick:()=>M(),children:e.jsx(c,{...S.notNow})}):null,additionalLinks:u?U:[],plusInactive:!ae&&!ye,promoMetadata:r,activeDiscountMetadata:st,billingDetails:g,className:ye?"bg-token-main-surface-primary":""}),e.jsx(oe,{testId:"modal-add-email",isOpen:G,onClose:()=>T(!1),type:"success",className:"max-w-sm",children:e.jsx(Xe,{enterEmailTitle:b.formatMessage(S.addEmailTitle),enterEmailDescription:b.formatMessage(S.addEmailDescription),onVerified:()=>{k(),T(!1),Oe(!0)},cancelFlowButton:e.jsx(N,{className:"w-full rounded-md",color:"secondary",onClick:()=>T(!1),children:e.jsx(c,{...S.cancelAddEmail})})})})]})};function Ss(t,a,s,i){const{costTitle:l,currencySymbol:o}=ka(a,i),n=l?.defaultMessage?.toString()??"20",u=s.duration?.period??"month",g=s.duration?.num_periods??1,d=_s(u,g,t.locale),r=Wt(t,a.cost,s.discount,s.duration??{num_periods:1,period:"month"}),h=o.code.defaultMessage?.toString()??"USD",f=t.formatNumber(parseFloat(n)||0,{style:"currency",currency:h,minimumFractionDigits:0,maximumFractionDigits:2});let M;switch(u){case"month":g===1?M=t.formatMessage(S.promoPlanDisclaimerForSingleMonth,{date:d,cost:f}):M=t.formatMessage(S.promoPlanDisclaimerForPluralMonths,{num_months:g,date:d,cost:f});break;case"year":g===1?M=t.formatMessage(S.promoPlanDisclaimerForSingleYear,{date:d,cost:f}):M=t.formatMessage(S.promoPlanDisclaimerForPluralYears,{num_years:g,date:d,cost:f});break}const P="<article>"+t.formatMessage(S.termsApply)+"</article> "+M;return a={...a,summary:{id:"promoSummary",defaultMessage:s.summary},disclaimer:{id:"promoDisclaimer",defaultMessage:P,article:"https://help.openai.com/en/articles/10492689-chatgpt-plus-promotions-referrals"},cost:r,callToAction:{...a.callToAction,promo:{id:"pricingPlanConstants.promo.callToAction",defaultMessage:"Apply to My Subscription",description:"Payment call to action for existing subscribers adding a discount to their plan"}}},a}function vs(t){const a=t.hasPaidSubscription(),s=t.getLastActiveSubscription(),i=a&&s.purchase_origin_platform===te.MOBILE_IOS,l=a&&s.purchase_origin_platform===te.MOBILE_ANDROID;return i||l}const S=le({promoPlanDisclaimerForPluralMonths:{id:"pricingPlanConstants.promoPlanDisclaimerForPluralMonths",defaultMessage:"Promo pricing applies for {num_months} months. Starting {date}, ChatGPT Plus will continue at {cost}/month. Cancel anytime."},promoPlanDisclaimerForSingleMonth:{id:"pricingPlanConstants.promoPlanDisclaimerForSingleMonth",defaultMessage:"Promo pricing applies for 1 month. Starting {date}, ChatGPT Plus will continue at {cost}/month. Cancel anytime."},promoPlanDisclaimerForPluralYears:{id:"pricingPlanConstants.promoPlanDisclaimerForPluralYears",defaultMessage:"Promo pricing applies for {num_years} years. Starting {date}, ChatGPT Plus will continue at {cost}/year. Cancel anytime."},promoPlanDisclaimerForSingleYear:{id:"pricingPlanConstants.promoPlanDisclaimerForSingleYear",defaultMessage:"Promo pricing applies for 1 year. Starting {date}, ChatGPT Plus will continue at {cost}/year. Cancel anytime."},termsApply:{id:"pricingPlanConstants.termsApply",defaultMessage:"Terms apply."},addEmailTitle:{id:"AccountPaymentModal.addEmailTitle",defaultMessage:"Email required"},addEmailDescription:{id:"AccountPaymentModal.addEmailDescription",defaultMessage:"You’ll be able to login with this email. It will also be used for account updates (like password resets) and information about OpenAI services."},cancelAddEmail:{id:"AccountPaymentModal.cancelAddEmail",defaultMessage:"Cancel"},haveExistingPlan:{id:"AccountPaymentModal.haveExistingPlan",defaultMessage:"Have an existing plan?"},billingHelp:{id:"AccountPaymentModel.billingHelp",defaultMessage:"I need help with a billing issue"},paymentErrorWarning:{id:"AccountPaymentModal.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},accountErrorWarning:{id:"AccountPaymentModal.accountErrorWarning",defaultMessage:"The account management page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},limitsApply:{id:"xda4i3",defaultMessage:"Limits apply"},notNow:{id:"AccountPaymentModal.notNow",defaultMessage:"Not Now"}}),Es=t=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.22222 20C1.54721 20 1 19.4563 1 18.7857C1 16.7307 1.99227 15.1645 3.42364 14.1533C4.81866 13.1677 6.60907 12.7143 8.33333 12.7143C10.0576 12.7143 11.848 13.1677 13.243 14.1533C14.6744 15.1645 15.6667 16.7307 15.6667 18.7857C15.6667 19.4563 15.1195 20 14.4444 20C12.7348 20 3.93184 20 2.22222 20Z",fill:"currentColor"}),m.createElement("path",{d:"M17.5 18.7857C17.5 16.4257 16.487 14.5332 14.998 13.2166C15.7888 12.8756 16.655 12.7143 17.5 12.7143C18.7932 12.7143 20.136 13.0921 21.1823 13.9134C22.2558 14.7561 23 16.0613 23 17.7738C23 18.3327 22.5896 18.7857 22.0833 18.7857H17.5Z",fill:"currentColor"}),m.createElement("path",{d:"M8.33333 2.99998C5.97078 2.99998 4.05556 4.90277 4.05556 7.24998C4.05556 9.5972 5.97078 11.5 8.33333 11.5C10.6959 11.5 12.6111 9.5972 12.6111 7.24998C12.6111 4.90277 10.6959 2.99998 8.33333 2.99998Z",fill:"currentColor"}),m.createElement("path",{d:"M17.5 5.42856C15.8125 5.42856 14.4444 6.78769 14.4444 8.46427C14.4444 10.1408 15.8125 11.5 17.5 11.5C19.1875 11.5 20.5556 10.1408 20.5556 8.46427C20.5556 6.78769 19.1875 5.42856 17.5 5.42856Z",fill:"currentColor"})),_e=y.TEAM,js=({analyticsParams:t,planLoading:a,teamPricingPlanProduce:s,billingDetails:i})=>{const{data:l,refetch:o}=Ee(ze),u=ha()?.includes("disable_team_upgrade_ui"),g=B(),d=He(),r=Ne(),[h,f]=m.useState(!1),{hasSignedUpForWaitlist:M,signUpForWaitlist:P}=Rt(_e),$=d&&d.isTeam(),z=d&&d.isPlus(),Z={...t,planType:_e,isUpgradeUiDisabled:u},k=!!l?.email,E=s,D=A=>{if(!k&&!A){f(!0);return}p.logEvent("Account Pay: Payment Checkout Clicked",Z),H.logEvent("chatgpt_account_payment_modal_upgrade_button_click",_e),Aa.setPurchaseWorkspaceData({minimumSeats:Fa,billingDetails:i}),It(r)};return Ke(h,{plan:Z}),e.jsxs(e.Fragment,{children:[e.jsx(Ae,{planName:"team",elementId:Ft,pricingPlan:E,icon:e.jsx(Es,{className:"icon-md text-brand-blue-800"}),callToActionButton:e.jsxs("div",{className:"flex flex-col gap-2",children:[$&&e.jsx(ve,{planType:_e,isCurrentPlan:!0,disabled:a!=null||$,onClick:()=>D(),testId:"select-plan-button-teams-upgrade",children:g.formatMessage(E.callToAction.active)}),u?e.jsx("div",{className:"relative w-full",children:e.jsx(Se,{side:"bottom",sideOffset:20,label:g.formatMessage(w.disabledHighDemand.hoverText),children:e.jsx(ve,{planType:_e,isCurrentPlan:!1,disabled:M,onClick:P,testId:"select-plan-button-teams-waitlist",children:e.jsx(c,{...M?w.signUpForWaitlist.inactive:w.signUpForWaitlist.active})})})}):e.jsx("div",{className:"w-full",children:e.jsx(ve,{planType:_e,isCurrentPlan:!1,disabled:a!=null,onClick:()=>D(),testId:"select-plan-button-teams-create",children:$||z?g.formatMessage(E.callToAction.create):g.formatMessage(E.callToAction.inactive)})})]}),billingDetails:i}),e.jsx(oe,{testId:"modal-add-email",isOpen:h,onClose:()=>f(!1),type:"success",className:"max-w-sm",children:e.jsx(Xe,{enterEmailTitle:g.formatMessage(S.addEmailTitle),enterEmailDescription:g.formatMessage(S.addEmailDescription),onVerified:()=>{f(!1),o(),D(!0)}})})]})},ws=t=>m.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},m.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.35825 8.64117L6.41363 3.58579C6.7887 3.21071 7.29741 3 7.82785 3H16.171C16.7014 3 17.2101 3.21071 17.5852 3.58579L22.6407 8.64128C23.3997 9.40032 23.4242 10.6232 22.6961 11.412L13.4699 21.4079C12.678 22.2658 11.3227 22.2659 10.5307 21.408L1.30291 11.412C0.574744 10.6232 0.599167 9.40025 1.35825 8.64117ZM8.21892 6.70217L7.79183 7.98345C7.58583 8.60146 7.10088 9.08641 6.48287 9.29241L5.20159 9.71951C4.93203 9.80936 4.93203 10.1906 5.20158 10.2805L6.48287 10.7076C7.10088 10.9136 7.58583 11.3985 7.79183 12.0166L8.21892 13.2978C8.30878 13.5674 8.69006 13.5674 8.77991 13.2978L9.207 12.0166C9.41301 11.3985 9.89796 10.9136 10.516 10.7076L11.7973 10.2805C12.0668 10.1906 12.0668 9.80936 11.7973 9.71951L10.516 9.29241C9.89796 9.08641 9.41301 8.60146 9.207 7.98345L8.77991 6.70217C8.69006 6.43261 8.30878 6.43261 8.21892 6.70217Z",fill:"currentColor"})),ks=()=>Ee({queryKey:["has-app-store-subscription-in-billing-retry"],queryFn:async()=>await Ye.safeGet("/subscriptions/has_app_store_subscription_in_billing_retry")}),we="pro",Ts=({analyticsParams:t,currentAccount:a,planLoading:s,onSubmit:i,setPlanLoading:l,billingDetails:o,variant:n})=>{const{data:u,isError:g}=ks(),d=a.features,{data:r,refetch:h}=Ee(ze),f=B(),M=Ce(),[P]=pt(),$=P.get("checkout_from"),[z,Z]=m.useState(!1),[k,E]=m.useState(!1),[D,A]=m.useState(!1),F=a.getLastActiveSubscription(),b=a.isOrWasPaidCustomer(),I=a.hasPaidSubscription(),O=I&&a.isPro(),re=!!r?.email,{layer:_}=St("468168202"),ce=Ne(),{recentlyDowngraded:J}=Qe(),{daysUntilPlanChanges:de,isDowngradeScheduled:X}=qt(a,J),{value:V}=lt("1719651090"),G=Ia({isOperatorEnabled:V}),T=[],C={...t,planType:we},L=I&&F.purchase_origin_platform===te.MOBILE_IOS,ue=I&&F.purchase_origin_platform===te.MOBILE_ANDROID,U=I&&(F.purchase_origin_platform===te.WEBAPP||F.purchase_origin_platform===te.GRANTED)&&a.hasCustomerObject(),ee=async j=>{if(!re&&!j){A(!0);return}l(y.PRO),p.logEvent("Account Pay: Payment Checkout Clicked",C),H.logEvent("chatgpt_account_payment_modal_upgrade_button_click",we);try{const ne=await Me.getCheckoutLink(d,"ProducePro",{plan_name:"chatgptpro",billing_details:o});i?.(),p.logEvent("Account Pay: Navigating to Payment Checkout",{...C,url:ne.url}),H.logEvent("chatgpt_account_payment_modal_navigating_to_checkout",we,{url:ne.url}),$==="vza493q"&&pe.setItem(ie.CheckoutFrom,$),window.location.href=ne.url}catch{M.warning(f.formatMessage(S.paymentErrorWarning),{hasCloseButton:!0})}l(null)},ae=async()=>{l(y.PRO);try{const j=await Me.fetchCustomerPortalUrl();p.logEvent("Account Portal: Navigating to Account Portal",C),location.href=j.url}catch{M.warning(f.formatMessage(S.accountErrorWarning),{hasCloseButton:!0})}l(null)},v=()=>{p.logEvent("Account Portal: Click iOS Manage Subscription",C)},fe=()=>{p.logEvent("Account Portal: Click Android Manage Subscription",C)};if(O&&L&&T.push(e.jsx(Q,{to:Nt,target:"_blank",onClick:v,className:"px-2 underline",children:f.formatMessage(w.manageSubscriptionIos.callToAction)},"row-plus-plan-manage-ios")),O&&ue&&T.push(e.jsx(Q,{to:At,target:"_blank",onClick:fe,children:f.formatMessage(w.manageSubscriptionAndroid.callToAction)},"row-plus-plan-manage-android")),O&&U&&_.get("is_stripe_manage_subscription_link_enabled",!0)){const j=_.get("does_manage_my_subscription_link_take_user_to_subscription_settings",!1);T.push(e.jsx(Q,{to:"#",className:"px-2 underline",onClick:ne=>{ne.preventDefault(),p.logEvent("Account Portal: Click Manage My Subscription",C),j?ce("/#settings/Subscription"):ae()},children:e.jsx(c,{...w.manageSubscriptionWeb.callToAction})},"row-manage-subscription-link"))}b&&T.push(e.jsx(Q,{target:"_blank",to:$e,onClick:Ze,className:"px-2 underline",children:e.jsx(c,{...S.billingHelp})},"row-plus-plan-help-link"));const se=function(){Z(!z)},me=function(){E(!k)},{value:x}=lt("1382475798"),R=async()=>{let j=a.hasPaidSubscription()&&a.isPlus();x&&(j=j&&!a.isActiveSubscriptionGratis()),j?(p.logEvent("Account Pay: Payment Checkout Clicked",C),H.logEvent("chatgpt_account_payment_modal_upgrade_button_click",we),E(!0)):await ee()},he=g||!u||!u.value?R:()=>{se()};return Ke(D,{plan:C}),e.jsxs(e.Fragment,{children:[e.jsx(Ae,{planName:"pro",pricingPlan:G,icon:e.jsx(ws,{className:"icon-md primary"}),showForLine:!1,callToActionButton:e.jsxs("div",{children:[a.isWorkspacePlan()&&n==="operator"?e.jsx(N,{fullWidth:!0,size:"large",color:"primary",disabled:!0,"data-testid":"select-plan-button-pro-upgrade",children:f.formatMessage(gt.switchToPersonalAccount)}):L||ue?e.jsx(Se,{side:"top",sideOffset:20,label:f.formatMessage(gt.switchToMobile),onOpenChange:j=>{j&&(p.logEvent("Account Pay: Show Mobile Subscription Tooltip",C),H.logEvent("chatgpt_account_payment_modal_show_mobile_subscription_tooltip",we))},children:e.jsx(N,{fullWidth:!0,size:"large",color:"primary",disabled:!0,"data-testid":"select-plan-button-pro-upgrade",children:f.formatMessage(G.callToAction.inactive)})}):X&&de?e.jsx(Se,{side:"top",sideOffset:20,label:e.jsx(c,{id:"jgTAPh",defaultMessage:"Your subscription will remain active until {date}, when it will change to Plus.",values:{date:qe(de,f.locale)}}),children:e.jsx(N,{fullWidth:!0,size:"large",color:"primary",disabled:O||s!=null,"data-testid":"select-plan-button-pro-upgrade",className:O||s!=null?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold":"",children:s===y.PRO&&!k?e.jsx(Te,{}):O?f.formatMessage(G.callToAction.active):f.formatMessage(G.callToAction.inactive)})}):e.jsx(N,{fullWidth:!0,size:"large",color:"primary",disabled:O||s!=null,onClick:he,"data-testid":"select-plan-button-pro-upgrade",className:O||s!=null?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold":"",children:s===y.PRO&&!k?e.jsx(Te,{}):O?f.formatMessage(G.callToAction.active):f.formatMessage(G.callToAction.inactive)}),e.jsx(Lt,{isOpen:z,onClose:se,onContinue:ee,analyticsParams:C}),k&&e.jsx(Vt,{isOpen:k,onClose:me,accountId:a.id,initialPlanType:y.PLUS,updatedPlanType:y.PRO,billingDetails:o})]}),additionalLinks:T,className:"bg-token-main-surface-primary",billingDetails:o}),e.jsx(oe,{testId:"modal-add-email",isOpen:D,onClose:()=>A(!1),type:"success",className:"max-w-sm",children:e.jsx(Xe,{enterEmailTitle:f.formatMessage(S.addEmailTitle),enterEmailDescription:f.formatMessage(S.addEmailDescription),onVerified:()=>{h(),A(!1),ee(!0)},cancelFlowButton:e.jsx(N,{className:"w-full rounded-md",color:"secondary",onClick:()=>A(!1),children:e.jsx(c,{...S.cancelAddEmail})})})})]})},gt=le({switchToPersonalAccount:{id:"y5FjSF",defaultMessage:"Switch to a personal account to upgrade"},switchToMobile:{id:"gbjsg6",defaultMessage:"It looks like you already have an active mobile subscription. Switch to your mobile app to upgrade"}});function Ns({analyticsParams:t,currentAccount:a,planLoading:s,selectedTab:i,setPlanLoading:l,shouldSplitBetweenPersonalAndBusiness:o,isEnterpriseEnabled:n,billingDetails:u,variant:g,shouldShowMemoryUpsell:d}){const r=[],h=a.hasPaidSubscription();return g==="operator"?(h&&a.isPlus()&&r.push("plus"),r.push("pro")):o?i==="personal"?(h||r.push("free"),r.push("plus"),r.push("pro")):(r.push("team"),n&&r.push("enterprise")):(h||r.push("free"),(!a.isTeam()||!a.isEnterprisey()&&n)&&(r.push("plus"),r.push("pro")),r.push("team"),n&&r.push("enterprise")),r.length===0&&vt.addError(new Error("Account payment modal missing columns")),r.map(f=>{switch(f){case"free":return e.jsx(Ka,{billingDetails:u},f);case"plus":return e.jsx(Ht,{analyticsParams:t,currentAccount:a,setPlanLoading:l,planLoading:s,billingDetails:u,shouldShowMemoryUpsell:d},f);case"team":return e.jsx(js,{analyticsParams:t,planLoading:s,teamPricingPlanProduce:Ua,billingDetails:u},f);case"enterprise":return e.jsx(za,{enterprisePricingPlanProduce:Oa,billingDetails:u},f);case"pro":return e.jsx(Ts,{analyticsParams:t,currentAccount:a,setPlanLoading:l,planLoading:s,billingDetails:u,variant:g},f)}})}function As({title:t,message:a,buttonTitle:s,isOpen:i,onClose:l}){return e.jsx(oe,{testId:"modal-generic-ineligible",type:"success",isOpen:i,onClose:l,showCloseButton:!0,title:t,children:e.jsxs("div",{className:"",children:[e.jsx("p",{children:a}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(be,{title:s,color:"secondary",onClick:l,size:"large"})})]})})}const Fs=({isOpen:t,onClose:a,promoError:s,promoCode:i})=>{const l=B();return m.useEffect(()=>{p.logEvent("Promo Ineligible Modal Shown",{promoCode:i,ineligibleReason:s.code}),H.logEvent("chatgpt_promo_ineligible_modal_shown")},[i,s.code]),e.jsx(As,{title:s.title,message:s.message,buttonTitle:l.formatMessage({id:"promoIneligibleModal.close",defaultMessage:"Close"}),isOpen:t,onClose:a})},Is=({handleClose:t,analyticsParams:a,currentAccount:s,setPlanLoading:i,planLoading:l,billingDetails:o,promoMetadata:n,promoCode:u,nonFooterContentRef:g,isEligible:d,isPromoLoading:r,promoError:h})=>{const f=Ne(),{eligible:M,isLoading:P}=Da(La);if(m.useEffect(()=>{M&&!P&&n&&(pe.setItem(ie.PromoCode,u),t(),f("/"))},[M,P,u,t,f,n]),!d&&h)return e.jsx(Fs,{isOpen:!0,onClose:t,promoError:h,promoCode:u});if(M||P)return null;if(d&&n!=null)return e.jsx(Os,{handleClose:t,analyticsParams:a,currentAccount:s,setPlanLoading:i,planLoading:r?y.PLUS:l,isPromoLoading:r,billingDetails:o,promoCode:u,promoMetadata:n,nonFooterContentRef:g})},Os=({handleClose:t,analyticsParams:a,currentAccount:s,setPlanLoading:i,planLoading:l,isPromoLoading:o,billingDetails:n,promoCode:u,promoMetadata:g,nonFooterContentRef:d})=>(m.useEffect(()=>{p.logEvent("Promo Eligible Modal Shown",{promoCode:u}),H.logEvent("chatgpt_promo_eligible_modal_shown")},[u]),e.jsx(oe,{testId:"modal-promo-eligible",size:"fullscreen",isOpen:!0,onClose:t,type:"success",className:"flex h-full flex-col items-center justify-center bg-white/70 dark:bg-gray-800/70",removePopoverStyling:!0,showOverlayBackground:!1,children:e.jsx("div",{ref:d,className:"flex h-full items-center justify-center",children:e.jsx("div",{className:"flex flex-col justify-center gap-4 px-3 py-6 md:min-h-[30rem] md:flex-row md:gap-0 md:py-0",children:e.jsx(Ht,{analyticsParams:a,currentAccount:s,setPlanLoading:i,planLoading:l,isPromoLoading:o,billingDetails:n,promoCode:u,promoMetadata:g,handlePromoModalClose:t})})})}));function Ys({currentAccount:t,defaultTab:a="personal",hasEnterpriseFooter:s=!0,onClose:i,subtitle:l,title:o,variant:n="default"}){const[u,g]=m.useState(null),d=ra(),r=ca(),h=Ra(),f=h&&n!=="operator",[M]=pt(),P=M.get("promoCode"),{isEligible:$,promoMetadata:z,isPromoLoading:Z,promoError:k}=Wa(P??""),E=m.useMemo(()=>({...t.subscriptionAnalyticsParams,referrer:document.referrer}),[t]),D=Ne(),A=Ce(),F=m.useCallback(()=>{p.logEvent("Account Pay: Close Account Payment Modal",E),i?i():It(D)},[E,D,i]),b=Ba();m.useEffect(()=>{const x=localStorage.getItem(`subscriptionUpdateMessage_${t.id}`);if(x){localStorage.removeItem(`subscriptionUpdateMessage_${t.id}`),A.success(x,{hasCloseButton:!0});const R=setTimeout(()=>{F()},5e3);return()=>{clearTimeout(R)}}},[t.id,A,F]);const[I,O]=m.useState(a),{userCountry:re,isCountrySelectorEnabled:_,countryWithFallback:ce,initialBillingDetails:J}=Va(t,I=="personal");Ga(()=>{const x=d.state?.[Ha],R=d.key;x&&D({hash:d.hash,search:d.search},{replace:!0,state:{}}),p.logEventWithStatsig("Account Pay: Account Payment Modal Show","chatgpt_account_payment_modal_show",{...E,initialTab:a,location:x,locationKey:R,navigationType:r,selectedCountry:J.country??"",selectedCurrency:J.currency??"",userCountry:re??""})});const de=ya().locale,X=xa(de),[V,G]=m.useState(ce),[T,C]=m.useState(J),L=x=>{vt.addAction("chatgpt_selected_country_changed_in_pricing_modal",{old_selected_country:V,new_selected_country:x}),p.logEventWithStatsig("Selected country changed in pricing modal","chatgpt_selected_country_changed_in_pricing_modal",{old_selected_country:V,new_selected_country:x}),G(x),C({country:x,currency:ot(x)})},ue=x=>{O(x),x=="personal"&&t.hasPaidSubscription()?C({currency:t.mustGetSubscriptionBillingCurrency("AccountPaymentModal")}):C({country:V,currency:ot(V)}),p.logEventWithStatsig("Account Pay: Account Payment Modal Toggle Clicked","chatgpt_account_payment_modal_toggle_clicked",{selectedTab:x})},U=136,[ee,ae]=m.useState(),v=m.useRef(null);m.useEffect(()=>{const x=()=>{if(v.current){const R=document.documentElement.clientHeight,he=v.current.getBoundingClientRect().height,j=R-he;ae(Math.max(j,U))}};return x(),window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[I]);const fe=Ns({analyticsParams:E,currentAccount:t,planLoading:u,selectedTab:I,setPlanLoading:g,shouldSplitBetweenPersonalAndBusiness:f,isEnterpriseEnabled:!1,billingDetails:T,variant:n,shouldShowMemoryUpsell:b}),se=Ds({defaultTitle:o,hasProSubscription:t.isPro()}),me=m.useRef(!1);return m.useEffect(()=>{const x=document.getElementById(Ft);if(!(!x||me.current)){if(v.current&&!f&&a==="business")x.scrollIntoView({behavior:"smooth"}),p.logEvent("Account Pay: Account Payment Modal Scroll",{selectedTab:"business",scrollSource:"auto"}),me.current=!0;else if(!f){const R=new IntersectionObserver(he=>{he.some(j=>j.isIntersecting)&&(p.logEvent("Account Pay: Account Payment Modal Scroll",{selectedTab:"business",scrollSource:"manual"}),me.current=!0,R.disconnect())},{root:null,threshold:.5});return R.observe(x),()=>R.disconnect()}}},[t,a,f]),P&&(z||Z||k)?e.jsx(Is,{handleClose:F,analyticsParams:E,currentAccount:t,setPlanLoading:g,planLoading:Z?y.PLUS:u,billingDetails:T,promoCode:P,promoMetadata:z,nonFooterContentRef:v,isEligible:$,isPromoLoading:Z,promoError:k}):e.jsxs(oe,{testId:"modal-account-payment",size:"fullscreen",isOpen:!0,onClose:F,type:"success",className:"flex flex-col",removePopoverStyling:!0,children:[e.jsxs("div",{ref:v,children:[e.jsxs("div",{className:"relative grid grid-cols-[1fr_auto_1fr] px-6 py-4 md:pt-[4.5rem] md:pb-10",children:[e.jsx("div",{}),e.jsxs("div",{className:"my-1 flex flex-col items-center justify-center md:mt-0 md:mb-0",children:[e.jsx("div",{className:"text-2xl font-semibold md:text-3xl",children:e.jsx(c,{...se})}),l?e.jsx("div",{className:"text-token-text-secondary mt-3 mb-1",children:e.jsx(c,{...l})}):null]}),e.jsx("button",{className:"text-token-text-primary justify-self-end opacity-50 transition hover:opacity-75 md:absolute md:end-6 md:top-6",onClick:()=>{F()},children:e.jsx(ht,{className:Ma({"h-5 w-5":!h,"icon-lg":h})})})]}),t.isPersonalAccount()&&f?e.jsx("div",{className:"mb-3 flex justify-center md:mb-10",children:e.jsx("div",{className:"w-[fit-content]",children:e.jsx(Ya,{value:I,onChange:ue})})}):null,e.jsx("div",{className:"flex flex-col justify-center gap-4 px-3 py-3 md:min-h-[30rem] md:flex-row md:gap-0 md:py-0",children:fe})]}),e.jsxs("div",{className:"relative grid grid-cols-[1fr_auto_1fr]",style:{height:`${ee}px`},children:[e.jsx("div",{}),s?e.jsxs("span",{className:"text-token-text-secondary mt-8 mb-12 flex flex-col items-center justify-start gap-2 text-sm md:mt-8 md:mb-8",children:[e.jsx(Ut,{}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(c,{...Ie.needMoreCapabilities}),e.jsx("div",{children:e.jsx(c,{...Ie.seeChatGptEnterprise,values:{link:x=>e.jsx(Q,{target:"_blank",to:Et,onClick:()=>{p.logEventWithStatsig("Account Pay: Click see enterprise link from Modal","chatgpt_account_payment_modal_enterprise_link_clicked")},className:"mx-1 underline",children:x})}})})]})]}):null,e.jsx("span",{className:"text-token-text-primary justify-self-end opacity-50 transition hover:opacity-75 md:absolute md:end-4 md:bottom-4",children:Us({isCountrySelectorEnabled:_,currentAccount:t,selectedTab:I})?e.jsx(qa,{value:V,onValueChange:L,displayNameFormatterFn:X,testId:"country-selector-in-pricing-modal"}):null})]})]})}function Us({isCountrySelectorEnabled:t,currentAccount:a,selectedTab:s}){return t?!!(!a.hasPaidSubscription()||(a.isPlus()||a.isPro())&&s==="business"||a.isTeam()):!1}function Ds({defaultTitle:t,hasProSubscription:a}){return t||(a?Ie.proModalTitle:Ie.modalTitle)}const Ie=le({modalTitle:{id:"AccountPaymentModal.modalTitle",defaultMessage:"Upgrade your plan"},proModalTitle:{id:"AccountPaymentModal.proModalTitle",defaultMessage:"Choose your plan"},modalFooterCapabilities:{id:"AccountPaymentModal.modalFooterCapabilities",defaultMessage:"Need more capabilities? See <link> ChatGPT Enterprise </link>"},needMoreCapabilities:{id:"SdJWr7",defaultMessage:"Need more capabilities for your business?"},seeChatGptEnterprise:{id:"7C5fuF",defaultMessage:"See<link>ChatGPT Enterprise</link>"},promoNotEligibleMessage:{id:"AccountPaymentModal.promoNotEligibleMessage",defaultMessage:"Thanks for being a susbcriber. Since you already use ChatGPT Plus, you're not eligible for this offer."}});export{Ys as A,As as G,Ht as P,ys as T,qs as a,Cs as b,gs as c,xs as d,Vt as e,Hs as g,Ze as h};
//# sourceMappingURL=hjxngg9qm5fk6oyo.js.map
