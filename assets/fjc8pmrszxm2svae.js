import{w as ue,T as Z,j as ce,l as de,m as pe,t as L,N as P,f as fe,F as N,o as S,q as I,r as J,u as he,v as me,c as Ne,x as Me}from"./dfz2bdgqh4yduujb.js";import{w as B,c as M,I as Q,T as X,t as ke,a as ge,b as xe,P as we,H as ye,R as be}from"./n6r7bbe839ggloti.js";import{af as A,N as k,ag as v,ah as Ce}from"./m7dukzpngt1iaaya.js";import{dN as Ie,dO as Ae,g_ as C,D as Y,n as Te,B as Ee,k as Se}from"./haannt40upmuwmtk.js";import{hb as ee,rf as ve,ho as O,t as $,c1 as _e}from"./n4exq6o15ap1g74l.js";import{f as U,a as De,p as Le,h as Pe,r as Be,b as Re,c as Oe,d as $e,e as Ue}from"./oyqlb501dhlk5b61.js";import{d as je,r as ze}from"./b9iv65ef6it0bnl8.js";import{k as Fe}from"./jf5c1e7milql0vok.js";class He extends A{unistNodeName(){return"link"}static proseMirrorMarkName(){return"link"}proseMirrorMarkSpec(){return{attrs:{href:{},title:{default:null},disabled:{default:!0}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs(e){return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM(e){return["a",{...e.attrs,...e.attrs.disabled?{href:void 0}:{}}]}}}unistNodeToProseMirrorNodes({node:e,convertedChildren:t,schema:r}){const{url:o,title:s}=e;return t.map(i=>i.mark(i.marks.concat([r.marks[this.proseMirrorMarkName()].create({href:o,title:s})])))}processConvertedUnistNode(e,t){return{type:this.unistNodeName(),url:t.attrs.href,...t.attrs.title!=null&&{title:t.attrs.title},children:[e]}}}class Ke extends k{unistNodeName(){return"blockquote"}static proseMirrorNodeName(){return"blockquote"}proseMirrorNodeSpec(){return{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM(){return["blockquote",0]}}}proseMirrorInputRules(e){return[B(/^\s{0,3}>\s$/,e.nodes[this.proseMirrorNodeName()])]}proseMirrorKeymap(e){return{"Mod->":ue(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:r}){return M(this.proseMirrorNodeName(),e,t,r)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t}]}}function Ge(n,e,t,r){for(let o=0;o<e.length;o++){let{$from:s,$to:i}=e[o],a=s.depth===0?n.inlineContent&&n.type.allowsMarkType(t):!1;if(n.nodesBetween(s.pos,i.pos,(u,c)=>{if(a||!r)return!1;a=u.inlineContent&&u.type.allowsMarkType(t)}),a)return!0}return!1}function j(n){return/^\s*/.exec(n)?.[0]?.length??0}function z(n){return/\s*$/.exec(n)?.[0]?.length??0}function Ve(n,e,t){for(;e>0;){const r=e-1;if(!n.rangeHasMark(r,e,t))break;e=r}return e}function We(n,e,t){for(;e<n.content.size&&n.rangeHasMark(e,e+1,t);)e+=1;return e}function qe(n,e,t,r=null){const{selection:o}=n;if(!(o instanceof Z))return!1;let{empty:s,$cursor:i,ranges:a}=o;if(s&&!i||!Ge(n.doc,a,t,!0))return!1;if(i)t.isInSet(n.storedMarks||i.marks())?e(n.tr.removeStoredMark(t)):e(n.tr.addStoredMark(t.create(r)));else{let u=n.tr;const c=!a.some(l=>n.doc.rangeHasMark(l.$from.pos,l.$to.pos,t));for(let l=0;l<a.length;l++){let{$from:d,$to:f}=a[l],p=d.pos,h=f.pos;const m=n.doc.textBetween(p,h,`
`);if(/^\s*$/.test(m))continue;const y=d.nodeBefore?.text??"",x=d.nodeAfter?.text??"",_=f.nodeBefore?.text??"",le=f.nodeAfter?.text??"";if(c){let T=j(x),D=z(_);p+T<h&&(p+=T,h-=D),p=Ve(n.doc,p,t),h=We(n.doc,h,t),u.removeMark(p,h,n.schema.marks[v.proseMirrorMarkName()]),u.addMark(p,h,t.create(r))}else{const T=z(y),D=j(le);p-=T,h+=D,u.removeMark(p,h,t)}}e(u.scrollIntoView())}return!0}function F(n,e=null){return(t,r)=>r?qe(t,r,n,e):!0}class g extends Q{markType;constructor(e,t){super(e,(r,o,s,i)=>this.markHandler(r,o,s,i)),this.markType=t}static markApplies(e,t,r){for(const o of t){const{$from:s,$to:i}=o;let a=s.depth===0?e.type.allowsMarkType(r):!1;if(e.nodesBetween(s.pos,i.pos,u=>a?!1:(a=u.inlineContent&&u.type.allowsMarkType(r),!0)),a)return!0}return!1}markHandler(e,t,r,o){if(!(e.selection instanceof Z))return null;const s=e.doc.resolve(r),i=e.doc.resolve(o),a=[new ce(s,i)];if(!g.markApplies(e.doc,a,this.markType))return null;const u=e.doc.nodeAt(r)?.marks.map(l=>l.type)??[];u.push(this.markType);const c=e.tr.replaceWith(r,o,this.markType.schema.text(t[1]));for(const l of u)c.addMark(c.mapping.map(r),c.mapping.map(o),l.create(null));for(const l of u)c.removeStoredMark(l);return c.insertText(t[2])}}class Ze extends A{unistNodeName(){return"strong"}static proseMirrorMarkName(){return"strong"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM(){return["strong"]}}}proseMirrorInputRules(e){return[new g(/\*\*([^\s](?:.*[^\s])?)\*\*([\s\S])$/,e.marks[this.proseMirrorMarkName()]),new g(/__([^\s](?:.*[^\s])?)__([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}proseMirrorKeymap(e){const t=e.marks[this.proseMirrorMarkName()];return{"Mod-b":F(t),"Mod-B":F(t)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:r}){return t.map(o=>o.mark(o.marks.concat([e.marks[this.proseMirrorMarkName()].create(r)])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}const te=92,Je=10,E="backslashEscape";function Qe(n,e,t){function r(o){return o==null||o===Je?(n.exit(E),e(o)):t(o)}return o=>o!==te?t(o):(n.enter(E),n.consume(o),r)}function Xe(){return{text:{[te]:{name:E,tokenize:Qe}}}}function Ye(){const n=this.data();n.micromarkExtensions??=[],n.micromarkExtensions.push(Xe()),n.fromMarkdownExtensions??=[],n.fromMarkdownExtensions.push({enter:{[E](e){this.enter({type:"break"},e),this.exit(e)}}})}class et extends k{unistNodeName(){return"break"}static proseMirrorNodeName(){return"hard_break"}proseMirrorNodeSpec(){return{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],marks:v.proseMirrorMarkName(),toDOM(){return["br"]}}}proseMirrorKeymap(e){const t=de(pe,(o,s)=>(s&&s(o.tr.replaceSelectionWith(e.nodes[this.proseMirrorNodeName()].create()).scrollIntoView()),!0)),r=Ie()||Ae();return{"Mod-Enter":t,"Shift-Enter":t,...r&&{"Ctrl-Enter":t}}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:r}){return M(this.proseMirrorNodeName(),e,t,r)}proseMirrorNodeToUnistNodes(){return[{type:this.unistNodeName()}]}unifiedInitializationHook(e){return e.use(Ye)}}const tt="code_block",H="```\n";function rt(n,e){const{start:t,end:r}=n;return t==null||r==null?null:{start:t+H.length+(e.lang??"").length,end:r-H.length}}class nt extends k{dependencies(){return[new X]}unistNodeName(){return"code"}static proseMirrorNodeName(){return tt}proseMirrorNodeSpec(){return{content:"text*",group:"block",code:!0,defining:!0,marks:[v.proseMirrorMarkName()].join(" "),attrs:{lang:{default:null},isDarkMode:{default:null}},parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM(){return["pre",["code",0]]}}}proseMirrorInputRules(e){return[ke(/^\s{0,3}```$/,e.nodes[this.proseMirrorNodeName()])]}unistNodeToProseMirrorNodes({node:e,attrs:t,schema:r}){const{lang:o}=e;return M(this.proseMirrorNodeName(),r,ee(e,r,{...t,...rt(t,e)??{}}),{lang:o,...t})}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),value:t.map(r=>r.type==="startend"?r.children.map(o=>o.value).join(""):r.value).join(""),lang:e.attrs.lang}]}}class ot extends k{unistNodeName(){return"textDirective"}customDirectiveName(){return C}static proseMirrorNodeName(){return C}proseMirrorNodeSpec(){return{group:"inline",inline:!0,content:"inline*",atom:!0,attrs:{index:{default:null},displayLayout:{default:"inline"}},toDOM:e=>["span",{"data-type":"content-reference","data-content-reference-index":e.attrs.index,"data-display-layout":e.attrs.displayLayout},`:contentReference[oaicite:${e.attrs.index}]{index="${e.attrs.index}" displayLayout="${e.attrs.displayLayout}"}`],parseDOM:[{tag:'span[data-type="content-reference"]',getAttrs(e){return{index:e.getAttribute("data-index"),displayLayout:e.getAttribute("data-display-layout")||"inline"}}}]}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:r}){if(!ve(e)||e.name!==C||e.type!==this.unistNodeName())return Y.addError("ContentReferenceExtension: unistNodeToProseMirrorNodes: node is not a directive node or name is not contentReference",e),null;const o={index:e.attributes?.index,displayLayout:e.attributes?.displayLayout??"inline"};return t.nodes.contentReference.create(o,r)}proseMirrorNodeToUnistNodes(e,t){if(t.length!==1)return console.warn("ContentReferenceExtension: proseMirrorNodeToUnistNodes: convertedChildren.length != 1",t),[];const s=[{type:"text",value:t[0].children[0].value}];return[{type:"textDirective",name:C,attributes:{index:e.attrs.index,displayLayout:e.attrs.displayLayout},children:s,data:{hName:C,hProperties:{displayLayout:e.attrs.displayLayout,index:e.attrs.index}}}]}}class st extends k{unistNodeName(){return"thematicBreak"}static proseMirrorNodeName(){return"horizontal_rule"}proseMirrorNodeSpec(){return{group:"block",parseDOM:[{tag:"hr"}],toDOM(){return["div",["hr"]]}}}proseMirrorInputRules(e){return[new Q(/^\s{0,3}(?:\*\*\*|---|___)\n$/,(t,r,o,s)=>t.tr.replaceWith(o,s,M(this.proseMirrorNodeName(),e,[])??[]))]}proseMirrorKeymap(e){return{"Mod-_":(t,r)=>(r&&r(t.tr.replaceSelectionWith(e.nodes[this.proseMirrorNodeName()].create()).scrollIntoView()),!0)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:r}){return M(this.proseMirrorNodeName(),e,t,r)}proseMirrorNodeToUnistNodes(){return[{type:this.unistNodeName()}]}}class it extends A{unistNodeName(){return"inlineCode"}static proseMirrorMarkName(){return"code"}proseMirrorMarkSpec(){return{inclusive:!1,parseDOM:[{tag:"code"}],toDOM(){return["code"]}}}proseMirrorInputRules(e){return[new g(/`([^\s](?:.*[^\s])?)`([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}proseMirrorKeymap(e){const t=e.marks[this.proseMirrorMarkName()];return{"Ctrl-`":L(t)}}unistNodeToProseMirrorNodes({node:e,schema:t,attrs:r}){const o=ee(e,t,r,[t.marks[this.proseMirrorMarkName()].create(r)]);return o?[o]:[]}processConvertedUnistNode(e){return{type:this.unistNodeName(),value:e.value}}}class at extends k{unistNodeName(){return"inlineMath"}static proseMirrorNodeName(){return"inline_math"}proseMirrorNodeSpec(){return{group:"inline",inline:!0,content:"text*",atom:!0,attrs:{latex:{default:null}},parseDOM:[{tag:"span.inline-math",getAttrs(e){return{latex:e.getAttribute("latex")}}}],toDOM(){return["span",{class:"inline-math"},0]}}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:r,attrs:o}){const{value:s}=e;return M(this.proseMirrorNodeName(),t,r,{...o,latex:s})}proseMirrorNodeToUnistNodes(e){return[{type:this.unistNodeName(),value:e.attrs.latex}]}}class lt extends A{unistNodeName(){return"emphasis"}static proseMirrorMarkName(){return"em"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>e==="italic"&&null}],toDOM(){return["em"]}}}proseMirrorInputRules(e){try{return[new g(new RegExp("(?<!\\*)\\*([^\\s*](?:.*[^\\s])?)\\*([^*])$"),e.marks[this.proseMirrorMarkName()]),new g(new RegExp("(?<!_)_([^\\s_](?:.*[^\\s])?)_([^_])$"),e.marks[this.proseMirrorMarkName()])]}catch(t){return Y.addError(t),[]}}proseMirrorKeymap(e){const t=e.marks[this.proseMirrorMarkName()];return{"Mod-i":L(t),"Mod-I":L(t)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:r}){return t.map(o=>o.mark(o.marks.concat([e.marks[this.proseMirrorMarkName()].create(r)])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}function re(n){return"children"in n}const b="lineEndingBlank";function K(n){return n.type===b}const ut=({startIndex:n,endIndex:e,depth:t,isLastChild:r,parent:o=null})=>{const s=e-n;return t>0&&o?.type!=="list"?s:r||n===0?s-Math.floor((s+1)/2):s-Math.floor((s-1)/2)};function ct(){const n=this.data();n.fromMarkdownExtensions??=[],n.fromMarkdownExtensions.push({enter:{lineEndingBlank(t){this.enter({type:b},t)}},exit:{lineEndingBlank(t){this.exit(t)}}});const e=(t,r=0)=>{if(!re(t))return;const{children:o}=t;let s=0,i=null,a=null;const u=o.length;for(let c=0;c<u;c++){const l=o[c-s];e(l,r+1);const{type:d}=l,p=c===u-1&&d===b;if(d===b&&i==null?i=c:d!==b&&i!=null?a=c:p&&i!=null&&(a=c+1),i!=null&&a!=null){const h=ut({startIndex:i,endIndex:a,depth:r,isLastChild:p,parent:t});o.splice(i-s,h),i=null,a=null,s+=h}}};return t=>{e(t)}}class dt extends k{unistNodeName(){return b}static proseMirrorNodeName(){return"paragraph"}proseMirrorNodeSpec(){return ge}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:r}){return M(this.proseMirrorNodeName(),e,t,r)}proseMirrorNodeToUnistNodes(e,t){return[{type:xe,children:t}]}unifiedInitializationHook(e){return e.use(ct)}}function ne(n,e=null){return function(t,r){let{$from:o,$to:s}=t.selection,i=o.blockRange(s),a=!1,u=i;if(!i)return!1;if(i.depth>=2&&o.node(i.depth-1).type.compatibleContent(n)&&i.startIndex==0){if(o.index(i.depth-1)==0)return!1;let l=t.doc.resolve(i.start-2);u=new P(l,l,i.depth),i.endIndex<i.parent.childCount&&(i=new P(o,t.doc.resolve(s.end(i.depth)),i.depth)),a=!0}let c=fe(u,n,e,i);return c?(r&&r(pt(t.tr,i,c,a,n).scrollIntoView()),!0):!1}}function pt(n,e,t,r,o){let s=N.empty;for(let l=t.length-1;l>=0;l--)s=N.from(t[l].type.create(t[l].attrs,s));n.step(new S(e.start-(r?2:0),e.end,e.start,e.end,new I(s,0,0),t.length,!0));let i=0;for(let l=0;l<t.length;l++)t[l].type==o&&(i=l+1);let a=t.length-i,u=e.start+t.length-(r?2:0),c=e.parent;for(let l=e.startIndex,d=e.endIndex,f=!0;l<d;l++,f=!1)!f&&J(n.doc,u,a)&&(n.split(u,a),u+=2*a),u+=c.child(l).nodeSize;return n}function ft(n,e){return function(t,r){let{$from:o,$to:s,node:i}=t.selection;if(i&&i.isBlock||o.depth<2||!o.sameParent(s))return!1;let a=o.node(-1);if(a.type!=n)return!1;if(o.parent.content.size==0&&o.node(-1).childCount==o.indexAfter(-1)){if(o.depth==3||o.node(-3).type!=n||o.index(-2)!=o.node(-2).childCount-1)return!1;if(r){let d=N.empty,f=o.index(-1)?1:o.index(-2)?2:3;for(let x=o.depth-f;x>=o.depth-3;x--)d=N.from(o.node(x).copy(d));let p=o.indexAfter(-1)<o.node(-2).childCount?1:o.indexAfter(-2)<o.node(-3).childCount?2:3;d=d.append(N.from(n.createAndFill()));let h=o.before(o.depth-(f-1)),m=t.tr.replace(h,o.after(-p),new I(d,4-f,0)),y=-1;m.doc.nodesBetween(h,m.doc.content.size,(x,_)=>{if(y>-1)return!1;x.isTextblock&&x.content.size==0&&(y=_+1)}),y>-1&&m.setSelection(he.near(m.doc.resolve(y))),r(m.scrollIntoView())}return!0}let u=s.pos==o.end()?a.contentMatchAt(0).defaultType:null,c=t.tr.delete(o.pos,s.pos),l=u?[null,{type:u}]:void 0;return J(c.doc,o.pos,2,l)?(r&&r(c.split(o.pos,2,l).scrollIntoView()),!0):!1}}function ht(n){return function(e,t){let{$from:r,$to:o}=e.selection,s=r.blockRange(o,i=>i.childCount>0&&i.firstChild.type==n);return s?t?r.node(s.depth-1).type==n?mt(e,t,n,s):Nt(e,t,s):!0:!1}}function mt(n,e,t,r){let o=n.tr,s=r.end,i=r.$to.end(r.depth);s<i&&(o.step(new S(s-1,i,s,i,new I(N.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new P(o.doc.resolve(r.$from.pos),o.doc.resolve(i),r.depth));const a=me(r);if(a==null)return!1;o.lift(r,a);let u=o.mapping.map(s,-1)-1;return Ne(o.doc,u)&&o.join(u),e(o.scrollIntoView()),!0}function Nt(n,e,t){let r=n.tr,o=t.parent;for(let p=t.end,h=t.endIndex-1,m=t.startIndex;h>m;h--)p-=o.child(h).nodeSize,r.delete(p-1,p+1);let s=r.doc.resolve(t.start),i=s.nodeAfter;if(r.mapping.map(t.end)!=t.start+s.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,u=t.endIndex==o.childCount,c=s.node(-1),l=s.index(-1);if(!c.canReplace(l+(a?0:1),l+1,i.content.append(u?N.empty:N.from(o))))return!1;let d=s.pos,f=d+i.nodeSize;return r.step(new S(d-(a?1:0),f+(u?1:0),d+1,f-1,new I((a?N.empty:N.from(o.copy(N.empty))).append(u?N.empty:N.from(o.copy(N.empty))),a?0:1,u?0:1),a?0:1)),e(r.scrollIntoView()),!0}function Mt(n){return function(e,t){let{$from:r,$to:o}=e.selection,s=r.blockRange(o,c=>c.childCount>0&&c.firstChild.type==n);if(!s)return!1;let i=s.startIndex;if(i==0)return!1;let a=s.parent,u=a.child(i-1);if(u.type!=n)return!1;if(t){let c=u.lastChild&&u.lastChild.type==a.type,l=N.from(c?n.create():null),d=new I(N.from(n.create(null,N.from(a.type.create(null,l)))),c?3:1,0),f=s.start,p=s.end;t(e.tr.step(new S(f-(c?3:1),p,f,p,d,1,!0)).scrollIntoView())}return!0}}class R extends k{unistNodeName(){return"listItem"}static proseMirrorNodeName(){return"regular_list_item"}proseMirrorNodeSpec(){return{content:"paragraph block*",defining:!0,group:"list_item",parseDOM:[{tag:"li"}],toDOM(){return["li",0]}}}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&(!("checked"in e)||typeof e.checked!="boolean")}proseMirrorKeymap(e){const t=e.nodes[this.proseMirrorNodeName()];return{Enter:ft(t),"Shift-Tab":ht(t),Tab:Mt(t)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:r}){return M(this.proseMirrorNodeName(),e,t,r)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t}]}}class kt extends k{unistNodeName(){return"math"}static proseMirrorNodeName(){return"math_block"}proseMirrorNodeSpec(){return{group:"block",content:"text*",atom:!0,code:!0,attrs:{latex:{default:null}},parseDOM:[{tag:"div.math-block",getAttrs(e){return{latex:e.getAttribute("latex")}}}],toDOM(){return["div",{class:"math-block"},0]}}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:r,attrs:o}){const{value:s}=e;return M(this.proseMirrorNodeName(),t,r,{...o,latex:s})}proseMirrorNodeToUnistNodes(e){return[{type:this.unistNodeName(),value:e.attrs.latex}]}}class gt extends k{dependencies(){return[new R]}unistNodeName(){return"list"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&e.ordered===!0}static proseMirrorNodeName(){return"ordered_list"}proseMirrorNodeSpec(){return{content:"list_item+",group:"block",attrs:{spread:{default:!1},startingNumber:{default:1}},parseDOM:[{getAttrs(e){const t=e.getAttribute("start");return{spread:e.getAttribute("data-spread")==="true",startingNumber:t!=null?parseInt(t):1}},tag:"ol"}],toDOM(e){return["ol",{"data-spread":e.attrs.spread,start:e.attrs.startingNumber},0]}}}proseMirrorInputRules(e){return[B(/^\s{0,3}(\d+)\.\s$/,e.nodes[this.proseMirrorNodeName()],t=>({startingNumber:+t[1]}),(t,r)=>r.childCount+r.attrs.startingNumber===+t[1])]}proseMirrorKeymap(e){return{"Shift-Mod-9":ne(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:r,attrs:o}){const{spread:s,start:i}=e;return M(this.proseMirrorNodeName(),t,r,{...o,spread:s,startingNumber:i??1})}proseMirrorNodeToUnistNodes(e,t){const r=e.attrs.spread;return[{type:this.unistNodeName(),ordered:!0,spread:r,start:e.attrs.startingNumber,children:t.map(o=>(o.spread=r,o))}]}}class xt extends A{unistNodeName(){return"delete"}static proseMirrorMarkName(){return"strikethrough"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"s"},{tag:"del"},{style:"text-decoration",getAttrs:e=>/(^|[\s])line-through([\s]|$)/.test(e)&&null}],toDOM(){return["s"]}}}proseMirrorInputRules(e){return[new g(/~([^\s](?:.*[^\s~])?)~([^~])$/,e.marks[this.proseMirrorMarkName()]),new g(/~~([^\s](?:.*[^\s])?)~~([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t}){return t.map(r=>r.mark(r.marks.concat([e.marks[this.proseMirrorMarkName()].create()])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}function wt(){return n=>{let e=-1;function t(o,s){if(o.type==="tableRow"&&e++,o.type==="tableCell"){const i=o;i.data={...i.data??{},rowIndex:e,columnIndex:s}}}function r(o){if(re(o))for(let s=0;s<o.children.length;s++){const i=o.children[s];t(i,s),r(i)}}r(n)}}class oe extends k{unistNodeName(){return"tableCell"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()}static proseMirrorNodeName(){return"table_cell"}proseMirrorNodeSpec(){return{content:"inline*",attrs:{rowIndex:{default:null},columnIndex:{default:null},colspan:{default:1},rowspan:{default:1}},tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs(e){const t=e;return{colspan:O(t.getAttribute("colspan"),1),rowspan:O(t.getAttribute("rowspan"),1)}}}],toDOM(e){const{colspan:t,rowspan:r}=e.attrs,o={colspan:t!==1?$(t,void 0):void 0,rowspan:r!==1?$(r,void 0):void 0};return[e.attrs.rowIndex==null||e.attrs.rowIndex>0?"td":"th",o,0]}}}proseMirrorInputRules(e){return[]}proseMirrorKeymap(e){return{}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:r,attrs:o}){return M(this.proseMirrorNodeName(),t,r,{...o,colspan:1,rowspan:1,rowIndex:e.data?.rowIndex,columnIndex:e.data?.columnIndex})}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t,data:{rowIndex:e.attrs.rowIndex,columnIndex:e.attrs.columnIndex}}]}}class se extends k{dependencies(){return[new oe]}unistNodeName(){return"tableRow"}static proseMirrorNodeName(){return"table_row"}proseMirrorNodeSpec(){return{content:"(table_cell+)",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}}}proseMirrorInputRules(e){return[]}proseMirrorKeymap(e){return{}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:r}){return M(this.proseMirrorNodeName(),e,t,r)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t}]}}class yt extends k{dependencies(){return[new se]}unistNodeName(){return"table"}static proseMirrorNodeName(){return"table"}proseMirrorNodeSpec(){return{content:"(table_row+)",tableRole:"table",isolating:!0,group:"block",parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}}}proseMirrorInputRules(e){return[]}proseMirrorKeymap(e){return{}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:r}){return M(this.proseMirrorNodeName(),e,t,r)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),align:[],children:t}]}unifiedInitializationHook(e){return e.use(wt)}}class bt extends k{dependencies(){return[new R]}unistNodeName(){return"list"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&e.ordered!==!0}static proseMirrorNodeName(){return"list"}proseMirrorNodeSpec(){return{content:"list_item+",group:"block",attrs:{spread:{default:!1}},parseDOM:[{getAttrs(e){return{spread:e.getAttribute("data-spread")==="true"}},tag:"ul"}],toDOM(e){return["ul",{"data-spread":e.attrs.spread},0]}}}proseMirrorInputRules(e){return[B(/^\s{0,3}([-+*])\s$/,e.nodes[this.proseMirrorNodeName()])]}proseMirrorKeymap(e){return{"Shift-Mod-8":ne(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:r,attrs:o}){const{spread:s}=e;return M(this.proseMirrorNodeName(),t,r,{...o,spread:s})}proseMirrorNodeToUnistNodes(e,t){const r=e.attrs.spread;return[{type:this.unistNodeName(),ordered:!1,spread:r,children:t.map(o=>(o.spread=r,o))}]}}function G(n,e){if(!(n==null||e==null))return{start:{...n},end:{...e}}}const Ct=()=>n=>{_e(n,"list",(e,t,r)=>{if(r==null||t==null)return;const o=[];let s=[],i=0;for(;i<e.children.length;){const a=e.children[i];if(K(a)){const u=[];for(;i<e.children.length&&K(e.children[i]);)u.push(e.children[i]),i++;if(s.length===0)throw new Error("Unexpected state: currentListItems is empty after encountering blank lines.");const c=s[0],l=Te(Ee(s)),d=G(c.position?.start??e.position?.start,l.position?.end??e.position?.end),f={type:"list",ordered:e.ordered,start:e.start,spread:e.spread,children:s,position:d};o.push(f),s=[],o.push(...u.map(p=>({type:"lineEndingBlank",position:p.position})))}else s.push(a),i++}if(s.length>0){const a=s[0],u=s[s.length-1],c=G(a.position?.start??e.position?.start,u.position?.end??e.position?.end),l={type:"list",ordered:e.ordered,start:e.start,spread:e.spread,children:s,position:c};o.push(l)}r.children.splice(t,1,...o)})};var V={}.hasOwnProperty;function It(n,e){var t=e||{};function r(o){var s=r.invalid,i=r.handlers;if(o&&V.call(o,n)&&(s=V.call(i,o[n])?i[o[n]]:r.unknown),s)return s.apply(this,arguments)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const At={}.hasOwnProperty;function ie(n,e){let t=-1,r;if(e.extensions)for(;++t<e.extensions.length;)ie(n,e.extensions[t]);for(r in e)if(At.call(e,r))switch(r){case"extensions":break;case"unsafe":{W(n[r],e[r]);break}case"join":{W(n[r],e[r]);break}case"handlers":{Tt(n[r],e[r]);break}default:n.options[r]=e[r]}return n}function W(n,e){e&&n.push(...e)}function Tt(n,e){e&&Object.assign(n,e)}const Et=[St];function St(n,e,t,r){if(e.type==="code"&&U(e,r)&&(n.type==="list"||n.type===e.type&&U(n,r)))return!1;if("spread"in t&&typeof t.spread=="boolean")return n.type==="paragraph"&&(n.type===e.type||e.type==="definition"||e.type==="heading"&&De(e,r))?void 0:t.spread?1:0}const w=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],vt=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:w},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:w},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:w},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:w},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:w},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:w},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:w},{atBreak:!0,character:"~"}];function _t(n){return n.label||!n.identifier?n.label||"":je(n.identifier)}function Dt(n){if(!n._compiled){const e=(n.atBreak?"[\\r\\n][\\t ]*":"")+(n.before?"(?:"+n.before+")":"");n._compiled=new RegExp((e?"("+e+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(n.character)?"\\":"")+n.character+(n.after?"(?:"+n.after+")":""),"g")}return n._compiled}function Lt(n,e,t){const r=e.indexStack,o=n.children||[],s=[];let i=-1,a=t.before;r.push(-1);let u=e.createTracker(t);for(;++i<o.length;){const c=o[i];let l;if(r[r.length-1]=i,i+1<o.length){let d=e.handle.handlers[o[i+1].type];d&&d.peek&&(d=d.peek),l=d?d(o[i+1],n,e,{before:"",after:"",...u.current()}).charAt(0):""}else l=t.after;s.length>0&&(a==="\r"||a===`
`)&&c.type==="html"&&(s[s.length-1]=s[s.length-1].replace(/(\r?\n|\r)$/," "),a=" ",u=e.createTracker(t),u.move(s.join(""))),s.push(u.move(e.handle(c,n,e,{...u.current(),before:a,after:l}))),a=s[s.length-1].slice(-1)}return r.pop(),s.join("")}function Pt(n,e,t){const r=e.indexStack,o=n.children||[],s=e.createTracker(t),i=[];let a=-1;for(r.push(-1);++a<o.length;){const u=o[a];r[r.length-1]=a,i.push(s.move(e.handle(u,n,e,{before:`
`,after:`
`,...s.current()}))),u.type!=="list"&&(e.bulletLastUsed=void 0),a<o.length-1&&i.push(s.move(Bt(u,o[a+1],n,e)))}return r.pop(),i.join("")}function Bt(n,e,t,r){let o=r.join.length;for(;o--;){const s=r.join[o](n,e,t,r);if(s===!0||s===1)break;if(typeof s=="number")return`
`.repeat(1+s);if(s===!1)return`

<!---->

`}return`

`}const Rt=/\r?\n|\r/g;function Ot(n,e){const t=[];let r=0,o=0,s;for(;s=Rt.exec(n);)i(n.slice(r,s.index)),t.push(s[0]),r=s.index+s[0].length,o++;return i(n.slice(r)),t.join("");function i(a){t.push(e(a,o,!a))}}function $t(n,e,t){const r=(t.before||"")+(e||"")+(t.after||""),o=[],s=[],i={};let a=-1;for(;++a<n.unsafe.length;){const l=n.unsafe[a];if(!Le(n.stack,l))continue;const d=n.compilePattern(l);let f;for(;f=d.exec(r);){const p="before"in l||!!l.atBreak,h="after"in l,m=f.index+(p?f[1].length:0);o.includes(m)?(i[m].before&&!p&&(i[m].before=!1),i[m].after&&!h&&(i[m].after=!1)):(o.push(m),i[m]={before:p,after:h})}}o.sort(Ut);let u=t.before?t.before.length:0;const c=r.length-(t.after?t.after.length:0);for(a=-1;++a<o.length;){const l=o[a];l<u||l>=c||l+1<c&&o[a+1]===l+1&&i[l].after&&!i[l+1].before&&!i[l+1].after||o[a-1]===l-1&&i[l].before&&!i[l-1].before&&!i[l-1].after||(u!==l&&s.push(q(r.slice(u,l),"\\")),u=l,/[!-/:-@[-`{-~]/.test(r.charAt(l))&&(!t.encode||!t.encode.includes(r.charAt(l)))?s.push("\\"):(s.push("&#x"+r.charCodeAt(l).toString(16).toUpperCase()+";"),u++))}return s.push(q(r.slice(u,c),t.after)),s.join("")}function Ut(n,e){return n-e}function q(n,e){const t=/\\(?=[!-/:-@[-`{-~])/g,r=[],o=[],s=n+e;let i=-1,a=0,u;for(;u=t.exec(s);)r.push(u.index);for(;++i<r.length;)a!==r[i]&&o.push(n.slice(a,r[i])),o.push("\\"),a=r[i];return o.push(n.slice(a)),o.join("")}function jt(n){const e=n||{},t=e.now||{};let r=e.lineShift||0,o=t.line||1,s=t.column||1;return{move:u,current:i,shift:a};function i(){return{now:{line:o,column:s},lineShift:r}}function a(c){r+=c}function u(c){const l=c||"",d=l.split(/\r?\n|\r/g),f=d[d.length-1];return o+=d.length-1,s=d.length===1?s+f.length:1+f.length+r,l}}function zt(n,e={}){const t={enter:o,indentLines:Ot,associationId:_t,containerPhrasing:Gt,containerFlow:Vt,createTracker:jt,compilePattern:Dt,safe:Wt,stack:[],unsafe:[...vt],join:[...Et],handlers:{...Pe},options:{},indexStack:[],handle:void 0};ie(t,e),t.options.tightDefinitions&&t.join.push(Kt),t.handle=It("type",{invalid:Ft,unknown:Ht,handlers:t.handlers});let r=t.handle(n,void 0,t,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return r&&r.charCodeAt(r.length-1)!==10&&r.charCodeAt(r.length-1)!==13&&(r+=`
`),r;function o(s){return t.stack.push(s),i;function i(){t.stack.pop()}}}function Ft(n){throw new Error("Cannot handle value `"+n+"`, expected node")}function Ht(n){const e=n;throw new Error("Cannot handle unknown node `"+e.type+"`")}function Kt(n,e){if(n.type==="definition"&&n.type===e.type)return 0}function Gt(n,e){return Lt(n,this,e)}function Vt(n,e){return Pt(n,this,e)}function Wt(n,e){return $t(this,n,e)}const qt=(n,e,t,r)=>n.children.map(o=>t.handle(o,void 0,t,r)).join(""),Zt=(n,e,t,r)=>t.safe(n.value,r).replaceAll("\\[","[").replaceAll("\\&","&"),Jt=n=>`\\(${n.value}\\)`;function Qt(){const n=this;n.compiler=e;function e(t){return zt(t,{...n.data("settings"),fences:!0,bullet:"-",bulletOther:"*",listItemIndent:"one",resourceLink:!0,tightDefinitions:!0,rule:"-",handlers:{text:Zt,startend:qt,inlineMath:Jt},extensions:n.data("toMarkdownExtensions")||[]})}}const ae=[ze,Be,[Re,{singleDollarTextMath:!1}],Oe,$e,Ue,Fe,Ct,Qt];class Xt extends Ce{shouldStripDirectives=!1;constructor(e){super(),this.shouldStripDirectives=e}dependencies(){const e=Me(Se());return[new dt,new we,new Ke,new Ze,new et,new nt,new ye,new st,new it,new at,new kt,new lt,new He,new R,new gt,new be,new X,new bt,new xt,new v,new yt,new se,new oe,...e?[new ot]:[]]}unifiedInitializationHook(e){return e.use(ae)}}const ar=Object.freeze(Object.defineProperty({__proto__:null,CANVAS_REMARK_PLUGINS:ae,MarkdownExtension:Xt},Symbol.toStringTag,{value:"Module"}));export{Ze as B,ot as C,lt as I,He as L,Xt as M,tt as a,nt as b,ar as p,qe as t};
//# sourceMappingURL=fjc8pmrszxm2svae.js.map
